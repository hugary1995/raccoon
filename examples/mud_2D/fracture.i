[Mesh]
  type = FileMesh
  file = 'gold/geo.msh'
[]

[Modules]
  [./KLExpansion]
    [./E_crit]
      file_name = 'gold/small_correlation_length/kl_info.txt'
      field_distribution = GAMMA
      perturbation = CUSTOM
      custom_Gaussian_weights = '0.537667139546100 1.83388501459509 -2.25884686100365 0.862173320368121 0.318765239858981 -1.30768829630527 -0.433592022305684 0.342624466538650 3.57839693972576 2.76943702988488 -1.34988694015652 3.03492346633185 0.725404224946106 -0.0630548731896562 0.714742903826096 -0.204966058299775 -0.124144348216312 1.48969760778547 1.40903448980048 1.41719241342961 0.671497133608081 -1.20748692268504 0.717238651328839 1.63023528916473 0.488893770311789 1.03469300991786 0.726885133383238 -0.303440924786016 0.293871467096658 -0.787282803758638 0.888395631757642 -1.14707010696915 -1.06887045816803 -0.809498694424876 -2.94428416199490 1.43838029281510 0.325190539456198 -0.754928319169703 1.37029854009523 -1.71151641885370 -0.102242446085491 -0.241447041607358 0.319206739165502 0.312858596637428 -0.864879917324457 -0.0300512961962686 -0.164879019209038 0.627707287528727 1.09326566903948 1.10927329761440 -0.863652821988714 0.0773590911304249 -1.21411704361541 -1.11350074148676 -0.00684932810334806 1.53263030828475 -0.769665913753682 0.371378812760058 -0.225584402271252 1.11735613881447 -1.08906429505224 0.0325574641649735 0.552527021112224 1.10061021788087 1.54421189550395 0.0859311331754255 -1.49159031063761 -0.742301837259857 -1.06158173331999 2.35045722400204 -0.615601881466894 0.748076783703985 -0.192418510588264 0.888610425420721 -0.764849236567874 -1.40226896933876 -1.42237592509150 0.488193909859941 -0.177375156618825 -0.196053487807333 1.41931015064255 0.291584373984183 0.197811053464361 1.58769908997406 -0.804465956349547 0.696624415849607 0.835088165072682 -0.243715140377952 0.215670086403744 -1.16584393148205 -1.14795277889859 0.104874716016494 0.722254032225002 2.58549125261624 -0.666890670701386 0.187331024578940 -0.0824944253709554 -1.93302291785099 -0.438966153934773 -1.79467884145512 0.840375529753905 -0.888032082329010 0.100092833139322 -0.544528929990548 0.303520794649354 -0.600326562133734 0.489965321173948 0.739363123604474 1.71188778298155 -0.194123535758265 -2.13835526943994 -0.839588747336614 1.35459432800464 -1.07215528838425 0.960953869740567 0.124049800003193 1.43669662271894 -1.96089999936503 -0.197698225974150 -1.20784548525980 2.90800803072936 0.825218894228491 1.37897197791661 -1.05818025798736 -0.468615581100624 -0.272469409250188 1.09842461788862 -0.277871932787639 0.701541458163284 -2.05181629991115 -0.353849997774433 -0.823586525156853 -1.57705702279920 0.507974650905946 0.281984063670556 0.0334798822444514 -1.33367794342811 1.12749227834159 0.350179410603312 -0.299066030332982 0.0228897927516298 -0.261995434966092 -1.75021236844679 -0.285650971595330 -0.831366511567624 -0.979206305167302 -1.15640165566400 -0.533557109315987 -2.00263573588306 0.964229422631628 0.520060101455458 -0.0200278516425381 -0.0347710860284830 -0.798163584564142 1.01868528212858 -0.133217479507735 -0.714530163787158 1.35138576842666 -0.224771056052584 -0.589029030720801 -0.293753597735416 -0.847926243637934 -1.12012830124373 2.52599969211831 1.65549759288735 0.307535159238252 -1.25711835935205 -0.865468030554804 -0.176534114231451 0.791416061628634 -1.33200442131525 -2.32986715580508 -1.44909729283874 0.333510833065806 0.391353604432901 0.451679418928238 -0.130284653145721 0.183689095861942 -0.476153016619074 0.862021611556922 -1.36169447087075 0.455029556444334 -0.848709379933659 -0.334886938964048 0.552783345944550 1.03909065350496 -1.11763868326521 1.26065870912090 0.660143141046978 -0.0678655535426873 -0.195221197898754 -0.217606350143192 -0.303107621351741 0.0230456244251053 0.0512903558487747 0.826062790211596 1.52697668673337 0.466914435684700 -0.209713338388737 0.625190357087626 0.183227263001437 -1.02976754356662 0.949221831131023 0.307061919146703 0.135174942099456 0.515246335524849 0.261406324055383 -0.941485770955434 -0.162337672803828 -0.146054634331526 -0.532011376808821 1.68210359466318 -0.875729346160017 -0.483815050110121 -0.712004549027423 -1.17421233145682 -0.192239517539275 -0.274070229932602 1.53007251442410 -0.249024742513714 -1.06421341288933 1.60345729812004 1.23467914689078 -0.229626450963181 -1.50615970397972 -0.444627816446985 -0.155941035724769 0.276068253931536 -0.261163645776479 0.443421912904091 0.391894209432449'
      # custom_Gaussian_weights = '0.537667139546100 1.83388501459509 -2.25884686100365 0.862173320368121 0.318765239858981 -1.30768829630527 -0.433592022305684 0.342624466538650 3.57839693972576 2.76943702988488 -1.34988694015652 3.03492346633185 0.725404224946106 -0.0630548731896562 0.714742903826096 -0.204966058299775'
      mean = 3e-05
      CV = 0.3
    [../]
    [./Gc]
      file_name = 'gold/small_correlation_length/kl_info.txt'
      field_distribution = GAMMA
      perturbation = CUSTOM
      custom_Gaussian_weights = '-1.25067890682641 -0.947960922331432 -0.741106093940412 -0.507817550278174 -0.320575506600239 0.0124690413616180 -3.02917734140415 -0.457014640871583 1.24244840639074 -1.06670139898475 0.933728162671239 0.350321001356112 -0.0290057637087263 0.182452167505983 -1.56505601415073 -0.0845394798177242 1.60394635060288 0.0983477746401080 0.0413736134896147 -0.734169112696739 -0.0308137300123200 0.232347012624477 0.426387557408945 -0.372808741723504 -0.236454583757186 2.02369088660305 -2.25835397049619 2.22944568045690 0.337563700613106 1.00006081958912 -1.66416447498706 -0.590034564205222 -0.278064163765309 0.422715691220478 -1.67020069785047 0.471634326416303 -1.21284719967446 0.0661900484246114 0.652355888661374 0.327059967177088 1.08263350423676 1.00607711081905 -0.650907736597753 0.257056157433969 -0.944377806404219 -1.32178852139256 0.924825933493706 4.98490752508133e-05 -0.0549189146094067 0.911127265653860 0.594583697409052 0.350201173874535 1.25025122830500 0.929789458557716 0.239763257058580 -0.690361103111226 -0.651553641750281 1.19210187053127 -1.61183038867781 -0.0244619366359185 -1.94884717689890 1.02049801445265 0.861716302393419 0.00116208348351385 -0.0708372131604802 -2.48628392070328 0.581172322675923 -2.19243491996591 -2.31928030664330 0.0799337102984397 -0.948480983570505 0.411490621423374 0.676977805684030 0.857732545205355 -0.691159125382991 0.449377623166851 0.100633350315076 0.826069998469923 0.536157079925919 0.897888425985076 -0.131937867924581 -0.147201456151267 1.00777340530544 -2.12365546241575 -0.504586405514010 -1.27059444980866 -0.382584802707648 0.648679262048621 0.825727149241758 -1.01494364268014 -0.471069912683167 0.137024874130050 -0.291863375753573 0.301818555261006 0.399930942955802 -0.929961558940129 -0.176830265929232 -2.13209459916153 1.14536171051847 -0.629090760994156 -1.20384997400222 -0.253944683422812 -1.42864686463210 -0.0208576177016003 -0.560664996528185 2.17777870918415 1.13846538732960 -2.49688650318450 0.441326931727609 -1.39813787581107 -0.255055179880806 0.164404073318729 0.747734028808123 -0.273046949402907 1.57630014654608 -0.480937151778845 0.327512120829686 0.664734120627595 0.0851885927211602 0.880952785381048 0.323213137847598 -0.784146183664088 -1.80537335138609 1.85859294855571 -0.604530088774459 0.103359722310648 0.563166955145978 0.113596996734002 -0.904726212798032 -0.467714582451856 -0.124889947223107 1.47895849150403 -0.860815690006961 0.784668467287822 0.308623139948530 -0.233860042129153 -1.05697274596013 -0.284140954626164 -0.0866902824593051 -1.46939507448636 0.192182244870785 -0.822293276290175 -0.0942405879597235 0.336213340954240 -0.904654059246837 -0.288256361205696 0.350062757534178 -1.83585914250431 1.03597590824548 2.42446114493936 0.959400509407976 -0.315771995009409 0.428622679859396 -1.03598477851339 1.87786546049586 0.940704403352132 0.787345779935246 -0.875874261956672 0.319949134382331 -0.558294284850904 -0.311429418546895 -0.570009916642186 -1.02573361562871 -0.908745586874325 -0.209897334055591 -1.69886408417261 0.607600575846084 -0.117798289267962 0.699160333644167 0.269648641716598 0.494287055379411 -1.48312102251590 -1.02026438568297 -0.446995010744528 0.109658591327603 1.12873645202828 -0.289963040800028 1.26155071814115 0.475424811707271 1.17411675149372 0.126947068043646 -0.656815928948083 -1.48139907157878 0.155488995903894 0.818551368521001 -0.292588130834394 -0.540786416488526 -0.308641815280113 -1.09659330152547 -0.493009815316451 -0.180739356415037 0.0458411057137050 -0.0637831200223327 0.611335194065236 0.109317693774870 1.81401545028038 0.312023828329274 1.80449377172419 -0.723121479570418 0.526547037749559 -0.260250861706117 0.600142508808630 0.593930795648753 -2.18602161274824 -1.32704314952029 -1.44101359763891 0.401844497039815 1.47020128084852 -0.326814228785906 0.812323004640796 0.545540103526116 -1.05163230952085 0.397466995795309 -0.751894738681892 1.51626689664595 -0.0325665091944807 1.63599965727829 -0.425058490610031 0.589433366718221 -0.0627912257183250 -2.02195893005179 -0.982131525779048 0.612511298166949 -0.0548861299886774 -1.11873200245273 -0.626378538867139 0.249517740562795 -0.993019006549601 0.974950224811312 -0.640709506726058 1.80886262051925'
      # custom_Gaussian_weights = '0.537667139546100 1.83388501459509 -2.25884686100365 0.862173320368121 0.318765239858981 -1.30768829630527 -0.433592022305684 0.342624466538650 3.57839693972576 2.76943702988488 -1.34988694015652 3.03492346633185 0.725404224946106 -0.0630548731896562 0.714742903826096 -0.204966058299775'
      mean = 8e-04
      CV = 0.3
    [../]
  [../]
[]

[Variables]
  [./d]
  [../]
[]

[AuxVariables]
  [./E_el]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./d_ref]
  [../]
  [./bounds_dummy]
  [../]
  [./load]
    family = SCALAR
  [../]
[]

[Bounds]
  # [./nonnegtivity]
  #   type = BoundsAux
  #   variable = bounds_dummy
  #   bounded_variable = d
  #   upper = 1
  #   lower = 0
  # [../]
  [./irreversibility]
    type = Irreversibility
    variable = bounds_dummy
    bounded_var = d
    upper = 1
    lower = d_ref
  [../]
[]

[Kernels]
  [./damage]
    type = PhaseFieldFractureEvolution
    variable = d
    driving_energy_var = E_el
  [../]
[]

[Materials]
  [./fracture_energy_barrier]
    type = StationaryGenericFunctionMaterial
    prop_names = 'b'
    prop_values = 'E_crit'
  [../]
  [./local_dissipation]
    type = LinearLocalDissipation
    d = d
  [../]
  [./fracture_properties]
    type = FractureMaterial
    Gc = 'Gc'
    L = 0.5
    local_dissipation_norm = 8/3
  [../]
  [./degradation]
    type = LorentzDegradation
    d = d
  [../]
[]

[Executioner]
  type = Transient
  solve_type = 'NEWTON'
  petsc_options_iname = '-pc_type -snes_type'
  petsc_options_value = 'lu vinewtonrsls'
  dt = 1e-4

  nl_abs_tol = 1e-10
  nl_rel_tol = 1e-06
[]

[Outputs]
  hide = 'load'
  print_linear_residuals = false
[]
