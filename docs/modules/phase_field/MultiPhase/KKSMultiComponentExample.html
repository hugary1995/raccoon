<!DOCTYPE html><head><meta charset="UTF-8"><link rel="icon" type="image/x-icon" href="../../../media/raccoon_icon.png" sizes="16x16 32x32 64x64 128x128"></link><link href="../../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../contrib/katex/katex.min.css" type="text/css" rel="stylesheet"></link><link href="../../../css/katex_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../../../contrib/katex/katex.min.js"></script><script type="text/javascript" src="../../../contrib/plotly/plotly.min.js"></script><title>Kim Kim Suzuki Example for three or more components|RACCOON</title></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="https://hugary1995.github.io/raccoon" class="left moose-logo hide-on-med-and-down">RACCOON</a><a href="https://github.com/hugary1995/raccoon" class="right"><img src="../../../media/framework/github-logo.png" class="github-mark"></img><img src="../../../media/framework/github-mark.png" class="github-logo"></img></a><ul class="right hide-on-med-and-down"><li><a href="../../../install/index.html">Install</a></li><li><a href="../../../examples/index.html">Examples</a></li><li><a href="../../../theory/index.html">Theory</a></li><li><a href="../../../documentation/index.html">Documentation</a></li></ul><a href="#" class="sidenav-trigger" data-target="12fcaa7d-fc6f-4805-8143-227021a6d652"><i class="material-icons">menu</i></a><ul class="sidenav" id="12fcaa7d-fc6f-4805-8143-227021a6d652"><li><a href="../../../install/index.html">Install</a></li><li><a href="../../../examples/index.html">Examples</a></li><li><a href="../../../theory/index.html">Theory</a></li><li><a href="../../../documentation/index.html">Documentation</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="https://hugary1995.github.io/raccoon" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><span class="breadcrumb">modules</span><a href=".." class="breadcrumb">phase_field</a><span class="breadcrumb">MultiPhase</span><a href="#" class="breadcrumb">KKSMultiComponentExample</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section id="051dc02c-e0e6-4c2e-bb22-63f1614e2223" data-section-level="1" data-section-text="Kim - Kim - Suzuki Example for three or more components"><h1 id="kim-kim-suzuki-example-for-three-or-more-components">Kim-Kim-Suzuki Example for three or more components</h1><pre class="moose-pre"><code class="language-text">#
# KKS ternary (3 chemical component) system example in the split form
# We track c1 and c2 only, since c1 + c2 + c3 = 1
#

[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 150
  ny = 15
  nz = 0
  xmin = -25
  xmax = 25
  ymin = -2.5
  ymax = 2.5
  zmin = 0
  zmax = 0
  elem_type = QUAD4
[]

[AuxVariables]
  [./Fglobal]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[Variables]
  # order parameter
  [./eta]
    order = FIRST
    family = LAGRANGE
  [../]

  # solute 1 concentration
  [./c1]
    order = FIRST
    family = LAGRANGE
  [../]

  # solute 2 concentration
  [./c2]
    order = FIRST
    family = LAGRANGE
  [../]

  # chemical potential solute 1
  [./w1]
    order = FIRST
    family = LAGRANGE
  [../]

  # chemical potential solute 2
  [./w2]
    order = FIRST
    family = LAGRANGE
  [../]

  # Liquid phase solute 1 concentration
  [./c1l]
    order = FIRST
    family = LAGRANGE
    initial_condition = 0.1
  [../]

  # Liquid phase solute 2 concentration
  [./c2l]
    order = FIRST
    family = LAGRANGE
    initial_condition = 0.05
  [../]

  # Solid phase solute 1 concentration
  [./c1s]
    order = FIRST
    family = LAGRANGE
    initial_condition = 0.8
  [../]

  # Solid phase solute 2 concentration
  [./c2s]
    order = FIRST
    family = LAGRANGE
    initial_condition = 0.1
  [../]

[]

[Functions]
  [./ic_func_eta]
    type = ParsedFunction
    value = &#x27;0.5*(1.0-tanh((x)/sqrt(2.0)))&#x27;
  [../]
  [./ic_func_c1]
    type = ParsedFunction
    value = &#x27;0.8*(0.5*(1.0-tanh(x/sqrt(2.0))))^3*(6*(0.5*(1.0-tanh(x/sqrt(2.0))))^2-15*(0.5*(1.0-tanh(x/sqrt(2.0))))+10)+0.1*(1-(0.5*(1.0-tanh(x/sqrt(2.0))))^3*(6*(0.5*(1.0-tanh(x/sqrt(2.0))))^2-15*(0.5*(1.0-tanh(x/sqrt(2.0))))+10))&#x27;
  [../]
  [./ic_func_c2]
    type = ParsedFunction
    value = &#x27;0.1*(0.5*(1.0-tanh(x/sqrt(2.0))))^3*(6*(0.5*(1.0-tanh(x/sqrt(2.0))))^2-15*(0.5*(1.0-tanh(x/sqrt(2.0))))+10)+0.05*(1-(0.5*(1.0-tanh(x/sqrt(2.0))))^3*(6*(0.5*(1.0-tanh(x/sqrt(2.0))))^2-15*(0.5*(1.0-tanh(x/sqrt(2.0))))+10))&#x27;
  [../]

[]

[ICs]
  [./eta]
    variable = eta
    type = FunctionIC
    function = ic_func_eta
  [../]
  [./c1]
    variable = c1
    type = FunctionIC
    function = ic_func_c1
  [../]
  [./c2]
    variable = c2
    type = FunctionIC
    function = ic_func_c2
  [../]

[]

[Materials]
  # Free energy of the liquid
  [./fl]
    type = DerivativeParsedMaterial
    f_name = fl
    args = &#x27;c1l c2l&#x27;
    function = &#x27;(0.1-c1l)^2+(0.05-c2l)^2&#x27;
  [../]

  # Free energy of the solid
  [./fs]
    type = DerivativeParsedMaterial
    f_name = fs
    args = &#x27;c1s c2s&#x27;
    function = &#x27;(0.8-c1s)^2+(0.1-c2s)^2&#x27;
  [../]

  # h(eta)
  [./h_eta]
    type = SwitchingFunctionMaterial
    h_order = HIGH
    eta = eta
  [../]

  # g(eta)
  [./g_eta]
    type = BarrierFunctionMaterial
    g_order = SIMPLE
    eta = eta
  [../]

  # constant properties
  [./constants]
    type = GenericConstantMaterial
    prop_names  = &#x27;M   L   eps_sq&#x27;
    prop_values = &#x27;0.7 0.7 1.0  &#x27;
  [../]
[]

[Kernels]
  # enforce c1 = (1-h(eta))*c1l + h(eta)*c1s
  [./PhaseConc1]
    type = KKSPhaseConcentration
    ca       = c1l
    variable = c1s
    c        = c1
    eta      = eta
  [../]

  # enforce c2 = (1-h(eta))*c2l + h(eta)*c2s
  [./PhaseConc2]
    type = KKSPhaseConcentration
    ca       = c2l
    variable = c2s
    c        = c2
    eta      = eta
  [../]

  # enforce pointwise equality of chemical potentials
  [./ChemPotSolute1]
    type = KKSPhaseChemicalPotential
    variable = c1l
    cb       = c1s
    fa_name  = fl
    fb_name  = fs
    args_a   = &#x27;c2l&#x27;
    args_b   = &#x27;c2s&#x27;
  [../]
  [./ChemPotSolute2]
    type = KKSPhaseChemicalPotential
    variable = c2l
    cb       = c2s
    fa_name  = fl
    fb_name  = fs
    args_a   = &#x27;c1l&#x27;
    args_b   = &#x27;c1s&#x27;

  [../]

  #
  # Cahn-Hilliard Equations
  #
  [./CHBulk1]
    type = KKSSplitCHCRes
    variable = c1
    ca       = c1l
    fa_name  = fl
    w        = w1
    args_a   = &#x27;c2l&#x27;
  [../]
  [./CHBulk2]
    type = KKSSplitCHCRes
    variable = c2
    ca       = c2l
    fa_name  = fl
    w        = w2
    args_a   = &#x27;c1l&#x27;
  [../]

  [./dc1dt]
    type = CoupledTimeDerivative
    variable = w1
    v = c1
  [../]
  [./dc2dt]
    type = CoupledTimeDerivative
    variable = w2
    v = c2
  [../]

  [./w1kernel]
    type = SplitCHWRes
    mob_name = M
    variable = w1
  [../]
  [./w2kernel]
    type = SplitCHWRes
    mob_name = M
    variable = w2
  [../]

  #
  # Allen-Cahn Equation
  #
  [./ACBulkF]
    type = KKSACBulkF
    variable = eta
    fa_name  = fl
    fb_name  = fs
    w        = 1.0
    args = &#x27;c1l c1s c2l c2s&#x27;
  [../]
  [./ACBulkC1]
    type = KKSACBulkC
    variable = eta
    ca       = c1l
    cb       = c1s
    fa_name  = fl
    args     = &#x27;c2l&#x27;
  [../]
  [./ACBulkC2]
    type = KKSACBulkC
    variable = eta
    ca       = c2l
    cb       = c2s
    fa_name  = fl
    args     = &#x27;c1l&#x27;
  [../]
  [./ACInterface]
    type = ACInterface
    variable = eta
    kappa_name = eps_sq
  [../]
  [./detadt]
    type = TimeDerivative
    variable = eta
  [../]
[]

[AuxKernels]
  [./GlobalFreeEnergy]
    variable = Fglobal
    type = KKSGlobalFreeEnergy
    fa_name = fl
    fb_name = fs
    w = 1.0
  [../]
[]

[Executioner]
  type = Transient
  solve_type = &#x27;PJFNK&#x27;

  petsc_options_iname = &#x27;-pc_type -sub_pc_type -sub_pc_factor_shift_type&#x27;
  petsc_options_value = &#x27;asm      ilu          nonzero&#x27;

  l_max_its = 100
  nl_max_its = 100

  num_steps = 50
  dt = 0.1
[]

#
# Precondition using handcoded off-diagonal terms
#
[Preconditioning]
  [./full]
    type = SMP
    full = true
  [../]
[]

[Outputs]
  exodus = true
[]
</code></pre><a href="#64e9d46c-4a92-4cba-98f9-762310237c79" class="modal-trigger">(../moose/modules/phase_field/examples/kim-kim-suzuki/kks_example_ternary.i)</a><div class="modal moose-modal" id="64e9d46c-4a92-4cba-98f9-762310237c79"><div class="modal-content"><h4>/home/gary/projects/moose/modules/phase_field/examples/kim-kim-suzuki/kks_example_ternary.i</h4><pre class="moose-pre"><code class="language-text">#
# KKS ternary (3 chemical component) system example in the split form
# We track c1 and c2 only, since c1 + c2 + c3 = 1
#

[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 150
  ny = 15
  nz = 0
  xmin = -25
  xmax = 25
  ymin = -2.5
  ymax = 2.5
  zmin = 0
  zmax = 0
  elem_type = QUAD4
[]

[AuxVariables]
  [./Fglobal]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[Variables]
  # order parameter
  [./eta]
    order = FIRST
    family = LAGRANGE
  [../]

  # solute 1 concentration
  [./c1]
    order = FIRST
    family = LAGRANGE
  [../]

  # solute 2 concentration
  [./c2]
    order = FIRST
    family = LAGRANGE
  [../]

  # chemical potential solute 1
  [./w1]
    order = FIRST
    family = LAGRANGE
  [../]

  # chemical potential solute 2
  [./w2]
    order = FIRST
    family = LAGRANGE
  [../]

  # Liquid phase solute 1 concentration
  [./c1l]
    order = FIRST
    family = LAGRANGE
    initial_condition = 0.1
  [../]

  # Liquid phase solute 2 concentration
  [./c2l]
    order = FIRST
    family = LAGRANGE
    initial_condition = 0.05
  [../]

  # Solid phase solute 1 concentration
  [./c1s]
    order = FIRST
    family = LAGRANGE
    initial_condition = 0.8
  [../]

  # Solid phase solute 2 concentration
  [./c2s]
    order = FIRST
    family = LAGRANGE
    initial_condition = 0.1
  [../]

[]

[Functions]
  [./ic_func_eta]
    type = ParsedFunction
    value = &#x27;0.5*(1.0-tanh((x)/sqrt(2.0)))&#x27;
  [../]
  [./ic_func_c1]
    type = ParsedFunction
    value = &#x27;0.8*(0.5*(1.0-tanh(x/sqrt(2.0))))^3*(6*(0.5*(1.0-tanh(x/sqrt(2.0))))^2-15*(0.5*(1.0-tanh(x/sqrt(2.0))))+10)+0.1*(1-(0.5*(1.0-tanh(x/sqrt(2.0))))^3*(6*(0.5*(1.0-tanh(x/sqrt(2.0))))^2-15*(0.5*(1.0-tanh(x/sqrt(2.0))))+10))&#x27;
  [../]
  [./ic_func_c2]
    type = ParsedFunction
    value = &#x27;0.1*(0.5*(1.0-tanh(x/sqrt(2.0))))^3*(6*(0.5*(1.0-tanh(x/sqrt(2.0))))^2-15*(0.5*(1.0-tanh(x/sqrt(2.0))))+10)+0.05*(1-(0.5*(1.0-tanh(x/sqrt(2.0))))^3*(6*(0.5*(1.0-tanh(x/sqrt(2.0))))^2-15*(0.5*(1.0-tanh(x/sqrt(2.0))))+10))&#x27;
  [../]

[]

[ICs]
  [./eta]
    variable = eta
    type = FunctionIC
    function = ic_func_eta
  [../]
  [./c1]
    variable = c1
    type = FunctionIC
    function = ic_func_c1
  [../]
  [./c2]
    variable = c2
    type = FunctionIC
    function = ic_func_c2
  [../]

[]

[Materials]
  # Free energy of the liquid
  [./fl]
    type = DerivativeParsedMaterial
    f_name = fl
    args = &#x27;c1l c2l&#x27;
    function = &#x27;(0.1-c1l)^2+(0.05-c2l)^2&#x27;
  [../]

  # Free energy of the solid
  [./fs]
    type = DerivativeParsedMaterial
    f_name = fs
    args = &#x27;c1s c2s&#x27;
    function = &#x27;(0.8-c1s)^2+(0.1-c2s)^2&#x27;
  [../]

  # h(eta)
  [./h_eta]
    type = SwitchingFunctionMaterial
    h_order = HIGH
    eta = eta
  [../]

  # g(eta)
  [./g_eta]
    type = BarrierFunctionMaterial
    g_order = SIMPLE
    eta = eta
  [../]

  # constant properties
  [./constants]
    type = GenericConstantMaterial
    prop_names  = &#x27;M   L   eps_sq&#x27;
    prop_values = &#x27;0.7 0.7 1.0  &#x27;
  [../]
[]

[Kernels]
  # enforce c1 = (1-h(eta))*c1l + h(eta)*c1s
  [./PhaseConc1]
    type = KKSPhaseConcentration
    ca       = c1l
    variable = c1s
    c        = c1
    eta      = eta
  [../]

  # enforce c2 = (1-h(eta))*c2l + h(eta)*c2s
  [./PhaseConc2]
    type = KKSPhaseConcentration
    ca       = c2l
    variable = c2s
    c        = c2
    eta      = eta
  [../]

  # enforce pointwise equality of chemical potentials
  [./ChemPotSolute1]
    type = KKSPhaseChemicalPotential
    variable = c1l
    cb       = c1s
    fa_name  = fl
    fb_name  = fs
    args_a   = &#x27;c2l&#x27;
    args_b   = &#x27;c2s&#x27;
  [../]
  [./ChemPotSolute2]
    type = KKSPhaseChemicalPotential
    variable = c2l
    cb       = c2s
    fa_name  = fl
    fb_name  = fs
    args_a   = &#x27;c1l&#x27;
    args_b   = &#x27;c1s&#x27;

  [../]

  #
  # Cahn-Hilliard Equations
  #
  [./CHBulk1]
    type = KKSSplitCHCRes
    variable = c1
    ca       = c1l
    fa_name  = fl
    w        = w1
    args_a   = &#x27;c2l&#x27;
  [../]
  [./CHBulk2]
    type = KKSSplitCHCRes
    variable = c2
    ca       = c2l
    fa_name  = fl
    w        = w2
    args_a   = &#x27;c1l&#x27;
  [../]

  [./dc1dt]
    type = CoupledTimeDerivative
    variable = w1
    v = c1
  [../]
  [./dc2dt]
    type = CoupledTimeDerivative
    variable = w2
    v = c2
  [../]

  [./w1kernel]
    type = SplitCHWRes
    mob_name = M
    variable = w1
  [../]
  [./w2kernel]
    type = SplitCHWRes
    mob_name = M
    variable = w2
  [../]

  #
  # Allen-Cahn Equation
  #
  [./ACBulkF]
    type = KKSACBulkF
    variable = eta
    fa_name  = fl
    fb_name  = fs
    w        = 1.0
    args = &#x27;c1l c1s c2l c2s&#x27;
  [../]
  [./ACBulkC1]
    type = KKSACBulkC
    variable = eta
    ca       = c1l
    cb       = c1s
    fa_name  = fl
    args     = &#x27;c2l&#x27;
  [../]
  [./ACBulkC2]
    type = KKSACBulkC
    variable = eta
    ca       = c2l
    cb       = c2s
    fa_name  = fl
    args     = &#x27;c1l&#x27;
  [../]
  [./ACInterface]
    type = ACInterface
    variable = eta
    kappa_name = eps_sq
  [../]
  [./detadt]
    type = TimeDerivative
    variable = eta
  [../]
[]

[AuxKernels]
  [./GlobalFreeEnergy]
    variable = Fglobal
    type = KKSGlobalFreeEnergy
    fa_name = fl
    fb_name = fs
    w = 1.0
  [../]
[]

[Executioner]
  type = Transient
  solve_type = &#x27;PJFNK&#x27;

  petsc_options_iname = &#x27;-pc_type -sub_pc_type -sub_pc_factor_shift_type&#x27;
  petsc_options_value = &#x27;asm      ilu          nonzero&#x27;

  l_max_its = 100
  nl_max_its = 100

  num_steps = 50
  dt = 0.1
[]

#
# Precondition using handcoded off-diagonal terms
#
[Preconditioning]
  [./full]
    type = SMP
    full = true
  [../]
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><p>When additional chemical components are added to the KKS model, a Cahn-Hilliard equation must be added for each additional component. (For <span tex="n" bookmark="moose-equation-49129f4b-01fc-4c61-9711-dcfe0d346cf9" recursive="True" class="moose-katex-inline-equation" id="moose-equation-49129f4b-01fc-4c61-9711-dcfe0d346cf9"><script>var element = document.getElementById("moose-equation-49129f4b-01fc-4c61-9711-dcfe0d346cf9");katex.render("n", element, {displayMode:false,throwOnError:false});</script></span> components, <span tex="n-1" bookmark="moose-equation-ee9487d8-1a06-464e-be93-53dcc4c9427a" recursive="True" class="moose-katex-inline-equation" id="moose-equation-ee9487d8-1a06-464e-be93-53dcc4c9427a"><script>var element = document.getElementById("moose-equation-ee9487d8-1a06-464e-be93-53dcc4c9427a");katex.render("n-1", element, {displayMode:false,throwOnError:false});</script></span> Cahn-Hilliard equations are required). Each additional Cahn-Hilliard equation requires the kernels:</p><ul class="browser-default"><li><p><a href="../../../source/kernels/KKSSplitCHCRes.html"><code>KKSSplitCHCRes</code></a> </p></li><li><p><a href="../../../source/kernels/CoupledTimeDerivative.html"><code>CoupledTimeDerivative</code></a> </p></li><li><p><a href="../../../source/kernels/SplitCHWRes.html"><code>SplitCHWRes</code></a></p></li></ul><p>To enforce the composition and chemical potential constraints, each additional component also requires the kernels</p><ul class="browser-default"><li><p><a href="../../../source/kernels/KKSPhaseConcentration.html"><code>KKSPhaseConcentration</code></a> </p></li><li><p><a href="../../../source/kernels/KKSPhaseChemicalPotential.html"><code>KKSPhaseChemicalPotential</code></a></p></li></ul><p>The Allen-Cahn equation is also modified when additional components are added. The residual becomes</p><p><span class="moose-katex-block-equation"><span tex="R=-\frac{dh}{d\eta} \left(F_a-F_b- \sum_{i=1}^{n-1} \frac{dF_a}{dc_{ia}}(c_{ia}-c_{ib})\right) + w\frac{dg}{d\eta}." bookmark="moose-equation-0bceed14-1e64-413c-ba6f-d97501af69b8" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-0bceed14-1e64-413c-ba6f-d97501af69b8"></span><script>var element = document.getElementById("moose-equation-0bceed14-1e64-413c-ba6f-d97501af69b8");katex.render("R=-\\frac{dh}{d\\eta} \\left(F_a-F_b- \\sum_{i=1}^{n-1} \\frac{dF_a}{dc_{ia}}(c_{ia}-c_{ib})\\right) + w\\frac{dg}{d\\eta}.", element, {displayMode:true,throwOnError:false});</script></span></p><p>where <span tex="n" bookmark="moose-equation-76ec4669-ecad-41b3-a808-6b4989f9f2ac" recursive="True" class="moose-katex-inline-equation" id="moose-equation-76ec4669-ecad-41b3-a808-6b4989f9f2ac"><script>var element = document.getElementById("moose-equation-76ec4669-ecad-41b3-a808-6b4989f9f2ac");katex.render("n", element, {displayMode:false,throwOnError:false});</script></span> is the number of components. A single <a href="../../../source/kernels/KKSACBulkF.html"><code>KKSACBulkF</code></a> kernel is needed as in the 2-component case, and an additional <a href="../../../source/kernels/KKSACBulkC.html"><code>KKSACBulkC</code></a> kernel must added for each additional component. </p></section></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"></ul></div></div></div></div></main></div></body><script type="text/javascript" src="../../../contrib/jquery/jquery.min.js"></script><script type="text/javascript" src="../../../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../../../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../../../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../../../js/init.js"></script><script type="text/javascript" src="../../../js/navigation.js"></script><script type="text/javascript" src="../../../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../../../js/search_index.js"></script>