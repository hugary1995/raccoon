<!DOCTYPE html><head><meta charset="UTF-8"><link rel="icon" type="image/x-icon" href="../../media/raccoon_icon.png" sizes="16x16 32x32 64x64 128x128"></link><link href="../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../../contrib/katex/katex.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/katex_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../../contrib/katex/katex.min.js"></script><script type="text/javascript" src="../../contrib/plotly/plotly.min.js"></script><title>Radial Return Stress Update with automatic differentaiation|RACCOON</title></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="https://hugary1995.github.io/raccoon/index.html" class="left moose-logo hide-on-med-and-down">RACCOON</a><a href="https://github.com/hugary1995/raccoon" class="right"><img src="../../media/framework/github-logo.png" class="github-mark"></img><img src="../../media/framework/github-mark.png" class="github-logo"></img></a><ul class="right hide-on-med-and-down"><li><a href="../../install/index.html">Install</a></li><li><a href="../../examples/index.html">Examples</a></li><li><a href="../../theory/index.html">Theory</a></li><li><a href="../../documentation/index.html">Documentation</a></li></ul><a href="#" class="sidenav-trigger" data-target="3987cde9-a77c-4ce3-a005-fafe63b602ba"><i class="material-icons">menu</i></a><ul class="sidenav" id="3987cde9-a77c-4ce3-a005-fafe63b602ba"><li><a href="../../install/index.html">Install</a></li><li><a href="../../examples/index.html">Examples</a></li><li><a href="../../theory/index.html">Theory</a></li><li><a href="../../documentation/index.html">Documentation</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="https://hugary1995.github.io/raccoon/index.html" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><a href=".." class="breadcrumb">source</a><span class="breadcrumb">materials</span><a href="#" class="breadcrumb">ADRadialReturnStressUpdate</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section id="9b06c8cb-c605-4644-9970-08b6c68c8f58" data-section-level="1" data-section-text="Radial Return Stress Update with automatic differentaiation"><h1 id="radial-return-stress-update-with-automatic-differentaiation">Radial Return Stress Update with automatic differentaiation</h1><p>Base class which calculates the effective inelastic strain increment required to return the isotropic stress state to a J2 yield surface.  This class is intended to be a parent class for classes with specific constitutive models.</p><section id="dd6554c1-8d63-4dac-8a1e-ab315abd3cab" data-section-level="3" data-section-text="Algorithm References"><h3 id="algorithm-references">Algorithm References</h3><p>The radial return mapping method, introduced by Simo and Taylor (1985), uses a von Mises yield surface to determine the increment of plastic strain necessary to return the stress state to the yield surface after a trial stress increment takes the computed stress state across the yield surface.  Because the von Mises yield surface in the deviatoric stress space has the shape of a circle, the _plastic correction stress_ is always directed towards the center of the yield surface circle.</p><p>In addition to the <a href="#simo2006computational">Simo and Hughes (2006)</a> textbook, <a href="#dunne2005introduction">Dunne and Petrinic (2005)</a> is an excellent reference for users working with the <code>RadialReturnStressUpdate</code> materials; several of the isotropic plasticity and creep effective plastic strain increment algorithms are taken from <a href="#dunne2005introduction">Dunne and Petrinic (2005)</a>.</p></section><section id="1b085c19-e731-42e2-b5a1-67d110759fdd" data-section-level="3" data-section-text="The Radial Return Stress Update Description"><h3 id="the-radial-return-stress-update-description">The Radial Return Stress Update Description</h3><p>The stress update materials are not called by MOOSE directly but instead only by other materials using the <code>computeProperties</code> method.  For the <code>ADRadialReturnStressUpdate</code> materials, this calling material is <a href="ADComputeMultipleInelasticStress.html">ADComputeMultipleInelasticStress</a>. Separating the call to the stress update materials from MOOSE allows us to iteratively call the stress update materials as is required to achieve convergence.</p></section></section><section class="scrollspy" id="57a82aba-9497-453e-b563-499e8df69657" data-section-level="2" data-section-text="Radial Return Algorithm Overview"><h2 id="radial-return-algorithm-overview">Radial Return Algorithm Overview</h2><div class="card moose-float" style="width:30%;margin-left:2%;float:right"><div class="card-content"><img src="../../media/tensor_mechanics/RadialReturnStressSpace.png" class="materialboxed moose-image"></img><p class="moose-caption"><span class="moose-caption-text">A trial stress is shown outside of the deviatoric yield surface and the radial return                  stress which is normal to the yield surface.</span></p></div></div><p>In this numerical approach, a trial stress is calculated at the start of each simulation time increment; the trial stress calculation assumed all of the new strain increment is elastic strain:</p><p><span class="moose-katex-block-equation"><span tex="\sigma_{trial} = C_{ijkl} \left( \Delta \epsilon_{assumed-elastic} + \epsilon_{elastic}^{old} \right)" bookmark="moose-equation-8dce9d0a-8a03-41f6-9978-c9d41756558f" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-8dce9d0a-8a03-41f6-9978-c9d41756558f"></span><script>var element = document.getElementById("moose-equation-8dce9d0a-8a03-41f6-9978-c9d41756558f");katex.render("\\sigma_{trial} = C_{ijkl} \\left( \\Delta \\epsilon_{assumed-elastic} + \\epsilon_{elastic}^{old} \\right)", element, {displayMode:true,throwOnError:false});</script></span></p><p>The algorithms checks to see if the trial stress state is outside of the yield surface, as shown in the figure to the right. If the stress state is outside of the yield surface, the algorithm recomputes the scalar effective inelastic strain required to return the stress state to the yield surface. This approach is given the name Radial Return because the yield surface used is the <a href="https://en.wikipedia.org/wiki/Von_Mises_yield_criterion">von Mises yield surface</a>: in the <a href="https://en.wikipedia.org/wiki/Cauchy_stress_tensor#Stress_deviator_tensor">devitoric stress space</a>, this yield surface has the shape of a circle, and the scalar inelastic strain is assumed to always be directed at the circle center.</p><section id="3297ab20-d019-489c-b6a1-5c69bcf760ad" data-section-level="3" data-section-text="Recompute Iterations on the Effective Plastic Strain Increment"><h3 id="recompute-iterations-on-the-effective-plastic-strain-increment">Recompute Iterations on the Effective Plastic Strain Increment</h3><p>The recompute radial return materials each individually calculate, using the <a href="http://mathworld.wolfram.com/NewtonsMethod.html">Newton Method</a>, the amount of effective inelastic strain required to return the stress state to the yield surface.</p><p><span class="moose-katex-block-equation"><span tex="\Delta p^{(t+1)} = \Delta p^t + d \Delta p" bookmark="moose-equation-721fd46b-4993-4078-8ef3-c9c6cea69daf" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-721fd46b-4993-4078-8ef3-c9c6cea69daf"></span><script>var element = document.getElementById("moose-equation-721fd46b-4993-4078-8ef3-c9c6cea69daf");katex.render("\\Delta p^{(t+1)} = \\Delta p^t + d \\Delta p", element, {displayMode:true,throwOnError:false});</script></span></p><p>where the change in the iterative effective inelastic strain is defined as the yield surface over the derivative of the yield surface with respect to the inelastic strain increment. </p><p>In the case of isotropic linear hardening plasticity, with the hardening function $ r = hp<span tex=", the effective plastic strain increment has the form: \begin{equation}  d \Delta p = \frac{\sigma^{trial}_{effective} - 3 G \Delta p - r - \sigma_{yield}}{3G + h} \end{equation} where G is the isotropic shear modulus, and $\sigma^{trial}_{effective}" bookmark="moose-equation-2fdb5518-955d-4aac-b2c2-3c89c1dc7295" recursive="True" class="moose-katex-inline-equation" id="moose-equation-2fdb5518-955d-4aac-b2c2-3c89c1dc7295"><script>var element = document.getElementById("moose-equation-2fdb5518-955d-4aac-b2c2-3c89c1dc7295");katex.render(", the effective plastic strain increment has the form: \\begin{equation}  d \\Delta p = \\frac{\\sigma^{trial}_{effective} - 3 G \\Delta p - r - \\sigma_{yield}}{3G + h} \\end{equation} where G is the isotropic shear modulus, and $\\sigma^{trial}_{effective}", element, {displayMode:false,throwOnError:false});</script></span> is the scalar von Mises trial stress.</p><p>Once convergence has been reached on the scalar inelastic strain increment, the full inelastic strain tensor is calculated. <span class="moose-katex-block-equation"><span tex="\Delta \epsilon^{inelastic}_{ij} = \frac{3}{2} \Delta p^{(t+1)} \frac{dev(\sigma^{trial}_{ij})}{\sigma^{trial}_{effective}}" bookmark="moose-equation-8d79361d-2065-4ad0-9ecc-b571d77938ec" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-8d79361d-2065-4ad0-9ecc-b571d77938ec"></span><script>var element = document.getElementById("moose-equation-8d79361d-2065-4ad0-9ecc-b571d77938ec");katex.render("\\Delta \\epsilon^{inelastic}_{ij} = \\frac{3}{2} \\Delta p^{(t+1)} \\frac{dev(\\sigma^{trial}_{ij})}{\\sigma^{trial}_{effective}}", element, {displayMode:true,throwOnError:false});</script></span></p><p>The elastic strain is calculated by subtracting the return mapping inelastic strain increment tensor from the mechanical strain tensor.  Mechanical strain is considered as the sum of the elastic and inelastic (plastic, creep, ect) strains. <span class="moose-katex-block-equation"><span tex="\epsilon_{total} = \epsilon_{mechanical} + \epsilon_{eigenstrain} = \left( \epsilon_{elastic} + \epsilon_{inelastic} \right) + \epsilon_{eigenstrain} = \epsilon_{elastic} + \left( \epsilon_{plastic} + \epsilon_{creep} + \epsilon_{damage}  \right) + \epsilon_{eigenstrain}" bookmark="moose-equation-09c5c9c2-34a8-45a2-9150-fde98aa5b68e" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-09c5c9c2-34a8-45a2-9150-fde98aa5b68e"></span><script>var element = document.getElementById("moose-equation-09c5c9c2-34a8-45a2-9150-fde98aa5b68e");katex.render("\\epsilon_{total} = \\epsilon_{mechanical} + \\epsilon_{eigenstrain} = \\left( \\epsilon_{elastic} + \\epsilon_{inelastic} \\right) + \\epsilon_{eigenstrain} = \\epsilon_{elastic} + \\left( \\epsilon_{plastic} + \\epsilon_{creep} + \\epsilon_{damage}  \\right) + \\epsilon_{eigenstrain}", element, {displayMode:true,throwOnError:false});</script></span></p><p>The final inelastic strain is returned from the radial return stress update material, and <code>ComputeMultipleInelasticStress</code> computes the stress, with a return mapping stress increment following elasticity theory for finite strains. The final stress is calculated from the elastic strain increment. <span class="moose-katex-block-equation"><span tex="\sigma^{new}_{ij} = C_{ijkl} \left( \Delta \epsilon^{elastic}_{kl} + \epsilon^{old-elastic}_{kl} \right)" bookmark="moose-equation-bf7f366d-f4dc-45d4-abd0-ee98c4abee06" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-bf7f366d-f4dc-45d4-abd0-ee98c4abee06"></span><script>var element = document.getElementById("moose-equation-bf7f366d-f4dc-45d4-abd0-ee98c4abee06");katex.render("\\sigma^{new}_{ij} = C_{ijkl} \\left( \\Delta \\epsilon^{elastic}_{kl} + \\epsilon^{old-elastic}_{kl} \\right)", element, {displayMode:true,throwOnError:false});</script></span></p><p>When more than one radial recompute material is included in the simulation, as in Combined Power Law Creep and Linear Strain Hardening, <code>ComputeMultipleInelasticStress</code> will iterate over the change in the calculated stress until the return stress has reached a stable value.</p><p>Users can print out any of these strains and stresses using the <code>RankTwoAux</code> as described on the <a href="../../modules/tensor_mechanics/VisualizingTensors.html">Visualizing Tensors</a> page.</p></section></section><section class="scrollspy" id="65e006b9-eb6e-4f2c-bf35-36627d5dcfa1" data-section-level="2" data-section-text="Writing a New Stress Update Material New radial return models must inherit from and must overwrite the six virtual methods . RadialReturnStressUpdate"><h2 id="writing-a-new-stress-update-material-new-radial-return-models-must-inherit-from-and-must-overwrite-the-six-virtual-methods">Writing a New Stress Update Material New radial return models must inherit from <code>RadialReturnStressUpdate</code> and must overwrite the six virtual methods.</h2><ul class="browser-default"><li><p><strong>initQpStatefulProperties</strong>: Set the initial values for all new material properties that are not initialized by an input parameter; generally the material properties initialized in this method are all set to zero. </p></li><li><p><strong>computeStressInitialize</strong>: Calculate the initial trial stress state, the yield surface value, and any hardening or softening parameters at the start of the simulation time increment. </p></li><li><p><strong>computeResidual</strong>: In each iteration over the inelastic strain increment, calculate the value of the effective scalar trial stress subtracted by the yield surface function. </p></li><li><p><strong>computeDerivative</strong>: In each iteration over the inelastic strain increment, calculate the derivative of the yield surface function with respect to the inelastic strain increment. </p></li><li><p><strong>iterationFinalize</strong>: Store the value of the inelastic strain increment at the end of each iteration. </p></li><li><p><strong>computeStressFinalize</strong>: Update the stress after convergence on the inelastic strain increment has been reached.</p></li></ul><p>Additionally, new radial return methods must also overwrite a single method from the MOOSE <code>Material</code> class.</p><ul class="browser-default"><li><p><strong>resetQpProperties</strong>: Set the material property used in the iteration, usually <span tex="\Delta p" bookmark="moose-equation-e9c835f7-626c-464a-87f5-4295291993b0" recursive="True" class="moose-katex-inline-equation" id="moose-equation-e9c835f7-626c-464a-87f5-4295291993b0"><script>var element = document.getElementById("moose-equation-e9c835f7-626c-464a-87f5-4295291993b0");katex.render("\\Delta p", element, {displayMode:false,throwOnError:false});</script></span>, to zero at the start the iteration.  This method is necessary to avoid incorrect material property values.</p></li></ul><p>More details on how to write the equivalent yield surface equation for a creep model are given in Dunne and Petrinic.</p><p></p></section><section class="scrollspy" id="11f96170-a1e2-4692-a3eb-0f21769e71c3" data-section-level="2" data-section-text="References"><h2 id="references">References</h2><div class="moose-bibliography"><ol><li id="dunne2005introduction">Fionn Dunne and Nik Petrinic.
<em>Introduction to Computational Plasticity</em>.
Oxford University Press on Demand, 2005.<a href="#e84ddeb1-31ed-4511-b9d4-769eea805d09" class="modal-trigger moose-bibtex-modal" style="padding-left:10px;">[BibTeX]</a><div class="modal" id="e84ddeb1-31ed-4511-b9d4-769eea805d09"><div class="modal-content"><pre style="line-height:1.25;"><code class="language-latex">@book{dunne2005introduction,
    author = "Dunne, Fionn and Petrinic, Nik",
    title = "Introduction to Computational Plasticity",
    year = "2005",
    publisher = "Oxford University Press on Demand"
}
</code></pre></div></div></li><li id="simo2006computational">Juan&nbsp;C Simo and Thomas&nbsp;JR Hughes.
<em>Computational inelasticity</em>.
Volume&nbsp;7.
Springer Science &amp; Business Media, 2006.<a href="#ea87147d-63f5-4bd1-806a-5a9201750839" class="modal-trigger moose-bibtex-modal" style="padding-left:10px;">[BibTeX]</a><div class="modal" id="ea87147d-63f5-4bd1-806a-5a9201750839"><div class="modal-content"><pre style="line-height:1.25;"><code class="language-latex">@book{simo2006computational,
    author = "Simo, Juan C and Hughes, Thomas JR",
    title = "Computational inelasticity",
    volume = "7",
    year = "2006",
    publisher = "Springer Science \\& Business Media"
}
</code></pre></div></div></li></ol></div></section></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a href="#57a82aba-9497-453e-b563-499e8df69657" class="tooltipped" data-position="left" data-tooltip="Radial Return Algorithm Overview">Radial Return Algorithm Overview</a></li><li><a href="#65e006b9-eb6e-4f2c-bf35-36627d5dcfa1" class="tooltipped" data-position="left" data-tooltip="Writing a New Stress Update Material New radial return models must inherit from and must overwrite the six virtual methods . RadialReturnStressUpdate">Writing a New Stress Update Material New radial return models must inherit from and must overwrite the six virtual methods . RadialReturnStressUpdate</a></li><li><a href="#11f96170-a1e2-4692-a3eb-0f21769e71c3" class="tooltipped" data-position="left" data-tooltip="References">References</a></li></ul></div></div></div></div></main></div></body><script type="text/javascript" src="../../contrib/jquery/jquery.min.js"></script><script type="text/javascript" src="../../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../../js/init.js"></script><script type="text/javascript" src="../../js/navigation.js"></script><script type="text/javascript" src="../../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../../js/search_index.js"></script>