<!DOCTYPE html><head><meta charset="UTF-8"><link rel="icon" type="image/x-icon" href="../../media/raccoon_icon.png" sizes="16x16 32x32 64x64 128x128"></link><link href="../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../../contrib/katex/katex.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/katex_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../../contrib/katex/katex.min.js"></script><script type="text/javascript" src="../../contrib/plotly/plotly.min.js"></script><title>MultiApp System|RACCOON</title></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="https://hugary1995.github.io/raccoon/index.html" class="left moose-logo hide-on-med-and-down">RACCOON</a><a href="https://github.com/hugary1995/raccoon" class="right"><img src="../../media/framework/github-logo.png" class="github-mark"></img><img src="../../media/framework/github-mark.png" class="github-logo"></img></a><ul class="right hide-on-med-and-down"><li><a href="../../install/index.html">Install</a></li><li><a href="../../examples/index.html">Examples</a></li><li><a href="../../theory/index.html">Theory</a></li><li><a href="../../documentation/index.html">Documentation</a></li></ul><a href="#" class="sidenav-trigger" data-target="265b4256-72eb-40d9-aa3f-d58510fb11e1"><i class="material-icons">menu</i></a><ul class="sidenav" id="265b4256-72eb-40d9-aa3f-d58510fb11e1"><li><a href="../../install/index.html">Install</a></li><li><a href="../../examples/index.html">Examples</a></li><li><a href="../../theory/index.html">Theory</a></li><li><a href="../../documentation/index.html">Documentation</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="https://hugary1995.github.io/raccoon/index.html" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><a href=".." class="breadcrumb">syntax</a><a href="." class="breadcrumb">MultiApps</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section id="b308ea91-a3ed-49de-b8c0-3daf7f97f2ed" data-section-level="1" data-section-text="MultiApp System"><h1 id="multiapp-system">MultiApp System</h1><section class="scrollspy" id="5d9d0daf-b4ea-4df3-a402-d3eeeacfcbb6" data-section-level="2" data-section-text="Overview"><h2 id="overview">Overview</h2><p>MOOSE was originally created to solve fully-coupled systems of <span>partial differential equations (PDEs)</span>, but not all systems need to be or are fully coupled:</p><ul class="browser-default"><li><p>multiscale systems are generally loosely coupled between scales; </p></li><li><p>systems with both fast and slow physics can be decoupled in time; and </p></li><li><p>simulations involving input from external codes might be solved somewhat decoupled.</p></li></ul><p>To MOOSE these situations look like loosely-coupled systems of fully-coupled equations. A <code>MultiApp</code> allows you to simultaneously solve for individual physics systems.</p><p>Each sub-application (app) is considered independent. There is always a &quot;master&quot; app that is doing the primary solve. The &quot;master&quot; app can then have any number of <code>MultiApp</code> objects. Each <code>MultiApp</code> can represent many (hence Multi) &quot;sub-applications&quot; (sub-apps). The sub-apps can be solving for completely different physics from the main application.  They can be other MOOSE applications, or might represent external applications. A sub-app can, itself, have <code>MultiApps</code>, leading to multi-level solves, as shown below.</p><div class="card moose-float" style="width:60%;margin-left:auto;margin-right:auto;" id="multiapps"><div class="card-content"><img src="../../large_media/tutorials/multiapp_hierarchy.png" class="materialboxed moose-image"></img><p class="moose-caption"><span class="moose-caption-heading">Figure 1: </span><span class="moose-caption-text">Example multi-level MultiApp hierarchy.</span></p></div></div></section><section class="scrollspy" id="c0931423-7562-42c1-82b3-5628634a2b68" data-section-level="2" data-section-text="Input File Syntax"><h2 id="input-file-syntax">Input File Syntax</h2><p><code>MultiApp</code> objects are declared in the <code>[MultiApps]</code> block and require a &quot;type&quot; just like may other blocks.</p><p>The <span class="moose-parameter-name tooltipped" data-tooltip="The type of application to build (applications not registered can be loaded with dynamic libraries. Master application type will be used if not provided." data-position="bottom" data-delay="5">&quot;app_type&quot;</span> is required and is the name of the <code>MooseApp</code> derived app that is going to be executed. Generally, this is the name of the application being executed, therefore if this parameter is omitted it will default as such. However this system is designed for running another applications that are compiled or linked into the current app.</p><p>A <code>MultiApp</code> can be executed at any point during the master solve by setting the <span class="moose-parameter-name tooltipped" data-tooltip="The list of flag(s) indicating when this object should be executed, the available options include NONE, INITIAL, LINEAR, NONLINEAR, TIMESTEP_END, TIMESTEP_BEGIN, FINAL, CUSTOM." data-position="bottom" data-delay="5">&quot;execute_on&quot;</span> parameter. The <span class="moose-parameter-name tooltipped" data-tooltip="The positions of the App locations.  Each set of 3 values will represent a Point.  This and 'positions_file' cannot be both supplied. If this and 'positions_file' are not supplied, a single position (0,0,0) will be used" data-position="bottom" data-delay="5">&quot;positions&quot;</span> parameters is a list of 3D coordinate pairs describing the offset of the sub-application(s) into the physical space of the master application, see <a href="#multiapp-positions">Positions</a> for more information. A single fir for all the sub-apps or a file for each position may be provided.</p><pre class="moose-pre"><code class="language-text">[MultiApps]
  [sub_app]
    type = TransientMultiApp
    app_type = MooseTestApp
    input_files = &#x27;dt_from_master_sub.i&#x27;
    positions = &#x27;0   0   0
                 0.5 0.5 0
                 0.6 0.6 0
                 0.7 0.7 0&#x27;
  []
[]
</code></pre><a href="#b7b1e4f5-06c2-43f8-bc49-c0fd697a1c82" class="modal-trigger">(../moose/test/tests/multiapps/transient_multiapp/dt_from_master.i)</a><div class="modal moose-modal" id="b7b1e4f5-06c2-43f8-bc49-c0fd697a1c82"><div class="modal-content"><h4>/home/gary/projects/moose/test/tests/multiapps/transient_multiapp/dt_from_master.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 10
  ny = 10
[]

[Variables]
  [./u]
  [../]
[]

[Kernels]
  [./diff]
    type = Diffusion
    variable = u
  [../]
  [./td]
    type = TimeDerivative
    variable = u
  [../]
[]

[BCs]
  [./left]
    type = DirichletBC
    variable = u
    boundary = left
    value = 0
  [../]
  [./right]
    type = DirichletBC
    variable = u
    boundary = right
    value = 1
  [../]
[]

[Executioner]
  type = Transient
  num_steps = 10
  dt = 0.2

  solve_type = &#x27;PJFNK&#x27;

  petsc_options_iname = &#x27;-pc_type -pc_hypre_type&#x27;
  petsc_options_value = &#x27;hypre boomeramg&#x27;
[]

[Outputs]
  exodus = true
[]

[MultiApps]
  [sub_app]
    type = TransientMultiApp
    app_type = MooseTestApp
    input_files = &#x27;dt_from_master_sub.i&#x27;
    positions = &#x27;0   0   0
                 0.5 0.5 0
                 0.6 0.6 0
                 0.7 0.7 0&#x27;
  []
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div></section><section class="scrollspy" id="a54c4c4d-66c2-4d8f-80ea-5b973204c15f" data-section-level="2" data-section-text="Positions"><h2 id="multiapp-positions">Positions</h2><p>The <span class="moose-parameter-name tooltipped" data-tooltip="The positions of the App locations.  Each set of 3 values will represent a Point.  This and 'positions_file' cannot be both supplied. If this and 'positions_file' are not supplied, a single position (0,0,0) will be used" data-position="bottom" data-delay="5">&quot;positions&quot;</span> parameter is a coordinate offset from the master app domain to the sub-app domain, as illustrated by <a href="#multiapps_pos">Figure 2</a>. The parameter requires the positions to be provided as a set of <span tex="(x, y, z)" bookmark="moose-equation-32a0f0c0-b848-4098-9686-62e2bcce90b4" recursive="True" class="moose-katex-inline-equation" id="moose-equation-32a0f0c0-b848-4098-9686-62e2bcce90b4"><script>var element = document.getElementById("moose-equation-32a0f0c0-b848-4098-9686-62e2bcce90b4");katex.render("(x, y, z)", element, {displayMode:false,throwOnError:false});</script></span> coordinates for each sub-app.</p><p>The number of coordinate sets determines the actual number of sub-applications created.  If there is a large number of positions a file can be provided instead using the <span class="moose-parameter-name tooltipped" data-tooltip="A filename that should be looked in for positions. Each set of 3 values in that file will represent a Point.  This and 'positions' cannot be both supplied" data-position="bottom" data-delay="5">&quot;positions_file&quot;</span> parameter.</p><ul class="browser-default"><li><p>The <span tex="(x, y, z)" bookmark="moose-equation-693ca844-23ec-4e67-87e7-90011de1f6a9" recursive="True" class="moose-katex-inline-equation" id="moose-equation-693ca844-23ec-4e67-87e7-90011de1f6a9"><script>var element = document.getElementById("moose-equation-693ca844-23ec-4e67-87e7-90011de1f6a9");katex.render("(x, y, z)", element, {displayMode:false,throwOnError:false});</script></span> coordinates are a vector that is being added to the coordinates of the sub-app&#x27;s domain to put that domain in a specific location within the master domain. </p></li><li><p>If the sub-app&#x27;s domain starts at <span tex="(0,0,0)" bookmark="moose-equation-211813cc-82ea-46ba-a60d-24bf611d6950" recursive="True" class="moose-katex-inline-equation" id="moose-equation-211813cc-82ea-46ba-a60d-24bf611d6950"><script>var element = document.getElementById("moose-equation-211813cc-82ea-46ba-a60d-24bf611d6950");katex.render("(0,0,0)", element, {displayMode:false,throwOnError:false});</script></span> it is easy to think of moving that point around using <span class="moose-parameter-name tooltipped" data-tooltip="The positions of the App locations.  Each set of 3 values will represent a Point.  This and 'positions_file' cannot be both supplied. If this and 'positions_file' are not supplied, a single position (0,0,0) will be used" data-position="bottom" data-delay="5">&quot;positions&quot;</span>. </p></li><li><p>For sub-apps on completely different scales, <code>positions</code> is the point in the master domain where that app is located.</p></li></ul><div class="card moose-float" style="width:80%;margin-left:auto;margin-right:auto;" id="multiapps_pos"><div class="card-content"><img src="../../large_media/framework/multiapps_positions.png" class="materialboxed moose-image"></img><p class="moose-caption"><span class="moose-caption-heading">Figure 2: </span><span class="moose-caption-text">Example of MultiApp object position.</span></p></div></div></section><section class="scrollspy" id="3d11f78f-4200-4339-9828-9ae7e90ffb85" data-section-level="2" data-section-text="Parallel Execution"><h2 id="parallel-execution">Parallel Execution</h2><p>The <code>MultiApp</code> system is designed for efficient parallel execution of hierarchical problems. The master application utilizes all processors.  Within each <code>MultiApp</code>, all of the processors are split among the sub-apps. If there are more sub-apps than processors, each processor will solve for multiple sub-apps.  All sub-apps of a given <code>MultiApp</code> are run simultaneously in parallel. Multiple <code>MultiApps</code> will be executed one after another.</p></section><section class="scrollspy" id="ebda7dcf-8f5c-4d44-b82b-00cd4d4fb626" data-section-level="2" data-section-text="Dynamically Loading Multiapps"><h2 id="dynamically-loading-multiapps">Dynamically Loading Multiapps</h2><p>If uilding with dynamic libraries (the default) other applications can be loaded without adding them to your Makefile and registering them. Simply set the proper <code>type</code> in your input file (e.g. <code>AnimalApp</code>) and MOOSE will attempt to find the other library dynamically.</p><ul class="browser-default"><li><p>The path (relative preferred) can be set in your input file using the parameter <span class="moose-parameter-name tooltipped" data-tooltip="Path to search for dynamic libraries (please avoid committing absolute paths in addition to MOOSE_LIBRARY_PATH)" data-position="bottom" data-delay="5">&quot;library_path&quot;</span>; this path needs to point to the <code>lib</code> folder within an application directory. </p></li><li><p>The <code>MOOSE_LIBRARY_PATH</code> may also be set to include paths for MOOSE to search.</p></li></ul><div class="card moose-alert moose-alert-warning"><div class="card-title moose-alert-title"><span class="moose-alert-title-brand">warning</span></div><div class="card-content"><div class="moose-alert-content"><p><p>Each application must be compiled separately since application the Makefile does not have any knowledge of the dependent application.</p></p></div></div></div></section><section class="scrollspy" id="dff9d800-0a64-4cc3-9333-a4b4113c766d" data-section-level="2" data-section-text="Available Objects"><h2 id="available-objects">Available Objects</h2><ul class="moose-syntax-list collection with-header"><li class="collection-header">Moose App</li><li class="collection-item"><a href="../../source/multiapps/CentroidMultiApp.html">CentroidMultiApp</a>Automatically generates Sub-App positions from centroids of elements in the master mesh.</li><li class="collection-item"><a href="../../source/multiapps/FullSolveMultiApp.html">FullSolveMultiApp</a>Performs a complete simulation during each execution.</li><li class="collection-item"><a href="../../source/multiapps/TransientMultiApp.html">TransientMultiApp</a>MultiApp for performing coupled simulations with the master and sub-application both progressing in time.</li></ul></section><section class="scrollspy" id="e3af467c-10ad-4bc4-951d-c447f3a9c80b" data-section-level="2" data-section-text="Available Actions"><h2 id="available-actions">Available Actions</h2><ul class="moose-syntax-list collection with-header"><li class="collection-header">Moose App</li><li class="collection-item"><a href="../../source/actions/AddMultiAppAction.html">AddMultiAppAction</a>MooseObjectAction for creating objects from sub-blocks within the MultiApps block.</li></ul></section></section></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a href="#5d9d0daf-b4ea-4df3-a402-d3eeeacfcbb6" class="tooltipped" data-position="left" data-tooltip="Overview">Overview</a></li><li><a href="#c0931423-7562-42c1-82b3-5628634a2b68" class="tooltipped" data-position="left" data-tooltip="Input File Syntax">Input File Syntax</a></li><li><a href="#a54c4c4d-66c2-4d8f-80ea-5b973204c15f" class="tooltipped" data-position="left" data-tooltip="Positions">Positions</a></li><li><a href="#3d11f78f-4200-4339-9828-9ae7e90ffb85" class="tooltipped" data-position="left" data-tooltip="Parallel Execution">Parallel Execution</a></li><li><a href="#ebda7dcf-8f5c-4d44-b82b-00cd4d4fb626" class="tooltipped" data-position="left" data-tooltip="Dynamically Loading Multiapps">Dynamically Loading Multiapps</a></li><li><a href="#dff9d800-0a64-4cc3-9333-a4b4113c766d" class="tooltipped" data-position="left" data-tooltip="Available Objects">Available Objects</a></li><li><a href="#e3af467c-10ad-4bc4-951d-c447f3a9c80b" class="tooltipped" data-position="left" data-tooltip="Available Actions">Available Actions</a></li></ul></div></div></div></div></main></div></body><script type="text/javascript" src="../../contrib/jquery/jquery.min.js"></script><script type="text/javascript" src="../../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../../js/init.js"></script><script type="text/javascript" src="../../js/navigation.js"></script><script type="text/javascript" src="../../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../../js/search_index.js"></script>