<!DOCTYPE html><head><meta charset="UTF-8"><title>SmallDeformationIsotropicElasticity | RACCOON</title><link rel="icon" type="image/x-icon" href="../../../media/raccoon_icon.png" sizes="16x16 32x32 64x64 128x128"></link><link href="../../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/devel_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/civet_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../contrib/katex/katex.min.css" type="text/css" rel="stylesheet"></link><link href="../../../css/katex_moose.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../../../contrib/jquery/jquery.min.js"></script><script type="text/javascript" src="../../../contrib/katex/katex.min.js"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="../../../index.html" class="left moose-logo hide-on-med-and-down" id="home-button">RACCOON</a><a href="https://github.com/hugary1995/raccoon" class="right"><img src="../../../media/framework/github-logo.png" alt="GitHub wordmark" class="github-mark"></img><img src="../../../media/framework/github-mark.png" alt="GitHub logo" class="github-logo"></img></a><ul class="right hide-on-med-and-down"><li><a href="#!" class="dropdown-trigger" data-target="96988929-28d7-4c43-a6b8-fde3d7f82754" data-constrainWidth="false">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="a6b8ddd5-2858-4452-aaed-d0d2d27b08df" data-constrainWidth="false">Tutorials<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="faa162a0-c8ce-413f-9eb0-4e168470dc7c" data-constrainWidth="false">Theory<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="0304f2f0-ccb2-4e75-8f1c-0c4c8ea9dcd4" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="../../../contribute/index.html">Contribute</a></li></ul><a href="#" class="sidenav-trigger" data-target="f7278ac9-ed00-43f2-8cb6-2c6a35ea433c"><i class="material-icons">menu</i></a><ul class="sidenav" id="f7278ac9-ed00-43f2-8cb6-2c6a35ea433c"><li><a href="#!" class="dropdown-trigger" data-target="5f8cb9b7-0ce2-438f-bf31-fef41c949ff8" data-constrainWidth="false">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="61f4365c-4ca6-4b0c-951b-9e59989b6d5f" data-constrainWidth="false">Tutorials<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="fe60d65e-30e0-49f4-bf4d-051f631ed225" data-constrainWidth="false">Theory<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="481463d5-fdcc-4827-9173-b3cf65d739cc" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="../../../contribute/index.html">Contribute</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div><ul class="dropdown-content" id="96988929-28d7-4c43-a6b8-fde3d7f82754"><li><a href="../../../getting_started/install.html">Install RACCOON</a></li><li><a href="../../../getting_started/update.html">Update RACCOON</a></li><li><a href="../../../getting_started/running.html">Running your first model</a></li><li><a href="../../../getting_started/paraview.html">Visualization</a></li><li><a href="../../../getting_started/ide.html">Code development</a></li><li><a href="../../../getting_started/docs.html">Browse the documentation locally</a></li></ul><ul class="dropdown-content" id="a6b8ddd5-2858-4452-aaed-d0d2d27b08df"><li><a href="../../../tutorials/01_small_deformation_elasticity.html">1. Small deformation</a></li><li><a href="../../../tutorials/02_mode1_brittle_fracture.html">2. Mode-I fracture</a></li><li><a href="../../../tutorials/03_mode2_brittle_fracture.html">3. Mode-II fracture</a></li><li><a href="../../../tutorials/04_fiber_reinforced_matrix.html">4. Fiber-reinforced matrix</a></li><li><a href="../../../tutorials/05_soil_desiccation.html">5. Soil desiccation</a></li><li><a href="../../../tutorials/06_large_deformation_elasticity.html">6. Large deformation</a></li><li><a href="../../../tutorials/07_elastoplasticity.html">7. Elastoplasticity</a></li><li><a href="../../../tutorials/08_ductile_fracture.html">8. Ductile fracture</a></li><li><a href="../../../tutorials/09_three_point_bending.html">9. Three-point bending</a></li><li><a href="../../../tutorials/10_quenching_bibeam.html">10. Quenching of bi-beam</a></li><li><a href="../../../tutorials/11_adaptivity.html">11. Adaptive mesh refinement</a></li><li><a href="../../../tutorials/12_nucleation.html">12. Crack nucleation</a></li><li><a href="../../../tutorials/13_traction_separation.html">13. Traction separation law</a></li><li><a href="../../../tutorials/14_klexpansion.html">14. Random field generation</a></li><li><a href="../../../tutorials/15_mosaic_patches.html">15. Mosaic field generation</a></li></ul><ul class="dropdown-content" id="faa162a0-c8ce-413f-9eb0-4e168470dc7c"><li><a href="../../../theory/intro.html">Introduction</a></li><li><a href="../../../theory/kinematics.html">State variables and kinematics</a></li><li><a href="../../../theory/thermodynamics.html">Thermodynamics</a></li><li><a href="../../../theory/minimization.html">The minimization problem</a></li><li><a href="../../../theory/constitutive_models.html">Constitutive Models</a></li></ul><ul class="dropdown-content" id="0304f2f0-ccb2-4e75-8f1c-0c4c8ea9dcd4"><li><a href="../../../modules/index.html">Physics modules</a></li><li><a href="../../../syntax/index.html">Complete syntax</a></li><li><a href="../../../syntax/raccoon.html">RACCOON syntax</a></li><li><a href="../../../syntax/solid_mechanics.html">Solid mechanics syntax</a></li><li><a href="../../../syntax/phase_field.html">Phase field syntax</a></li><li><a href="../../../syntax/heat_transfer.html">Heat conduction syntax</a></li></ul><ul class="dropdown-content" id="5f8cb9b7-0ce2-438f-bf31-fef41c949ff8"><li><a href="../../../getting_started/install.html">Install RACCOON</a></li><li><a href="../../../getting_started/update.html">Update RACCOON</a></li><li><a href="../../../getting_started/running.html">Running your first model</a></li><li><a href="../../../getting_started/paraview.html">Visualization</a></li><li><a href="../../../getting_started/ide.html">Code development</a></li><li><a href="../../../getting_started/docs.html">Browse the documentation locally</a></li></ul><ul class="dropdown-content" id="61f4365c-4ca6-4b0c-951b-9e59989b6d5f"><li><a href="../../../tutorials/01_small_deformation_elasticity.html">1. Small deformation</a></li><li><a href="../../../tutorials/02_mode1_brittle_fracture.html">2. Mode-I fracture</a></li><li><a href="../../../tutorials/03_mode2_brittle_fracture.html">3. Mode-II fracture</a></li><li><a href="../../../tutorials/04_fiber_reinforced_matrix.html">4. Fiber-reinforced matrix</a></li><li><a href="../../../tutorials/05_soil_desiccation.html">5. Soil desiccation</a></li><li><a href="../../../tutorials/06_large_deformation_elasticity.html">6. Large deformation</a></li><li><a href="../../../tutorials/07_elastoplasticity.html">7. Elastoplasticity</a></li><li><a href="../../../tutorials/08_ductile_fracture.html">8. Ductile fracture</a></li><li><a href="../../../tutorials/09_three_point_bending.html">9. Three-point bending</a></li><li><a href="../../../tutorials/10_quenching_bibeam.html">10. Quenching of bi-beam</a></li><li><a href="../../../tutorials/11_adaptivity.html">11. Adaptive mesh refinement</a></li><li><a href="../../../tutorials/12_nucleation.html">12. Crack nucleation</a></li><li><a href="../../../tutorials/13_traction_separation.html">13. Traction separation law</a></li><li><a href="../../../tutorials/14_klexpansion.html">14. Random field generation</a></li><li><a href="../../../tutorials/15_mosaic_patches.html">15. Mosaic field generation</a></li></ul><ul class="dropdown-content" id="fe60d65e-30e0-49f4-bf4d-051f631ed225"><li><a href="../../../theory/intro.html">Introduction</a></li><li><a href="../../../theory/kinematics.html">State variables and kinematics</a></li><li><a href="../../../theory/thermodynamics.html">Thermodynamics</a></li><li><a href="../../../theory/minimization.html">The minimization problem</a></li><li><a href="../../../theory/constitutive_models.html">Constitutive Models</a></li></ul><ul class="dropdown-content" id="481463d5-fdcc-4827-9173-b3cf65d739cc"><li><a href="../../../modules/index.html">Physics modules</a></li><li><a href="../../../syntax/index.html">Complete syntax</a></li><li><a href="../../../syntax/raccoon.html">RACCOON syntax</a></li><li><a href="../../../syntax/solid_mechanics.html">Solid mechanics syntax</a></li><li><a href="../../../syntax/phase_field.html">Phase field syntax</a></li><li><a href="../../../syntax/heat_transfer.html">Heat conduction syntax</a></li></ul></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="gcse-search"></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="moose-content col s12 m12 l12"><section id="fd9b5e3f-f89d-4483-9fcc-dff57fee1681" data-section-level="1" data-section-text="SmallDeformationIsotropicElasticity"><h1 id="smalldeformationisotropicelasticity">SmallDeformationIsotropicElasticity</h1><p>Isotropic elasticity under small strain asumptions.</p><section id="b84135ca-c44f-4f93-a241-14e3b9d808ba" data-section-level="2" data-section-text="Overview"><h2 id="overview">Overview</h2><p>The strain energy density is defined as</p><p><span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-64ec78c2-21fb-4205-b000-508f2753fbe6"></span><script>var element = document.getElementById("moose-equation-64ec78c2-21fb-4205-b000-508f2753fbe6");katex.render("  \\psi^e = \\dfrac{1}{2} K \\tr(\\strain)^2 + G \\dev(\\strain):\\dev(\\strain).", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\grad":"\\bs{\\nabla}","\\divergence":"\\grad \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\abs":"\\left\\lvert#1\\right\\rvert","\\tr":"\\text{tr}","\\dev":"\\text{dev}","\\sym":"\\text{sym}","\\diff":"\\text{ d}#1","\\activepart":"{\\left< A \\right>}","\\inactivepart":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\ep":"{\\varepsilon^p}","\\ep0":"{\\varepsilon_0^p}","\\epdot":"{\\dot{\\varepsilon}}^p","\\epdot0":"{\\dot{\\varepsilon}}_0^p","\\bfa":"\\boldsymbol{a}","\\bfb":"\\boldsymbol{b}","\\bfc":"\\boldsymbol{c}","\\bfd":"\\boldsymbol{d}","\\bfe":"\\boldsymbol{e}","\\bff":"\\boldsymbol{f}","\\bfg":"\\boldsymbol{g}","\\bfh":"\\boldsymbol{h}","\\bfi":"\\boldsymbol{i}","\\bfj":"\\boldsymbol{j}","\\bfk":"\\boldsymbol{k}","\\bfl":"\\boldsymbol{l}","\\bfm":"\\boldsymbol{m}","\\bfn":"\\boldsymbol{n}","\\bfo":"\\boldsymbol{o}","\\bfp":"\\boldsymbol{p}","\\bfq":"\\boldsymbol{q}","\\bfr":"\\boldsymbol{r}","\\bfs":"\\boldsymbol{s}","\\bft":"\\boldsymbol{t}","\\bfu":"\\boldsymbol{u}","\\bfv":"\\boldsymbol{v}","\\bfw":"\\boldsymbol{w}","\\bfx":"\\boldsymbol{x}","\\bfy":"\\boldsymbol{y}","\\bfz":"\\boldsymbol{z}","\\bfA":"\\boldsymbol{A}","\\bfB":"\\boldsymbol{B}","\\bfC":"\\boldsymbol{C}","\\bfD":"\\boldsymbol{D}","\\bfE":"\\boldsymbol{E}","\\bfF":"\\boldsymbol{F}","\\bfG":"\\boldsymbol{G}","\\bfH":"\\boldsymbol{H}","\\bfI":"\\boldsymbol{I}","\\bfJ":"\\boldsymbol{J}","\\bfK":"\\boldsymbol{K}","\\bfL":"\\boldsymbol{L}","\\bfM":"\\boldsymbol{M}","\\bfN":"\\boldsymbol{N}","\\bfO":"\\boldsymbol{O}","\\bfP":"\\boldsymbol{P}","\\bfQ":"\\boldsymbol{Q}","\\bfR":"\\boldsymbol{R}","\\bfS":"\\boldsymbol{S}","\\bfT":"\\boldsymbol{T}","\\bfU":"\\boldsymbol{U}","\\bfV":"\\boldsymbol{V}","\\bfW":"\\boldsymbol{W}","\\bfX":"\\boldsymbol{X}","\\bfY":"\\boldsymbol{Y}","\\bfZ":"\\boldsymbol{Z}"}});</script></span></p><p>This class features three most commonly used splits of the strain energy, i.e. no decomposition, spectral decomposition, and volumetric-deviatoric decomposition.</p></section><section id="ddacc155-19d7-429a-a00d-c84ed515fe35" data-section-level="2" data-section-text="Example Input File Syntax"><h2 id="example-input-file-syntax">Example Input File Syntax</h2></section><section id="8a2ef4f9-82fb-4219-8510-577794c8ba08" data-section-level="2" data-section-text="Input Parameters"><h2 id="input-parameters">Input Parameters</h2><section id="9f3f33cd-7de0-46f9-a2c2-55cf80cf4c5a" data-section-level="3" data-section-text="Required Parameters" data-details-open="open"><details class="moose-section-content" open="open"><ul class="collapsible" data-collapsible="expandable"><li><div class="collapsible-header"><span class="moose-parameter-name">bulk_modulus</span><span class="moose-parameter-header-description">The bulk modulus $K$</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>MaterialPropertyName</p><p class="moose-parameter-description-doc-unit"><span>Unit:</span>(no unit assumed)</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>The bulk modulus $K$</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">phase_field</span><span class="moose-parameter-header-description">Name of the phase-field (damage) variable</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector&lt;VariableName&gt;</p><p class="moose-parameter-description-doc-unit"><span>Unit:</span>(no unit assumed)</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>Name of the phase-field (damage) variable</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">shear_modulus</span><span class="moose-parameter-header-description">The shear modulus $G$</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>MaterialPropertyName</p><p class="moose-parameter-description-doc-unit"><span>Unit:</span>(no unit assumed)</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>The shear modulus $G$</p></div></li></ul><summary><h3 data-details-open="open"><span class="moose-section-icon"></span>Required Parameters</h3></summary></details></section><section id="8ec0da70-ddbf-4eae-bca9-9c70068db897" data-section-level="3" data-section-text="Optional Parameters" data-details-open="open"><details class="moose-section-content" open="open"><ul class="collapsible" data-collapsible="expandable"><li><div class="collapsible-header"><span class="moose-parameter-name">base_name</span><span class="moose-parameter-header-description">Optional parameter that allows the user to define multiple mechanics material systems on the same block, i.e. for multiple phases</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::string</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>Optional parameter that allows the user to define multiple mechanics material systems on the same block, i.e. for multiple phases</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">block</span><span class="moose-parameter-header-description">The list of blocks (ids or names) that this object will be applied</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector&lt;SubdomainName&gt;</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>The list of blocks (ids or names) that this object will be applied</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">boundary</span><span class="moose-parameter-header-description">The list of boundaries (ids or names) from the mesh where this object applies</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector&lt;BoundaryName&gt;</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>The list of boundaries (ids or names) from the mesh where this object applies</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">constant_on</span><span class="moose-parameter-header-default">NONE</span><span class="moose-parameter-header-description">When ELEMENT, MOOSE will only call computeQpProperties() for the 0th quadrature point, and then copy that value to the other qps.When SUBDOMAIN, MOOSE will only call computeQpProperties() for the 0th quadrature point, and then copy that value to the other qps. Evaluations on element qps will be skipped</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>NONE</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>MooseEnum</p><p class="moose-parameter-description-options"><span>Options:</span>NONE, ELEMENT, SUBDOMAIN</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>When ELEMENT, MOOSE will only call computeQpProperties() for the 0th quadrature point, and then copy that value to the other qps.When SUBDOMAIN, MOOSE will only call computeQpProperties() for the 0th quadrature point, and then copy that value to the other qps. Evaluations on element qps will be skipped</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">declare_suffix</span><span class="moose-parameter-header-description">An optional suffix parameter that can be appended to any declared properties. The suffix will be prepended with a '_' character.</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>MaterialPropertyName</p><p class="moose-parameter-description-doc-unit"><span>Unit:</span>(no unit assumed)</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>An optional suffix parameter that can be appended to any declared properties. The suffix will be prepended with a '_' character.</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">decomposition</span><span class="moose-parameter-header-default">NONE</span><span class="moose-parameter-header-description">The decomposition method</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>NONE</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>MooseEnum</p><p class="moose-parameter-description-options"><span>Options:</span>NONE, SPECTRAL, VOLDEV</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>The decomposition method</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">degradation_function</span><span class="moose-parameter-header-default">g</span><span class="moose-parameter-header-description">The degradation function</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>g</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>MaterialPropertyName</p><p class="moose-parameter-description-doc-unit"><span>Unit:</span>(no unit assumed)</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>The degradation function</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">strain_energy_density</span><span class="moose-parameter-header-default">psie</span><span class="moose-parameter-header-description">Name of the strain energy density computed by this material model</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>psie</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>MaterialPropertyName</p><p class="moose-parameter-description-doc-unit"><span>Unit:</span>(no unit assumed)</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>Name of the strain energy density computed by this material model</p></div></li></ul><summary><h3 data-details-open="open"><span class="moose-section-icon"></span>Optional Parameters</h3></summary></details></section><section id="ddce10c3-3e41-4d64-be16-2342c013584f" data-section-level="3" data-section-text="Advanced Parameters" data-details-open="close"><details class="moose-section-content"><ul class="collapsible" data-collapsible="expandable"><li><div class="collapsible-header"><span class="moose-parameter-name">control_tags</span><span class="moose-parameter-header-description">Adds user-defined labels for accessing object parameters via control logic.</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector&lt;std::string&gt;</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>Adds user-defined labels for accessing object parameters via control logic.</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">enable</span><span class="moose-parameter-header-default">True</span><span class="moose-parameter-header-description">Set the enabled status of the MooseObject.</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>True</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>Yes</p><p class="moose-parameter-description"><span>Description:</span>Set the enabled status of the MooseObject.</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">implicit</span><span class="moose-parameter-header-default">True</span><span class="moose-parameter-header-description">Determines whether this object is calculated using an implicit or explicit form</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>True</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>Determines whether this object is calculated using an implicit or explicit form</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">search_method</span><span class="moose-parameter-header-default">nearest_node_connected_sides</span><span class="moose-parameter-header-description">Choice of search algorithm.  All options begin by finding the nearest node in the primary boundary to a query point in the secondary boundary.  In the default nearest_node_connected_sides algorithm, primary boundary elements are searched iff that nearest node is one of their nodes.  This is fast to determine via a pregenerated node-to-elem map and is robust on conforming meshes.  In the optional all_proximate_sides algorithm, primary boundary elements are searched iff they touch that nearest node, even if they are not topologically connected to it.  This is more CPU-intensive but is necessary for robustness on any boundary surfaces which has disconnections (such as Flex IGA meshes) or non-conformity (such as hanging nodes in adaptively h-refined meshes).</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>nearest_node_connected_sides</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>MooseEnum</p><p class="moose-parameter-description-options"><span>Options:</span>nearest_node_connected_sides, all_proximate_sides</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>Choice of search algorithm.  All options begin by finding the nearest node in the primary boundary to a query point in the secondary boundary.  In the default nearest_node_connected_sides algorithm, primary boundary elements are searched iff that nearest node is one of their nodes.  This is fast to determine via a pregenerated node-to-elem map and is robust on conforming meshes.  In the optional all_proximate_sides algorithm, primary boundary elements are searched iff they touch that nearest node, even if they are not topologically connected to it.  This is more CPU-intensive but is necessary for robustness on any boundary surfaces which has disconnections (such as Flex IGA meshes) or non-conformity (such as hanging nodes in adaptively h-refined meshes).</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">seed</span><span class="moose-parameter-header-default">0</span><span class="moose-parameter-header-description">The seed for the master random number generator</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>0</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>unsigned int</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>The seed for the master random number generator</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">use_displaced_mesh</span><span class="moose-parameter-header-default">False</span><span class="moose-parameter-header-description">Whether or not this object should use the displaced mesh for computation.  Note that in the case this is true but no displacements are provided in the Mesh block the undisplaced mesh will still be used.</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>False</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>Whether or not this object should use the displaced mesh for computation.  Note that in the case this is true but no displacements are provided in the Mesh block the undisplaced mesh will still be used.</p></div></li></ul><summary><h3 data-details-open="close"><span class="moose-section-icon"></span>Advanced Parameters</h3></summary></details></section><section id="62f5d2c3-94dc-4570-b2c1-d364dd2e34c4" data-section-level="3" data-section-text="Outputs Parameters" data-details-open="close"><details class="moose-section-content"><ul class="collapsible" data-collapsible="expandable"><li><div class="collapsible-header"><span class="moose-parameter-name">output_properties</span><span class="moose-parameter-header-description">List of material properties, from this material, to output (outputs must also be defined to an output type)</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector&lt;std::string&gt;</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>List of material properties, from this material, to output (outputs must also be defined to an output type)</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">outputs</span><span class="moose-parameter-header-default">none </span><span class="moose-parameter-header-description">Vector of output names where you would like to restrict the output of variables(s) associated with this object</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>none </p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector&lt;OutputName&gt;</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>Vector of output names where you would like to restrict the output of variables(s) associated with this object</p></div></li></ul><summary><h3 data-details-open="close"><span class="moose-section-icon"></span>Outputs Parameters</h3></summary></details></section><section id="b2ecf9de-b422-4e0b-a409-53ff7a0daa88" data-section-level="3" data-section-text="Material Property Retrieval Parameters" data-details-open="close"><details class="moose-section-content"><ul class="collapsible" data-collapsible="expandable"><li><div class="collapsible-header"><span class="moose-parameter-name">prop_getter_suffix</span><span class="moose-parameter-header-description">An optional suffix parameter that can be appended to any attempt to retrieve/get material properties. The suffix will be prepended with a '_' character.</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>MaterialPropertyName</p><p class="moose-parameter-description-doc-unit"><span>Unit:</span>(no unit assumed)</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>An optional suffix parameter that can be appended to any attempt to retrieve/get material properties. The suffix will be prepended with a '_' character.</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">use_interpolated_state</span><span class="moose-parameter-header-default">False</span><span class="moose-parameter-header-description">For the old and older state use projected material properties interpolated at the quadrature points. To set up projection use the ProjectedStatefulMaterialStorageAction.</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>False</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>For the old and older state use projected material properties interpolated at the quadrature points. To set up projection use the ProjectedStatefulMaterialStorageAction.</p></div></li></ul><summary><h3 data-details-open="close"><span class="moose-section-icon"></span>Material Property Retrieval Parameters</h3></summary></details></section></section><section id="bd674013-e26b-40fe-8cb7-d95f99c20215" data-section-level="2" data-section-text="Input Files"><h2 id="input-files">Input Files</h2><ul class="moose-list-inputs browser-default"><li><a class="moose-source-filename tooltipped modal-trigger" href="#0cf16abf-5456-4095-bf1a-6155d709f70b">(test/tests/nucleation_models/klbf.i)</a></li><li><a class="moose-source-filename tooltipped modal-trigger" href="#1817a37a-33c3-4a6c-b395-1c41ace6ca6d">(tutorials/soil_desiccation/elasticity.i)</a></li><li><a class="moose-source-filename tooltipped modal-trigger" href="#86c8ada4-f9f2-43bc-8a02-48fac22c0545">(tutorials/surfing_boundary_problem/elasticity.i)</a></li><li><a class="moose-source-filename tooltipped modal-trigger" href="#b54cc5df-90c0-430a-85ed-e4226454ef29">(tutorials/mode1_cohesive_fracture/elasticity.i)</a></li><li><a class="moose-source-filename tooltipped modal-trigger" href="#9a9aeb61-2153-495c-8dc9-9a51cb3797d6">(tutorials/quenching_bibeam/thermoelasticity.i)</a></li><li><a class="moose-source-filename tooltipped modal-trigger" href="#6aebaffa-d5d6-4f29-b360-c04c71f5e839">(tutorials/mode1_brittle_fracture/elasticity.i)</a></li><li><a class="moose-source-filename tooltipped modal-trigger" href="#f8c757bb-00a1-4269-8253-326b24cd53db">(tutorials/traction_separation/elasticity.i)</a></li><li><a class="moose-source-filename tooltipped modal-trigger" href="#e5bc5474-f144-4de7-9ebc-6f982eba7c93">(tutorials/adaptivity/elasticity.i)</a></li><li><a class="moose-source-filename tooltipped modal-trigger" href="#58888dfe-490e-40c3-ac0f-9a349989419f">(tutorials/mode2_cohesive_fracture/elasticity.i)</a></li><li><a class="moose-source-filename tooltipped modal-trigger" href="#28346a40-06b7-474f-8ce5-7629c7791f5e">(tutorials/mode1_ductile_fracture/elastoplasticity.i)</a></li><li><a class="moose-source-filename tooltipped modal-trigger" href="#87ac4d22-3e68-469a-94f7-a44da3fe3caa">(test/tests/nucleation_models/ldl.i)</a></li><li><a class="moose-source-filename tooltipped modal-trigger" href="#a096efba-d489-4f5d-a1e5-512f0b295a7a">(test/tests/nucleation_models/elasticity.i)</a></li><li><a class="moose-source-filename tooltipped modal-trigger" href="#576f4628-ccae-4937-8e17-72b911a2a01b">(tutorials/mode2_brittle_fracture/elasticity.i)</a></li><li><a class="moose-source-filename tooltipped modal-trigger" href="#f20f842a-febe-4bbe-a88a-cd7e02180355">(test/tests/nucleation_models/klr.i)</a></li><li><a class="moose-source-filename tooltipped modal-trigger" href="#5816aa43-dce5-4a1b-814a-b318fedaf698">(tutorials/small_deformation/elastoplasticity.i)</a></li><li><a class="moose-source-filename tooltipped modal-trigger" href="#3aeffdbf-717a-4712-9302-0dd7160b66c3">(tutorials/small_deformation/elasticity.i)</a></li><li><a class="moose-source-filename tooltipped modal-trigger" href="#a8d8347e-1326-4682-b98a-71a2b6e15854">(tutorials/matrix_fiber/elasticity.i)</a></li><li><a class="moose-source-filename tooltipped modal-trigger" href="#1647b738-bc7a-466f-99b3-91476564fe2a">(tutorials/surfing_boundary_problem/fracture.i)</a></li></ul></section></section><div class="moose-modal modal" id="0cf16abf-5456-4095-bf1a-6155d709f70b"><div class="modal-content"><h4>(test/tests/nucleation_models/klbf.i)</h4><pre style="max-height:350px;"><code class="language-moose">[Mesh]
  [gen]
    type = GeneratedMeshGenerator
    dim = 2
    nx = ${nx}
    ny = ${ny}
    xmax = 30
    ymin = -5
    ymax = 5
  []
[]

[Adaptivity]
  marker = marker
  initial_marker = marker
  initial_steps = ${refine}
  stop_time = 0
  max_h_level = ${refine}
  [Markers]
    [marker]
      type = BoxMarker
      bottom_left = &#x27;0 -0.7 0&#x27;
      top_right = &#x27;30 0.7 0&#x27;
      outside = DO_NOTHING
      inside = REFINE
    []
  []
[]

[Variables]
  [d]
    [InitialCondition]
      type = FunctionIC
      function = &#x27;if(y=0&amp;x&gt;=0&amp;x&lt;=5,1,0)&#x27;
    []
  []
[]

[AuxVariables]
  [bounds_dummy]
  []
  [disp_x]
  []
  [disp_y]
  []
  [strain_zz]
  []
  [psie_active]
    order = CONSTANT
    family = MONOMIAL
  []
  [ce]
    order = CONSTANT
    family = MONOMIAL
  []
[]

[Bounds]
  [conditional]
    type = ConditionalBoundsAux
    variable = bounds_dummy
    bounded_variable = d
    fixed_bound_value = 0
    threshold_value = 0.95
  []
  [upper]
    type = ConstantBounds
    variable = bounds_dummy
    bounded_variable = d
    bound_type = upper
    bound_value = 1
  []
[]

[Kernels]
  [diff]
    type = ADPFFDiffusion
    variable = d
    fracture_toughness = Gc
    regularization_length = l
    normalization_constant = c0
  []
  [source]
    type = ADPFFSource
    variable = d
    free_energy = psi
  []
  [nuc_force]
    type = ADCoefMatSource
    variable = d
    prop_names = &#x27;ce&#x27;
  []
[]

[AuxKernels]
  [get_ce]
    type = ADMaterialRealAux
    variable = ce
    property = ce
  []
[]

[Materials]
  [fracture_properties]
    type = ADGenericConstantMaterial
    prop_names = &#x27;E K G lambda Gc l sigma_ts sigma_cs delta&#x27;
    prop_values = &#x27;${E} ${K} ${G} ${Lambda} ${Gc} ${l} ${sigma_ts} ${sigma_cs} ${delta}&#x27;
  []
  [degradation]
    type = PowerDegradationFunction
    property_name = g
    expression = (1-d)^p*(1-eta)+eta
    phase_field = d
    parameter_names = &#x27;p eta &#x27;
    parameter_values = &#x27;2 0&#x27;
  []
  [crack_geometric]
    type = CrackGeometricFunction
    property_name = alpha
    expression = &#x27;d&#x27;
    phase_field = d
  []
  [psi]
    type = ADDerivativeParsedMaterial
    property_name = psi
    expression = &#x27;g*psie_active+(Gc/c0/l)*alpha&#x27;
    coupled_variables = &#x27;d psie_active&#x27;
    material_property_names = &#x27;alpha(d) g(d) Gc c0 l&#x27;
    derivative_order = 1
  []
  [kumar_material]
    type = KLBFNucleationMicroForce
    phase_field = d
    normalization_constant = c0
    tensile_strength = sigma_ts
    compressive_strength = sigma_cs
    delta = delta
    external_driving_force_name = ce
  []
  [strain]
    type = ADComputePlaneSmallStrain
    out_of_plane_strain = &#x27;strain_zz&#x27;
    displacements = &#x27;disp_x disp_y&#x27;
  []
  [elasticity]
    type = SmallDeformationIsotropicElasticity
    bulk_modulus = K
    shear_modulus = G
    phase_field = d
    degradation_function = g
    decomposition = NONE
  []
  [stress]
    type = ComputeSmallDeformationStress
    elasticity_model = elasticity
  []
[]

[Executioner]
  type = Transient

  solve_type = NEWTON
  petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package -snes_type&#x27;
  petsc_options_value = &#x27;lu       superlu_dist                  vinewtonrsls&#x27;
  automatic_scaling = true

  nl_rel_tol = 1e-8
  nl_abs_tol = 1e-10
[]

[Outputs]
  print_linear_residuals = false
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="1817a37a-33c3-4a6c-b395-1c41ace6ca6d"><div class="modal-content"><h4>(tutorials/soil_desiccation/elasticity.i)</h4><pre style="max-height:350px;"><code class="language-moose">E = 4
nu = 0.2
K = &#x27;${fparse E/3/(1-2*nu)}&#x27;
G = &#x27;${fparse E/2/(1+nu)}&#x27;

l = 0.5
c = 0.1

[GlobalParams]
  displacements = &#x27;disp_x disp_y&#x27;
[]

[MultiApps]
  [fracture]
    type = TransientMultiApp
    input_files = &#x27;fracture.i&#x27;
    cli_args = &#x27;l=${l}&#x27;
  []
[]

[Transfers]
  [send_psie_active]
    type = MultiAppGeneralFieldShapeEvaluationTransfer
    to_multi_app = fracture
    source_variable = psie_active
    variable = psie_active
  []
  [send_psii_active]
    type = MultiAppGeneralFieldShapeEvaluationTransfer
    to_multi_app = fracture
    source_variable = psii_active
    variable = psii_active
  []
  [get_d]
    type = MultiAppGeneralFieldShapeEvaluationTransfer
    from_multi_app = fracture
    source_variable = d
    variable = d
  []
[]

[Mesh]
  [fmg]
    type = FileMeshGenerator
    file = &#x27;gold/fields_refined.e&#x27;
    use_for_exodus_restart = true
  []
[]

[Variables]
  [disp_x]
  []
  [disp_y]
  []
  [strain_zz]
  []
[]

[AuxVariables]
  [d]
  []
  [Gc]
    initial_from_file_var = Gc
  []
  [psic]
    initial_from_file_var = psic
  []
[]

[Kernels]
  [solid_x]
    type = ADStressDivergenceTensors
    variable = disp_x
    component = 0
  []
  [solid_y]
    type = ADStressDivergenceTensors
    variable = disp_y
    component = 1
  []
  [plane_stress]
    type = ADWeakPlaneStress
    variable = strain_zz
  []
  [react_x]
    type = ADCoefMatReaction
    variable = disp_x
    coefficient = ${c}
    prop_names = &#x27;g&#x27;
  []
  [react_y]
    type = ADCoefMatReaction
    variable = disp_y
    coefficient = ${c}
    prop_names = &#x27;g&#x27;
  []
[]

[BCs]
  [Periodic]
    [x]
      variable = disp_x
      auto_direction = &#x27;x y&#x27;
    []
    [y]
      variable = disp_y
      auto_direction = &#x27;x y&#x27;
    []
  []
[]

[Materials]
  # fracture
  [fracture_toughness]
    type = ADParsedMaterial
    property_name = Gc
    coupled_variables = Gc
    expression = &#x27;Gc&#x27;
  []
  [critial_fracture_energy]
    type = ADParsedMaterial
    property_name = psic
    coupled_variables = psic
    expression = &#x27;psic&#x27;
  []
  [bulk_properties]
    type = ADGenericConstantMaterial
    prop_names = &#x27;K G l&#x27;
    prop_values = &#x27;${K} ${G} ${l}&#x27;
  []
  [crack_geometric]
    type = CrackGeometricFunction
    property_name = alpha
    expression = &#x27;d&#x27;
    phase_field = d
  []
  [degradation]
    type = RationalDegradationFunction
    property_name = g
    expression = (1-d)^p/((1-d)^p+(Gc/psic*xi/c0/l)*d*(1+a2*d+a2*a3*d^2))*(1-eta)+eta
    phase_field = d
    parameter_names = &#x27;p a2 a3 eta &#x27;
    parameter_values = &#x27;2 1 0 1e-6&#x27;
    material_property_names = &#x27;Gc psic xi c0 l &#x27;
  []
  # elasticity
  [eigen_strain]
    type = ComputeEigenstrainFromFunctionInitialStress
    initial_stress = &#x27;t t 0&#x27;
    eigenstrain_name = &#x27;es&#x27;
    bulk_modulus = K
    shear_modulus = G
  []
  [strain]
    type = ADComputePlaneSmallStrain
    out_of_plane_strain = strain_zz
    eigenstrain_names = &#x27;es&#x27;
  []
  [elasticity]
    type = SmallDeformationIsotropicElasticity
    bulk_modulus = K
    shear_modulus = G
    phase_field = d
    degradation_function = g
    decomposition = NONE
    output_properties = &#x27;psie_active&#x27;
    outputs = exodus
  []
  [stress]
    type = ComputeSmallDeformationStress
    elasticity_model = elasticity
  []
  [interfacial_energy]
    type = ThinFilmInterfaceEnergyDensity
    phase_field = d
    shear_lag_coef = ${c}
    output_properties = &#x27;psii_active&#x27;
    outputs = exodus
  []
[]

[Postprocessors]
  [delta_d]
    type = SolutionChangeNorm
    variable = d
    outputs = none
  []
[]

[Executioner]
  type = Transient
  solve_type = &#x27;NEWTON&#x27;
  petsc_options = &#x27;-ksp_converged_reason&#x27;
  petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package -ksp_type&#x27;
  petsc_options_value = &#x27;lu       superlu_dist                  gmres&#x27;
  dt = 0.0005
  end_time = 0.22

  nl_rel_tol = 1e-06
  nl_abs_tol = 1e-08

  automatic_scaling = true

  fixed_point_max_its = 10
  custom_pp = delta_d
  custom_abs_tol = 1e-03
  custom_rel_tol = 1e-03
  disable_fixed_point_residual_norm_check = true
  accept_on_max_fixed_point_iteration = true

  reuse_preconditioner = true
  reuse_preconditioner_max_linear_its = 50
[]

[Outputs]
  print_linear_residuals = false
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="86c8ada4-f9f2-43bc-8a02-48fac22c0545"><div class="modal-content"><h4>(tutorials/surfing_boundary_problem/elasticity.i)</h4><pre style="max-height:350px;"><code class="language-moose"># This  tutorial is based on example of material graphite in section 4.3.4
# See Kumar et. al. https://doi.org/10.1016/j.jmps.2020.104027.
# For regularization length 0.35mm, delta 1.16, mesh size 0.035,
# J intergal over Gc should return a value close to 1
# delta value 0.2 is updated for model 2022
# (see Kumar et. al. https://doi.org/10.1007/s10704-022-00653-z)

E = 9.8e3 #9.8Gpa
nu = 0.13
K = &#x27;${fparse E/3/(1-2*nu)}&#x27;
G = &#x27;${fparse E/2/(1+nu)}&#x27;
Lambda = &#x27;${fparse E*nu/(1+nu)/(1-2*nu)}&#x27;

Gc = 9.1e-2 # 91N/m
l = 0.35
sigma_ts = 27
sigma_cs = 77
sigma_hs = &#x27;${fparse 2/3*sigma_ts*sigma_cs/(sigma_cs - sigma_ts)}&#x27;

c1 = &#x27;${fparse (1+nu)*sqrt(Gc)/sqrt(2*pi*E)}&#x27;
c2 = &#x27;${fparse (3-nu)/(1+nu)}&#x27;
ahead = 2
V = 20
# mesh size 0.035
nx = 108
ny = 36
refine = 3
initd = 1 # initial crack phase field value
filename = elasticity_out

[Functions]
  [bc_func]
    type = ParsedFunction
    expression = c1*((x-V*t-ahead)^2+y^2)^(0.25)*(c2-cos(atan2(y,(x-V*t-ahead))))*sin(0.5*atan2(y,(x-V*t-ahead)))
    symbol_names = &#x27;c1 c2 V ahead&#x27;
    symbol_values = &#x27;${c1} ${c2} ${V} ${ahead}&#x27;
  []
[]

[MultiApps]
  [fracture]
    type = TransientMultiApp
    input_files = fracture.i
    cli_args = &#x27;E=${E};K=${K};G=${G};Lambda=${Lambda};Gc=${Gc};l=${l};nx=${nx};ny=${ny};refine=${refine};sigma_ts=${sigma_ts};sigma_hs=${sigma_hs};&#x27;
    &#x27;initd=${initd}&#x27;
    execute_on = &#x27;TIMESTEP_END&#x27;
  []
[]

[Transfers]
  [from_d]
    type = MultiAppCopyTransfer
    from_multi_app = fracture
    variable = &#x27;d&#x27;
    source_variable = &#x27;d&#x27;
  []
  [to_psie_active]
    type = MultiAppCopyTransfer
    to_multi_app = fracture
    variable = &#x27;disp_x disp_y strain_zz psie_active&#x27;
    source_variable = &#x27;disp_x disp_y strain_zz psie_active&#x27;
  []
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y&#x27;
[]

[Mesh]
  [gen]
    type = GeneratedMeshGenerator
    dim = 2
    nx = ${nx}
    ny = ${ny}
    xmax = 30
    ymin = -5
    ymax = 5
  []
  [gen2]
    type = ExtraNodesetGenerator
    input = gen
    new_boundary = fix_point
    coord = &#x27;0 -5&#x27;
  []
[]

[Adaptivity]
  marker = marker
  initial_marker = marker
  initial_steps = ${refine}
  stop_time = 0
  max_h_level = ${refine}
  [Markers]
    [marker]
      type = BoxMarker
      bottom_left = &#x27;0 -0.7 0&#x27;
      top_right = &#x27;30 0.7 0&#x27;
      outside = DO_NOTHING
      inside = REFINE
    []
  []
[]

[Variables]
  [disp_x]
  []
  [disp_y]
  []
  [strain_zz]
  []
[]

[AuxVariables]
  [d]
    [InitialCondition]
      type = FunctionIC
      function = &#x27;if(y=0&amp;x&gt;=0&amp;x&lt;=5,${initd},0)&#x27;
    []
  []
[]

[Kernels]
  [solid_x]
    type = ADStressDivergenceTensors
    variable = disp_x
    component = 0
  []
  [solid_y]
    type = ADStressDivergenceTensors
    variable = disp_y
    component = 1
  []
  [plane_stress]
    type = ADWeakPlaneStress
    variable = &#x27;strain_zz&#x27;
    displacements = &#x27;disp_x disp_y&#x27;
  []
[]

[BCs]
  [fix_x]
    type = DirichletBC
    variable = disp_x
    boundary = fix_point
    value = 0
  []
  [bottom_y]
    type = FunctionDirichletBC
    variable = disp_y
    boundary = bottom
    function = bc_func
  []
  [top_y]
    type = FunctionDirichletBC
    variable = disp_y
    boundary = top
    function = bc_func
  []
[]

[Materials]
  [bulk]
    type = ADGenericConstantMaterial
    prop_names = &#x27;E K G lambda Gc l&#x27;
    prop_values = &#x27;${E} ${K} ${G} ${Lambda} ${Gc} ${l}&#x27;
  []
  [degradation]
    type = PowerDegradationFunction
    property_name = g
    expression = (1-d)^p*(1-eta)+eta
    phase_field = d
    parameter_names = &#x27;p eta &#x27;
    parameter_values = &#x27;2 0&#x27;
  []
  [strain]
    type = ADComputePlaneSmallStrain
    out_of_plane_strain = &#x27;strain_zz&#x27;
    displacements = &#x27;disp_x disp_y&#x27;
  []
  [elasticity]
    type = SmallDeformationIsotropicElasticity
    bulk_modulus = K
    shear_modulus = G
    phase_field = d
    degradation_function = g
    decomposition = NONE
    output_properties = &#x27;psie_active psie&#x27;
    outputs = exodus
  []
  [stress]
    type = ComputeSmallDeformationStress
    elasticity_model = elasticity
  []
[]

[Postprocessors]
  [Jint]
    type = PhaseFieldJIntegral
    J_direction = &#x27;1 0 0&#x27;
    strain_energy_density = psie
    displacements = &#x27;disp_x disp_y&#x27;
    boundary = &#x27;left top right bottom&#x27;
  []
  [Jint_over_Gc]
    type = ParsedPostprocessor
    pp_names = &#x27;Jint&#x27;
    expression = &#x27;Jint/${Gc}&#x27;
  []
[]

[Executioner]
  type = Transient

  solve_type = NEWTON
  petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
  petsc_options_value = &#x27;lu       superlu_dist                 &#x27;
  automatic_scaling = true

  nl_rel_tol = 1e-8
  nl_abs_tol = 1e-10

  dt = 1e-2
  dtmin = 1e-2
  end_time = 0.3

  fixed_point_max_its = 500
  accept_on_max_fixed_point_iteration = false
  fixed_point_rel_tol = 1e-6
  fixed_point_abs_tol = 1e-8
[]

[Outputs]
  exodus = true
  file_base = ${filename}
  print_linear_residuals = false
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="b54cc5df-90c0-430a-85ed-e4226454ef29"><div class="modal-content"><h4>(tutorials/mode1_cohesive_fracture/elasticity.i)</h4><pre style="max-height:350px;"><code class="language-moose">E = 2.1e5
nu = 0.3
K = &#x27;${fparse E/3/(1-2*nu)}&#x27;
G = &#x27;${fparse E/2/(1+nu)}&#x27;

Gc = 2.7
psic = 14.88
l = 0.02

[MultiApps]
  [fracture]
    type = TransientMultiApp
    input_files = fracture.i
    cli_args = &#x27;Gc=${Gc};psic=${psic};l=${l}&#x27;
    execute_on = &#x27;TIMESTEP_END&#x27;
  []
[]

[Transfers]
  [from_d]
    type = MultiAppCopyTransfer
    from_multi_app = &#x27;fracture&#x27;
    variable = d
    source_variable = d
  []
  [to_psie_active]
    type = MultiAppCopyTransfer
    to_multi_app = &#x27;fracture&#x27;
    variable = psie_active
    source_variable = psie_active
  []
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y&#x27;
[]

[Mesh]
  [gen]
    type = GeneratedMeshGenerator
    dim = 2
    nx = 30
    ny = 15
    ymax = 0.5
  []
  [noncrack]
    type = BoundingBoxNodeSetGenerator
    input = gen
    new_boundary = noncrack
    bottom_left = &#x27;0.5 0 0&#x27;
    top_right = &#x27;1 0 0&#x27;
  []
  construct_side_list_from_node_list = true
[]

[Adaptivity]
  marker = marker
  initial_marker = marker
  initial_steps = 2
  stop_time = 0
  max_h_level = 2
  [Markers]
    [marker]
      type = BoxMarker
      bottom_left = &#x27;0.4 0 0&#x27;
      top_right = &#x27;1 0.05 0&#x27;
      outside = DO_NOTHING
      inside = REFINE
    []
  []
[]

[Variables]
  [disp_x]
  []
  [disp_y]
  []
[]

[AuxVariables]
  [fy]
  []
  [d]
  []
[]

[Kernels]
  [solid_x]
    type = ADStressDivergenceTensors
    variable = disp_x
    component = 0
  []
  [solid_y]
    type = ADStressDivergenceTensors
    variable = disp_y
    component = 1
    save_in = fy
  []
[]

[BCs]
  [ydisp]
    type = FunctionDirichletBC
    variable = disp_y
    boundary = top
    function = &#x27;t&#x27;
  []
  [yfix]
    type = DirichletBC
    variable = disp_y
    boundary = noncrack
    value = 0
  []
  [xfix]
    type = DirichletBC
    variable = disp_x
    boundary = top
    value = 0
  []
[]

[Materials]
  [bulk_properties]
    type = ADGenericConstantMaterial
    prop_names = &#x27;K G l Gc psic&#x27;
    prop_values = &#x27;${K} ${G} ${l} ${Gc} ${psic}&#x27;
  []
  [crack_geometric]
    type = CrackGeometricFunction
    property_name = alpha
    expression = &#x27;d&#x27;
    phase_field = d
  []
  [degradation]
    type = RationalDegradationFunction
    property_name = g
    expression = (1-d)^p/((1-d)^p+(Gc/psic*xi/c0/l)*d*(1+a2*d+a2*a3*d^2))*(1-eta)+eta
    phase_field = d
    material_property_names = &#x27;Gc psic xi c0 l &#x27;
    parameter_names = &#x27;p a2 a3 eta &#x27;
    parameter_values = &#x27;2 -0.5 0 1e-6&#x27;
  []
  [strain]
    type = ADComputeSmallStrain
  []
  [elasticity]
    type = SmallDeformationIsotropicElasticity
    bulk_modulus = K
    shear_modulus = G
    phase_field = d
    degradation_function = g
    decomposition = NONE
    output_properties = &#x27;elastic_strain psie_active&#x27;
    outputs = exodus
  []
  [stress]
    type = ComputeSmallDeformationStress
    elasticity_model = elasticity
    output_properties = &#x27;stress&#x27;
    outputs = exodus
  []
[]

[Postprocessors]
  [Fy]
    type = NodalSum
    variable = fy
    boundary = top
  []
[]

[Executioner]
  type = Transient

  solve_type = NEWTON
  petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
  petsc_options_value = &#x27;lu       superlu_dist                 &#x27;
  automatic_scaling = true

  nl_rel_tol = 1e-8
  nl_abs_tol = 1e-10

  dt = 2e-5
  end_time = 3.5e-3

  fixed_point_max_its = 20
  accept_on_max_fixed_point_iteration = true
  fixed_point_rel_tol = 1e-8
  fixed_point_abs_tol = 1e-10
[]

[Outputs]
  exodus = true
  print_linear_residuals = false
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="9a9aeb61-2153-495c-8dc9-9a51cb3797d6"><div class="modal-content"><h4>(tutorials/quenching_bibeam/thermoelasticity.i)</h4><pre style="max-height:350px;"><code class="language-moose">E_glass = 6.4e4
nu_glass = 0.2
K_glass = &#x27;${fparse E_glass/3/(1-2*nu_glass)}&#x27;
G_glass = &#x27;${fparse E_glass/2/(1+nu_glass)}&#x27;
alpha_glass = 3.25e-6

E_steel = 1.93e5
nu_steel = 0.29
K_steel = &#x27;${fparse E_steel/3/(1-2*nu_steel)}&#x27;
G_steel = &#x27;${fparse E_steel/2/(1+nu_steel)}&#x27;
alpha_steel = 1.73e-5

Gc = 0.4
psic = 0.05
l = 1

[MultiApps]
  [fracture]
    type = TransientMultiApp
    input_files = fracture.i
    cli_args = &#x27;Gc=${Gc};psic=${psic};l=${l}&#x27;
    execute_on = &#x27;TIMESTEP_END&#x27;
  []
[]

[Transfers]
  [from_d]
    type = MultiAppGeneralFieldShapeEvaluationTransfer
    from_multi_app = &#x27;fracture&#x27;
    variable = d
    source_variable = d
  []
  [to_psie_active]
    type = MultiAppGeneralFieldShapeEvaluationTransfer
    to_multi_app = &#x27;fracture&#x27;
    variable = psie_active
    source_variable = psie_active
  []
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y&#x27;
[]

[Mesh]
  [fmg]
    type = FileMeshGenerator
    file = &#x27;gold/plate.msh&#x27;
  []
[]

[Adaptivity]
  marker = marker
  initial_marker = marker
  initial_steps = 2
  stop_time = 0
  max_h_level = 2
  [Markers]
    [marker]
      type = BoxMarker
      bottom_left = &#x27;27 7 0&#x27;
      top_right = &#x27;60 28 0&#x27;
      inside = REFINE
      outside = DO_NOTHING
    []
  []
[]

[Variables]
  [disp_x]
  []
  [disp_y]
  []
[]

[AuxVariables]
  [d]
  []
  [T]
    initial_condition = 1000
  []
  [psie_active]
    order = CONSTANT
    family = MONOMIAL
    block = glass
  []
[]

[AuxKernels]
  [cooling]
    type = FunctionAux
    variable = T
    function = &#x27;1000-t&#x27;
  []
  [psie_active]
    type = ADMaterialRealAux
    variable = psie_active
    property = psie_active
    block = glass
  []
[]

[Kernels]
  [solid_x]
    type = ADStressDivergenceTensors
    variable = disp_x
    component = 0
  []
  [solid_y]
    type = ADStressDivergenceTensors
    variable = disp_y
    component = 1
  []
[]

[BCs]
  [xdisp]
    type = DirichletBC
    variable = &#x27;disp_x&#x27;
    boundary = &#x27;left&#x27;
    value = 0
  []
  [yfix]
    type = DirichletBC
    variable = &#x27;disp_y&#x27;
    boundary = &#x27;left right&#x27;
    value = 0
  []
[]

[Materials]
  # Glass
  [bulk_properties_glass]
    type = ADGenericConstantMaterial
    prop_names = &#x27;K G l Gc psic&#x27;
    prop_values = &#x27;${K_glass} ${G_glass} ${l} ${Gc} ${psic}&#x27;
    block = glass
  []
  [crack_geometric]
    type = CrackGeometricFunction
    property_name = alpha
    expression = &#x27;d&#x27;
    phase_field = d
    block = glass
  []
  [degradation]
    type = RationalDegradationFunction
    property_name = g
    expression = (1-d)^p/((1-d)^p+(Gc/psic*xi/c0/l)*d*(1+a2*d+a2*a3*d^2))*(1-eta)+eta
    phase_field = d
    material_property_names = &#x27;Gc psic xi c0 l &#x27;
    parameter_names = &#x27;p a2 a3 eta &#x27;
    parameter_values = &#x27;2 -0.5 0 1e-6&#x27;
    block = glass
  []
  [eigenstrain_glass]
    type = ADComputeThermalExpansionEigenstrain
    eigenstrain_name = thermal_eigenstrain
    stress_free_temperature = 1000
    thermal_expansion_coeff = ${alpha_glass}
    temperature = T
    block = glass
  []
  [strain_glass]
    type = ADComputeSmallStrain
    eigenstrain_names = thermal_eigenstrain
    block = glass
  []
  [elasticity_glass]
    type = SmallDeformationIsotropicElasticity
    bulk_modulus = K
    shear_modulus = G
    phase_field = d
    degradation_function = g
    decomposition = SPECTRAL
    block = glass
  []
  [stress_glass]
    type = ComputeSmallDeformationStress
    elasticity_model = elasticity_glass
    block = glass
  []

  # Steel
  [eigenstrain_steel]
    type = ADComputeThermalExpansionEigenstrain
    eigenstrain_name = thermal_eigenstrain
    stress_free_temperature = 1000
    thermal_expansion_coeff = ${alpha_steel}
    temperature = T
    block = steel
  []
  [strain_steel]
    type = ADComputeSmallStrain
    eigenstrain_names = thermal_eigenstrain
    block = steel
  []
  [elasticity_steel]
    type = ADComputeIsotropicElasticityTensor
    shear_modulus = ${G_steel}
    bulk_modulus = ${K_steel}
  []
  [stress_steel]
    type = ADComputeLinearElasticStress
    block = steel
  []
[]

[Executioner]
  type = Transient

  solve_type = NEWTON
  petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
  petsc_options_value = &#x27;lu       superlu_dist                 &#x27;
  automatic_scaling = true

  nl_rel_tol = 1e-08
  nl_abs_tol = 1e-10

  dt = 0.5
  end_time = 200

  fixed_point_algorithm = picard
  fixed_point_max_its = 20
  fixed_point_rel_tol = 1e-08
  fixed_point_abs_tol = 1e-10
  accept_on_max_fixed_point_iteration = true
[]

[Outputs]
  exodus = true
  print_linear_residuals = false
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="6aebaffa-d5d6-4f29-b360-c04c71f5e839"><div class="modal-content"><h4>(tutorials/mode1_brittle_fracture/elasticity.i)</h4><pre style="max-height:350px;"><code class="language-moose">E = 2.1e5
nu = 0.3
K = &#x27;${fparse E/3/(1-2*nu)}&#x27;
G = &#x27;${fparse E/2/(1+nu)}&#x27;

Gc = 2.7
l = 0.02

[MultiApps]
  [fracture]
    type = TransientMultiApp
    input_files = fracture.i
    cli_args = &#x27;Gc=${Gc};l=${l}&#x27;
    execute_on = &#x27;TIMESTEP_END&#x27;
  []
[]

[Transfers]
  [from_d]
    type = MultiAppCopyTransfer
    from_multi_app = &#x27;fracture&#x27;
    variable = d
    source_variable = d
  []
  [to_psie_active]
    type = MultiAppCopyTransfer
    to_multi_app = &#x27;fracture&#x27;
    variable = psie_active
    source_variable = psie_active
  []
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y&#x27;
[]

[Mesh]
  [gen]
    type = GeneratedMeshGenerator
    dim = 2
    nx = 30
    ny = 15
    ymax = 0.5
  []
  [noncrack]
    type = BoundingBoxNodeSetGenerator
    input = gen
    new_boundary = noncrack
    bottom_left = &#x27;0.5 0 0&#x27;
    top_right = &#x27;1 0 0&#x27;
  []
  construct_side_list_from_node_list = true
[]

[Adaptivity]
  marker = marker
  initial_marker = marker
  initial_steps = 2
  stop_time = 0
  max_h_level = 2
  [Markers]
    [marker]
      type = BoxMarker
      bottom_left = &#x27;0.4 0 0&#x27;
      top_right = &#x27;1 0.05 0&#x27;
      outside = DO_NOTHING
      inside = REFINE
    []
  []
[]

[Variables]
  [disp_x]
  []
  [disp_y]
  []
[]

[AuxVariables]
  [fy]
  []
  [d]
  []
[]

[Kernels]
  [solid_x]
    type = ADStressDivergenceTensors
    variable = disp_x
    component = 0
  []
  [solid_y]
    type = ADStressDivergenceTensors
    variable = disp_y
    component = 1
    save_in = fy
  []
[]

[BCs]
  [ydisp]
    type = FunctionDirichletBC
    variable = disp_y
    boundary = top
    function = &#x27;t&#x27;
  []
  [yfix]
    type = DirichletBC
    variable = disp_y
    boundary = noncrack
    value = 0
  []
  [xfix]
    type = DirichletBC
    variable = disp_x
    boundary = top
    value = 0
  []
[]

[Materials]
  [bulk]
    type = ADGenericConstantMaterial
    prop_names = &#x27;K G&#x27;
    prop_values = &#x27;${K} ${G}&#x27;
  []
  [degradation]
    type = PowerDegradationFunction
    property_name = g
    expression = (1-d)^p*(1-eta)+eta
    phase_field = d
    parameter_names = &#x27;p eta &#x27;
    parameter_values = &#x27;2 1e-6&#x27;
  []
  [strain]
    type = ADComputeSmallStrain
  []
  [elasticity]
    type = SmallDeformationIsotropicElasticity
    bulk_modulus = K
    shear_modulus = G
    phase_field = d
    degradation_function = g
    decomposition = NONE
    output_properties = &#x27;elastic_strain psie_active&#x27;
    outputs = exodus
  []
  [stress]
    type = ComputeSmallDeformationStress
    elasticity_model = elasticity
    output_properties = &#x27;stress&#x27;
    outputs = exodus
  []
[]

[Postprocessors]
  [Fy]
    type = NodalSum
    variable = fy
    boundary = top
  []
[]

[Executioner]
  type = Transient

  solve_type = NEWTON
  petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
  petsc_options_value = &#x27;lu       superlu_dist                 &#x27;
  automatic_scaling = true

  nl_rel_tol = 1e-8
  nl_abs_tol = 1e-10

  dt = 2e-5
  end_time = 3.5e-3

  fixed_point_max_its = 20
  accept_on_max_fixed_point_iteration = true
  fixed_point_rel_tol = 1e-8
  fixed_point_abs_tol = 1e-10
[]

[Outputs]
  exodus = true
  print_linear_residuals = false
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="f8c757bb-00a1-4269-8253-326b24cd53db"><div class="modal-content"><h4>(tutorials/traction_separation/elasticity.i)</h4><pre style="max-height:350px;"><code class="language-moose">E = 3e4
nu = 0.2
K = &#x27;${fparse E/3/(1-2*nu)}&#x27;
G = &#x27;${fparse E/2/(1+nu)}&#x27;

p = 0.5

Gc = 0.12
sigmac = 3
psic = &#x27;${fparse sigmac^2/2/E}&#x27;
l = 20
R = 10
h = &#x27;${fparse l/R}&#x27;
nx = &#x27;${fparse ceil(200/h)}&#x27;

[MultiApps]
  [fracture]
    type = TransientMultiApp
    input_files = fracture.i
    cli_args = &#x27;p=${p};Gc=${Gc};psic=${psic};l=${l};nx=${nx}&#x27;
    execute_on = &#x27;TIMESTEP_END&#x27;
  []
[]

[Transfers]
  [from_fracture]
    type = MultiAppCopyTransfer
    from_multi_app = &#x27;fracture&#x27;
    variable = d
    source_variable = d
  []
  [to_fracture]
    type = MultiAppCopyTransfer
    to_multi_app = &#x27;fracture&#x27;
    variable = &#x27;psie_active disp_x disp_y&#x27;
    source_variable = &#x27;psie_active disp_x disp_y&#x27;
  []
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y&#x27;
[]

[Mesh]
  [gen]
    type = GeneratedMeshGenerator
    dim = 2
    xmax = 200
    ymax = 1
    nx = ${nx}
    ny = 1
  []
[]

[Variables]
  [disp_x]
  []
  [disp_y]
  []
[]

[AuxVariables]
  [fx]
  []
  [d]
  []
[]

[Kernels]
  [solid_x]
    type = ADStressDivergenceTensors
    variable = disp_x
    component = 0
    save_in = fx
  []
  [solid_y]
    type = ADStressDivergenceTensors
    variable = disp_y
    component = 1
  []
  [pressure_x]
    type = ADPressurizedCrack
    variable = disp_x
    pressure = p
    phase_field = d
    indicator_function = I
    component = 0
  []
  [pressure_y]
    type = ADPressurizedCrack
    variable = disp_y
    pressure = p
    phase_field = d
    indicator_function = I
    component = 1
  []
[]

[BCs]
  [xdisp]
    type = FunctionDirichletBC
    variable = disp_x
    boundary = right
    function = &#x27;t&#x27;
  []
  [yfix]
    type = DirichletBC
    variable = disp_y
    boundary = bottom
    value = 0
  []
  [xfix]
    type = DirichletBC
    variable = disp_x
    boundary = left
    value = 0
  []
[]

[Materials]
  [bulk_properties]
    type = ADGenericConstantMaterial
    prop_names = &#x27;K G l Gc psic p&#x27;
    prop_values = &#x27;${K} ${G} ${l} ${Gc} ${psic} ${p}&#x27;
  []
  [crack_geometric]
    type = CrackGeometricFunction
    property_name = alpha
    expression = &#x27;2*d-d^2&#x27;
    phase_field = d
  []
  [indicator]
    type = ADDerivativeParsedMaterial
    property_name = I
    coupled_variables = &#x27;d&#x27;
    expression = &#x27;d^2&#x27;
    derivative_order = 1
  []
  [degradation]
    type = RationalDegradationFunction
    property_name = g
    expression = (1-d)^p/((1-d)^p+(Gc/psic*xi/c0/l)*d*(1+a2*d+a2*a3*d^2))*(1-eta)+eta
    phase_field = d
    material_property_names = &#x27;Gc psic xi c0 l &#x27;
    parameter_names = &#x27;p a2 a3 eta &#x27;
    parameter_values = &#x27;2 -0.5 0 1e-6&#x27;
  []
  [strain]
    type = ADComputeSmallStrain
  []
  [elasticity]
    type = SmallDeformationIsotropicElasticity
    bulk_modulus = K
    shear_modulus = G
    phase_field = d
    degradation_function = g
    decomposition = NONE
    output_properties = &#x27;psie_active&#x27;
    outputs = exodus
  []
  [stress]
    type = ComputeSmallDeformationStress
    elasticity_model = elasticity
  []
  [pressure_density]
    type = PressureDensity
    effective_pressure_density = p_density
    phase_field = d
    pressure = p
    indicator_function = I
  []
[]

[Postprocessors]
  [Fx_left]
    type = NodalSum
    variable = fx
    boundary = left
  []
  [Fx_right]
    type = NodalSum
    variable = fx
    boundary = right
  []
  [effective_pressure]
    type = ADElementIntegralMaterialProperty
    mat_prop = p_density
  []
[]

[Executioner]
  type = Transient

  solve_type = NEWTON
  petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
  petsc_options_value = &#x27;lu       superlu_dist                 &#x27;
  automatic_scaling = true

  nl_rel_tol = 1e-8
  nl_abs_tol = 1e-10

  dt = 5e-4
  end_time = 5e-2

  fixed_point_max_its = 200
  accept_on_max_fixed_point_iteration = false
  fixed_point_rel_tol = 1e-8
  fixed_point_abs_tol = 1e-10
[]

[Outputs]
  file_base = &#x27;p_${p}_l_${l}&#x27;
  exodus = true
  csv = true
  print_linear_residuals = false
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="e5bc5474-f144-4de7-9ebc-6f982eba7c93"><div class="modal-content"><h4>(tutorials/adaptivity/elasticity.i)</h4><pre style="max-height:350px;"><code class="language-moose">E = 2.1e5
nu = 0.3
K = &#x27;${fparse E/3/(1-2*nu)}&#x27;
G = &#x27;${fparse E/2/(1+nu)}&#x27;

Gc = 2.7
psic = 14.88
l = 0.01

[MultiApps]
  [fracture]
    type = TransientMultiApp
    input_files = fracture.i
    cli_args = &#x27;Gc=${Gc};psic=${psic};l=${l}&#x27;
    execute_on = &#x27;TIMESTEP_END&#x27;
  []
[]

[Transfers]
  [from_d]
    type = MultiAppGeneralFieldShapeEvaluationTransfer
    from_multi_app = &#x27;fracture&#x27;
    variable = d
    source_variable = d
  []
  [to_psie]
    type = MultiAppGeneralFieldShapeEvaluationTransfer
    to_multi_app = &#x27;fracture&#x27;
    variable = &#x27;psie_active psie&#x27;
    source_variable = &#x27;psie_active psie&#x27;
  []
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y&#x27;
[]

[Mesh]
  [top_half]
    type = GeneratedMeshGenerator
    dim = 2
    nx = 30
    ny = 15
    ymin = 0
    ymax = 0.5
    boundary_id_offset = 0
    boundary_name_prefix = top_half
  []
  [top_stitch]
    type = BoundingBoxNodeSetGenerator
    input = top_half
    new_boundary = top_stitch
    bottom_left = &#x27;0.5 0 0&#x27;
    top_right = &#x27;1 0 0&#x27;
  []
  [bottom_half]
    type = GeneratedMeshGenerator
    dim = 2
    nx = 30
    ny = 15
    ymin = -0.5
    ymax = 0
    boundary_id_offset = 5
    boundary_name_prefix = bottom_half
  []
  [bottom_stitch]
    type = BoundingBoxNodeSetGenerator
    input = bottom_half
    new_boundary = bottom_stitch
    bottom_left = &#x27;0.5 0 0&#x27;
    top_right = &#x27;1 0 0&#x27;
  []
  [stitch]
    type = StitchedMeshGenerator
    inputs = &#x27;top_stitch bottom_stitch&#x27;
    stitch_boundaries_pairs = &#x27;top_stitch bottom_stitch&#x27;
  []
  construct_side_list_from_node_list = true
[]

[Adaptivity]
  marker = combo
  max_h_level = 3
  [Markers]
    [combo]
      type = ComboMarker
      markers = &#x27;damage_marker strain_energy_marker&#x27;
    []
    [damage_marker]
      type = ValueThresholdMarker
      variable = d
      refine = 0.5
    []
    [strain_energy_marker]
      type = ValueThresholdMarker
      variable = psie
      refine = &#x27;${fparse 0.8*psic}&#x27;
      coarsen = &#x27;${fparse 0.8*psic}&#x27;
    []
  []
[]

[Variables]
  [disp_x]
  []
  [disp_y]
  []
[]

[AuxVariables]
  [fx]
  []
  [d]
  []
  [psie_active]
    order = CONSTANT
    family = MONOMIAL
  []
  [psie]
    order = CONSTANT
    family = MONOMIAL
  []
[]

[AuxKernels]
  [psie_active]
    type = ADMaterialRealAux
    variable = psie_active
    property = psie_active
  []
  [psie]
    type = ADMaterialRealAux
    variable = psie
    property = psie
  []
[]

[Kernels]
  [solid_x]
    type = ADStressDivergenceTensors
    variable = disp_x
    component = 0
    save_in = fx
  []
  [solid_y]
    type = ADStressDivergenceTensors
    variable = disp_y
    component = 1
  []
[]

[BCs]
  [xdisp]
    type = FunctionDirichletBC
    variable = &#x27;disp_x&#x27;
    boundary = &#x27;top_half_top&#x27;
    function = &#x27;t&#x27;
    preset = false
  []
  [yfix]
    type = DirichletBC
    variable = &#x27;disp_y&#x27;
    boundary = &#x27;top_half_top bottom_half_bottom top_half_left top_half_right bottom_half_left bottom_half_right&#x27;
    value = 0
  []
  [xfix]
    type = DirichletBC
    variable = &#x27;disp_x&#x27;
    boundary = &#x27;bottom_half_bottom&#x27;
    value = 0
  []
[]

[Materials]
  [bulk_properties]
    type = ADGenericConstantMaterial
    prop_names = &#x27;K G l Gc psic&#x27;
    prop_values = &#x27;${K} ${G} ${l} ${Gc} ${psic}&#x27;
  []
  [crack_geometric]
    type = CrackGeometricFunction
    property_name = alpha
    expression = &#x27;d&#x27;
    phase_field = d
  []
  [degradation]
    type = RationalDegradationFunction
    property_name = g
    expression = (1-d)^p/((1-d)^p+(Gc/psic*xi/c0/l)*d*(1+a2*d+a2*a3*d^2))*(1-eta)+eta
    phase_field = d
    material_property_names = &#x27;Gc psic xi c0 l &#x27;
    parameter_names = &#x27;p a2 a3 eta &#x27;
    parameter_values = &#x27;2 -0.5 0 1e-6&#x27;
  []
  [strain]
    type = ADComputeSmallStrain
  []
  [elasticity]
    type = SmallDeformationIsotropicElasticity
    bulk_modulus = K
    shear_modulus = G
    phase_field = d
    degradation_function = g
    decomposition = SPECTRAL
  []
  [stress]
    type = ComputeSmallDeformationStress
    elasticity_model = elasticity
  []
[]

[Postprocessors]
  [Fx]
    type = NodalSum
    variable = fx
    boundary = top_half_top
  []
[]

[Executioner]
  type = Transient

  solve_type = NEWTON
  petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
  petsc_options_value = &#x27;lu       superlu_dist                 &#x27;
  automatic_scaling = true

  nl_rel_tol = 1e-8
  nl_abs_tol = 1e-10

  dt = 2e-5
  end_time = 2e-2

  fixed_point_max_its = 20
  accept_on_max_fixed_point_iteration = true
  fixed_point_rel_tol = 1e-8
  fixed_point_abs_tol = 1e-10
[]

[Outputs]
  exodus = true
  print_linear_residuals = false
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="58888dfe-490e-40c3-ac0f-9a349989419f"><div class="modal-content"><h4>(tutorials/mode2_cohesive_fracture/elasticity.i)</h4><pre style="max-height:350px;"><code class="language-moose">E = 2.1e5
nu = 0.3
K = &#x27;${fparse E/3/(1-2*nu)}&#x27;
G = &#x27;${fparse E/2/(1+nu)}&#x27;

Gc = 2.7
psic = 14.88
l = 0.02

[MultiApps]
  [fracture]
    type = TransientMultiApp
    input_files = fracture.i
    cli_args = &#x27;Gc=${Gc};psic=${psic};l=${l}&#x27;
    execute_on = &#x27;TIMESTEP_END&#x27;
  []
[]

[Transfers]
  [from_d]
    type = MultiAppCopyTransfer
    from_multi_app = &#x27;fracture&#x27;
    variable = d
    source_variable = d
  []
  [to_psie_active]
    type = MultiAppCopyTransfer
    to_multi_app = &#x27;fracture&#x27;
    variable = psie_active
    source_variable = psie_active
  []
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y&#x27;
[]

[Mesh]
  [top_half]
    type = GeneratedMeshGenerator
    dim = 2
    nx = 30
    ny = 15
    ymin = 0
    ymax = 0.5
    boundary_id_offset = 0
    boundary_name_prefix = top_half
  []
  [top_stitch]
    type = BoundingBoxNodeSetGenerator
    input = top_half
    new_boundary = top_stitch
    bottom_left = &#x27;0.5 0 0&#x27;
    top_right = &#x27;1 0 0&#x27;
  []
  [bottom_half]
    type = GeneratedMeshGenerator
    dim = 2
    nx = 30
    ny = 15
    ymin = -0.5
    ymax = 0
    boundary_id_offset = 5
    boundary_name_prefix = bottom_half
  []
  [bottom_stitch]
    type = BoundingBoxNodeSetGenerator
    input = bottom_half
    new_boundary = bottom_stitch
    bottom_left = &#x27;0.5 0 0&#x27;
    top_right = &#x27;1 0 0&#x27;
  []
  [stitch]
    type = StitchedMeshGenerator
    inputs = &#x27;top_stitch bottom_stitch&#x27;
    stitch_boundaries_pairs = &#x27;top_stitch bottom_stitch&#x27;
  []
  construct_side_list_from_node_list = true
[]

[Adaptivity]
  marker = marker
  initial_marker = marker
  initial_steps = 2
  stop_time = 0
  max_h_level = 2
  [Markers]
    [marker]
      type = OrientedBoxMarker
      center = &#x27;0.65 -0.25 0&#x27;
      length = 0.8
      width = 0.2
      height = 1
      length_direction = &#x27;1 -1.5 0&#x27;
      width_direction = &#x27;1.5 1 0&#x27;
      inside = REFINE
      outside = DO_NOTHING
    []
  []
[]

[Variables]
  [disp_x]
  []
  [disp_y]
  []
[]

[AuxVariables]
  [fx]
  []
  [d]
  []
[]

[Kernels]
  [solid_x]
    type = ADStressDivergenceTensors
    variable = disp_x
    component = 0
    save_in = fx
  []
  [solid_y]
    type = ADStressDivergenceTensors
    variable = disp_y
    component = 1
  []
[]

[BCs]
  [xdisp]
    type = FunctionDirichletBC
    variable = &#x27;disp_x&#x27;
    boundary = &#x27;top_half_top&#x27;
    function = &#x27;t&#x27;
    preset = false
  []
  [yfix]
    type = DirichletBC
    variable = &#x27;disp_y&#x27;
    boundary = &#x27;top_half_top bottom_half_bottom top_half_left top_half_right bottom_half_left bottom_half_right&#x27;
    value = 0
  []
  [xfix]
    type = DirichletBC
    variable = &#x27;disp_x&#x27;
    boundary = &#x27;bottom_half_bottom&#x27;
    value = 0
  []
[]

[Materials]
  [bulk_properties]
    type = ADGenericConstantMaterial
    prop_names = &#x27;K G l Gc psic&#x27;
    prop_values = &#x27;${K} ${G} ${l} ${Gc} ${psic}&#x27;
  []
  [crack_geometric]
    type = CrackGeometricFunction
    property_name = alpha
    expression = &#x27;d&#x27;
    phase_field = d
  []
  [degradation]
    type = RationalDegradationFunction
    property_name = g
    expression = (1-d)^p/((1-d)^p+(Gc/psic*xi/c0/l)*d*(1+a2*d+a2*a3*d^2))*(1-eta)+eta
    phase_field = d
    material_property_names = &#x27;Gc psic xi c0 l &#x27;
    parameter_names = &#x27;p a2 a3 eta &#x27;
    parameter_values = &#x27;2 -0.5 0 1e-6&#x27;
  []
  [strain]
    type = ADComputeSmallStrain
  []
  [elasticity]
    type = SmallDeformationIsotropicElasticity
    bulk_modulus = K
    shear_modulus = G
    phase_field = d
    degradation_function = g
    decomposition = SPECTRAL
    output_properties = &#x27;elastic_strain psie_active&#x27;
    outputs = exodus
  []
  [stress]
    type = ComputeSmallDeformationStress
    elasticity_model = elasticity
    output_properties = &#x27;stress&#x27;
    outputs = exodus
  []
[]

[Postprocessors]
  [Fx]
    type = NodalSum
    variable = fx
    boundary = top_half_top
  []
[]

[Executioner]
  type = Transient

  solve_type = NEWTON
  petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
  petsc_options_value = &#x27;lu       superlu_dist                 &#x27;
  automatic_scaling = true

  nl_rel_tol = 1e-8
  nl_abs_tol = 1e-10

  dt = 2e-5
  end_time = 2e-2

  fixed_point_max_its = 20
  accept_on_max_fixed_point_iteration = true
  fixed_point_rel_tol = 1e-8
  fixed_point_abs_tol = 1e-10
[]

[Outputs]
  exodus = true
  print_linear_residuals = false
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="28346a40-06b7-474f-8ce5-7629c7791f5e"><div class="modal-content"><h4>(tutorials/mode1_ductile_fracture/elastoplasticity.i)</h4><pre style="max-height:350px;"><code class="language-moose">E = 2.1e5
nu = 0.3
K = &#x27;${fparse E/3/(1-2*nu)}&#x27;
G = &#x27;${fparse E/2/(1+nu)}&#x27;

Gc = 2.7
psic = 14.88
l = 0.02

sigma_y = 1000
n = 5
ep0 = 0.005

[MultiApps]
  [fracture]
    type = TransientMultiApp
    input_files = fracture.i
    cli_args = &#x27;Gc=${Gc};psic=${psic};l=${l}&#x27;
    execute_on = &#x27;TIMESTEP_END&#x27;
  []
[]

[Transfers]
  [from_d]
    type = MultiAppGeneralFieldShapeEvaluationTransfer
    from_multi_app = &#x27;fracture&#x27;
    variable = d
    source_variable = d
  []
  [to_psie_active]
    type = MultiAppGeneralFieldShapeEvaluationTransfer
    to_multi_app = &#x27;fracture&#x27;
    variable = psie_active
    source_variable = psie_active
  []
  [to_psip_active]
    type = MultiAppGeneralFieldShapeEvaluationTransfer
    to_multi_app = &#x27;fracture&#x27;
    variable = psip_active
    source_variable = psip_active
  []
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y&#x27;
  volumetric_locking_correction = true
[]

[Mesh]
  [gen]
    type = GeneratedMeshGenerator
    dim = 2
    nx = 30
    ny = 15
    ymax = 0.5
  []
  [noncrack]
    type = BoundingBoxNodeSetGenerator
    input = gen
    new_boundary = noncrack
    bottom_left = &#x27;0.5 0 0&#x27;
    top_right = &#x27;1 0 0&#x27;
  []
  construct_side_list_from_node_list = true
[]

[Adaptivity]
  marker = marker
  initial_marker = marker
  initial_steps = 2
  stop_time = 0
  max_h_level = 2
  [Markers]
    [marker]
      type = OrientedBoxMarker
      center = &#x27;0.75 0.25 0&#x27;
      length = 0.8
      width = 0.1
      height = 1
      length_direction = &#x27;1 1 0&#x27;
      width_direction = &#x27;-1 1 0&#x27;
      inside = REFINE
      outside = DO_NOTHING
    []
  []
[]

[Variables]
  [disp_x]
  []
  [disp_y]
  []
[]

[AuxVariables]
  [fy]
  []
  [d]
  []
[]

[Kernels]
  [solid_x]
    type = ADStressDivergenceTensors
    variable = disp_x
    component = 0
  []
  [solid_y]
    type = ADStressDivergenceTensors
    variable = disp_y
    component = 1
    save_in = fy
  []
[]

[BCs]
  [ydisp]
    type = FunctionDirichletBC
    variable = disp_y
    boundary = top
    function = &#x27;t&#x27;
  []
  [yfix]
    type = DirichletBC
    variable = disp_y
    boundary = noncrack
    value = 0
  []
  [xfix]
    type = DirichletBC
    variable = disp_x
    boundary = top
    value = 0
  []
[]

[Materials]
  [bulk_properties]
    type = ADGenericConstantMaterial
    prop_names = &#x27;K G l Gc psic&#x27;
    prop_values = &#x27;${K} ${G} ${l} ${Gc} ${psic}&#x27;
  []
  [crack_geometric]
    type = CrackGeometricFunction
    property_name = alpha
    expression = &#x27;d&#x27;
    phase_field = d
  []
  [degradation]
    type = RationalDegradationFunction
    property_name = g
    expression = (1-d)^p/((1-d)^p+(Gc/psic*xi/c0/l)*d*(1+a2*d+a2*a3*d^2))*(1-eta)+eta
    phase_field = d
    material_property_names = &#x27;Gc psic xi c0 l &#x27;
    parameter_names = &#x27;p a2 a3 eta &#x27;
    parameter_values = &#x27;2 -0.5 0 1e-6&#x27;
  []
  [strain]
    type = ADComputeSmallStrain
  []
  [elasticity]
    type = SmallDeformationIsotropicElasticity
    bulk_modulus = K
    shear_modulus = G
    phase_field = d
    degradation_function = g
    decomposition = NONE
    output_properties = &#x27;elastic_strain psie_active&#x27;
    outputs = exodus
  []
  [plasticity]
    type = SmallDeformationJ2Plasticity
    hardening_model = power_law_hardening
    output_properties = &#x27;effective_plastic_strain&#x27;
    outputs = exodus
  []
  [power_law_hardening]
    type = PowerLawHardening
    degradation_function = g
    yield_stress = ${sigma_y}
    exponent = ${n}
    reference_plastic_strain = ${ep0}
    phase_field = d
    output_properties = &#x27;psip_active&#x27;
    outputs = exodus
  []
  [stress]
    type = ComputeSmallDeformationStress
    elasticity_model = elasticity
    plasticity_model = plasticity
    output_properties = &#x27;stress&#x27;
    outputs = exodus
  []
[]

[Postprocessors]
  [Fy]
    type = NodalSum
    variable = fy
    boundary = top
  []
[]

[Executioner]
  type = Transient

  solve_type = NEWTON
  petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
  petsc_options_value = &#x27;lu       superlu_dist                 &#x27;
  automatic_scaling = true

  nl_rel_tol = 1e-8
  nl_abs_tol = 1e-10

  dt = 2e-5
  end_time = 1e-2

  fixed_point_max_its = 20
  accept_on_max_fixed_point_iteration = true
  fixed_point_rel_tol = 1e-8
  fixed_point_abs_tol = 1e-10
[]

[Outputs]
  exodus = true
  print_linear_residuals = false
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="87ac4d22-3e68-469a-94f7-a44da3fe3caa"><div class="modal-content"><h4>(test/tests/nucleation_models/ldl.i)</h4><pre style="max-height:350px;"><code class="language-moose">sigma_hs = &#x27;${fparse 2/3*sigma_ts*sigma_cs/(sigma_cs - sigma_ts)}&#x27;

[Mesh]
  [gen]
    type = GeneratedMeshGenerator
    dim = 2
    nx = ${nx}
    ny = ${ny}
    xmax = 30
    ymin = -5
    ymax = 5
  []
[]

[Adaptivity]
  marker = marker
  initial_marker = marker
  initial_steps = ${refine}
  stop_time = 0
  max_h_level = ${refine}
  [Markers]
    [marker]
      type = BoxMarker
      bottom_left = &#x27;0 -0.7 0&#x27;
      top_right = &#x27;30 0.7 0&#x27;
      outside = DO_NOTHING
      inside = REFINE
    []
  []
[]

[Variables]
  [d]
    [InitialCondition]
      type = FunctionIC
      function = &#x27;if(y=0&amp;x&gt;=0&amp;x&lt;=5,1,0)&#x27;
    []
  []
[]

[AuxVariables]
  [bounds_dummy]
  []
  [disp_x]
  []
  [disp_y]
  []
  [strain_zz]
  []
  [psie_active]
    order = CONSTANT
    family = MONOMIAL
  []
[]

[Bounds]
  [conditional]
    type = ConditionalBoundsAux
    variable = bounds_dummy
    bounded_variable = d
    fixed_bound_value = 0
    threshold_value = 0.95
  []
  [upper]
    type = ConstantBounds
    variable = bounds_dummy
    bounded_variable = d
    bound_type = upper
    bound_value = 1
  []
[]

[Kernels]
  [diff]
    type = ADPFFDiffusion
    variable = d
    fracture_toughness = Gc_delta
    regularization_length = l
    normalization_constant = c0
  []
  [source]
    type = ADPFFSource
    variable = d
    free_energy = psi
  []
  [nuc_force]
    type = ADCoefMatSource
    variable = d
    prop_names = &#x27;ce&#x27;
    coefficient = 1.0
  []
[]

[Materials]
  [fracture_properties]
    type = ADGenericConstantMaterial
    prop_names = &#x27;E K G lambda Gc l sigma_ts sigma_hs&#x27;
    prop_values = &#x27;${E} ${K} ${G} ${Lambda} ${Gc} ${l} ${sigma_ts} ${sigma_hs}&#x27;
  []
  [degradation]
    type = PowerDegradationFunction
    property_name = g
    expression = (1-d)^p*(1-eta)+eta
    phase_field = d
    parameter_names = &#x27;p eta &#x27;
    parameter_values = &#x27;2 0&#x27;
  []
  [crack_geometric]
    type = CrackGeometricFunction
    property_name = alpha
    expression = &#x27;d&#x27;
    phase_field = d
  []
  [psi]
    type = ADDerivativeParsedMaterial
    property_name = psi
    expression = &#x27;g*psie_active+(Gc*delta/c0/l)*alpha&#x27;
    coupled_variables = &#x27;d psie_active&#x27;
    material_property_names = &#x27;delta alpha(d) g(d) Gc c0 l&#x27;
    derivative_order = 1
  []
  [nucleation_micro_force]
    type = LDLNucleationMicroForce
    phase_field = d
    degradation_function = g
    regularization_length = l
    normalization_constant = c0
    fracture_toughness = Gc
    tensile_strength = sigma_ts
    hydrostatic_strength = sigma_hs
    delta = delta
    h_correction = true
    external_driving_force_name = ce
  []
  [strain]
    type = ADComputePlaneSmallStrain
    out_of_plane_strain = &#x27;strain_zz&#x27;
    displacements = &#x27;disp_x disp_y&#x27;
  []
  [elasticity]
    type = SmallDeformationIsotropicElasticity
    bulk_modulus = K
    shear_modulus = G
    phase_field = d
    degradation_function = g
    decomposition = NONE
  []
  [stress]
    type = ComputeSmallDeformationStress
    elasticity_model = elasticity
  []
  [Gc_delta]
    type = ADParsedMaterial
    property_name = Gc_delta
    expression = &#x27;Gc*delta&#x27;
    material_property_names = &#x27;Gc delta&#x27;
  []
[]

[Executioner]
  type = Transient

  solve_type = NEWTON
  petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package -snes_type&#x27;
  petsc_options_value = &#x27;lu       superlu_dist                  vinewtonrsls&#x27;
  automatic_scaling = true

  nl_rel_tol = 1e-8
  nl_abs_tol = 1e-10
[]

[Outputs]
  print_linear_residuals = false
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="a096efba-d489-4f5d-a1e5-512f0b295a7a"><div class="modal-content"><h4>(test/tests/nucleation_models/elasticity.i)</h4><pre style="max-height:350px;"><code class="language-moose"># This  tutorial is based on example of material graphite in section 4.3.4
# See Kumar et. al. https://doi.org/10.1016/j.jmps.2020.104027.
# For regularization length 0.35mm, delta 1.16, mesh size 0.035,
# J intergal over Gc should return a value close to 1
# delta value 0.2 is updated for model 2022
# (see Kumar et. al. https://doi.org/10.1007/s10704-022-00653-z)

E = 9.8e3 #9.8Gpa
nu = 0.13
K = &#x27;${fparse E/3/(1-2*nu)}&#x27;
G = &#x27;${fparse E/2/(1+nu)}&#x27;
Lambda = &#x27;${fparse E*nu/(1+nu)/(1-2*nu)}&#x27;

Gc = 9.1e-2 # 91N/m
l = 0.35
sigma_ts = 27
sigma_cs = 77
# for model 2022 (KLR), select delta=0.2
# for model 2020 (KLBF), select delta=1.16
# delta = 0.2 #1.16
delta = 1.16
c1 = &#x27;${fparse (1+nu)*sqrt(Gc)/sqrt(2*pi*E)}&#x27;
c2 = &#x27;${fparse (3-nu)/(1+nu)}&#x27;
ahead = 0
V = 20
# mesh size 0.035
nx = 30
ny = 10
refine = 1

[Functions]
  [bc_func]
    type = ParsedFunction
    expression = c1*((x-V*t-ahead)^2+y^2)^(0.25)*(c2-cos(atan2(y,(x-V*t-ahead))))*sin(0.5*atan2(y,(x-V*t-ahead)))
    symbol_names = &#x27;c1 c2 V ahead&#x27;
    symbol_values = &#x27;${c1} ${c2} ${V} ${ahead}&#x27;
  []
[]

[MultiApps]
  [fracture]
    type = TransientMultiApp
    input_files = klr.i
    cli_args = &#x27;E=${E};K=${K};G=${G};Lambda=${Lambda};Gc=${Gc};l=${l};nx=${nx};ny=${ny};refine=${refine};sigma_ts=${sigma_ts};sigma_cs=${sigma_cs};delta=${delta}&#x27;
    execute_on = &#x27;TIMESTEP_END&#x27;
  []
[]

[Transfers]
  [from_d]
    type = MultiAppCopyTransfer
    from_multi_app = fracture
    variable = &#x27;d ce&#x27;
    source_variable = &#x27;d ce&#x27;
  []
  [to_psie_active]
    type = MultiAppCopyTransfer
    to_multi_app = fracture
    variable = &#x27;disp_x disp_y strain_zz psie_active&#x27;
    source_variable = &#x27;disp_x disp_y strain_zz psie_active&#x27;
  []
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y&#x27;
[]

[Mesh]
  [gen]
    type = GeneratedMeshGenerator
    dim = 2
    nx = ${nx}
    ny = ${ny}
    xmax = 30
    ymin = -5
    ymax = 5
  []
  [gen2]
    type = ExtraNodesetGenerator
    input = gen
    new_boundary = fix_point
    coord = &#x27;0 -5&#x27;
  []
[]

[Adaptivity]
  marker = marker
  initial_marker = marker
  initial_steps = ${refine}
  stop_time = 0
  max_h_level = ${refine}
  [Markers]
    [marker]
      type = BoxMarker
      bottom_left = &#x27;0 -0.7 0&#x27;
      top_right = &#x27;30 0.7 0&#x27;
      outside = DO_NOTHING
      inside = REFINE
    []
  []
[]

[Variables]
  [disp_x]
  []
  [disp_y]
  []
  [strain_zz]
  []
[]

[AuxVariables]
  [d]
    [InitialCondition]
      type = FunctionIC
      function = &#x27;if(y=0&amp;x&gt;=0&amp;x&lt;=5,1,0)&#x27;
    []
  []
  [ce]
    order = CONSTANT
    family = MONOMIAL
  []
[]

[Kernels]
  [solid_x]
    type = ADStressDivergenceTensors
    variable = disp_x
    component = 0
  []
  [solid_y]
    type = ADStressDivergenceTensors
    variable = disp_y
    component = 1
  []
  [plane_stress]
    type = ADWeakPlaneStress
    variable = &#x27;strain_zz&#x27;
    displacements = &#x27;disp_x disp_y&#x27;
  []
[]

[BCs]
  [fix_x]
    type = DirichletBC
    variable = disp_x
    boundary = fix_point
    value = 0
  []
  [bottom_y]
    type = FunctionDirichletBC
    variable = disp_y
    boundary = bottom
    function = bc_func
  []
  [top_y]
    type = FunctionDirichletBC
    variable = disp_y
    boundary = top
    function = bc_func
  []
[]

[Materials]
  [bulk]
    type = ADGenericConstantMaterial
    prop_names = &#x27;E K G lambda Gc l&#x27;
    prop_values = &#x27;${E} ${K} ${G} ${Lambda} ${Gc} ${l}&#x27;
  []
  [degradation]
    type = PowerDegradationFunction
    property_name = g
    expression = (1-d)^p*(1-eta)+eta
    phase_field = d
    parameter_names = &#x27;p eta &#x27;
    parameter_values = &#x27;2 0&#x27;
  []
  [strain]
    type = ADComputePlaneSmallStrain
    out_of_plane_strain = &#x27;strain_zz&#x27;
    displacements = &#x27;disp_x disp_y&#x27;
  []
  [elasticity]
    type = SmallDeformationIsotropicElasticity
    bulk_modulus = K
    shear_modulus = G
    phase_field = d
    degradation_function = g
    decomposition = NONE
    output_properties = &#x27;psie_active psie&#x27;
    outputs = exodus
  []
  [stress]
    type = ComputeSmallDeformationStress
    elasticity_model = elasticity
  []
[]

[Postprocessors]
  [Jint]
    type = PhaseFieldJIntegral
    J_direction = &#x27;1 0 0&#x27;
    strain_energy_density = psie
    displacements = &#x27;disp_x disp_y&#x27;
    boundary = &#x27;left top right bottom&#x27;
  []
  [Jint_over_Gc]
    type = ScalePostprocessor
    value = &#x27;Jint&#x27;
    scaling_factor = &#x27;${fparse 1.0/Gc}&#x27;
  []
[]

[Executioner]
  type = Transient

  solve_type = NEWTON
  petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
  petsc_options_value = &#x27;lu       superlu_dist                 &#x27;
  automatic_scaling = true

  nl_rel_tol = 1e-8
  nl_abs_tol = 1e-10

  dt = 1e-2
  dtmin = 1e-2
  end_time = 0.3
  num_steps = 2

  fixed_point_max_its = 500
  accept_on_max_fixed_point_iteration = false
  fixed_point_rel_tol = 1e-6
  fixed_point_abs_tol = 1e-8
[]

[Outputs]
  file_base = klr_out
  exodus = true
  print_linear_residuals = false
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="576f4628-ccae-4937-8e17-72b911a2a01b"><div class="modal-content"><h4>(tutorials/mode2_brittle_fracture/elasticity.i)</h4><pre style="max-height:350px;"><code class="language-moose">E = 2.1e5
nu = 0.3
K = &#x27;${fparse E/3/(1-2*nu)}&#x27;
G = &#x27;${fparse E/2/(1+nu)}&#x27;

Gc = 2.7
l = 0.02

[MultiApps]
  [fracture]
    type = TransientMultiApp
    input_files = fracture.i
    cli_args = &#x27;Gc=${Gc};l=${l}&#x27;
    execute_on = &#x27;TIMESTEP_END&#x27;
  []
[]

[Transfers]
  [from_d]
    type = MultiAppCopyTransfer
    from_multi_app = &#x27;fracture&#x27;
    variable = d
    source_variable = d
  []
  [to_psie_active]
    type = MultiAppCopyTransfer
    to_multi_app = &#x27;fracture&#x27;
    variable = psie_active
    source_variable = psie_active
  []
[]

[GlobalParams]
  displacements = &#x27;disp_x disp_y&#x27;
[]

[Mesh]
  [top_half]
    type = GeneratedMeshGenerator
    dim = 2
    nx = 30
    ny = 15
    ymin = 0
    ymax = 0.5
    boundary_id_offset = 0
    boundary_name_prefix = top_half
  []
  [top_stitch]
    type = BoundingBoxNodeSetGenerator
    input = top_half
    new_boundary = top_stitch
    bottom_left = &#x27;0.5 0 0&#x27;
    top_right = &#x27;1 0 0&#x27;
  []
  [bottom_half]
    type = GeneratedMeshGenerator
    dim = 2
    nx = 30
    ny = 15
    ymin = -0.5
    ymax = 0
    boundary_id_offset = 5
    boundary_name_prefix = bottom_half
  []
  [bottom_stitch]
    type = BoundingBoxNodeSetGenerator
    input = bottom_half
    new_boundary = bottom_stitch
    bottom_left = &#x27;0.5 0 0&#x27;
    top_right = &#x27;1 0 0&#x27;
  []
  [stitch]
    type = StitchedMeshGenerator
    inputs = &#x27;top_stitch bottom_stitch&#x27;
    stitch_boundaries_pairs = &#x27;top_stitch bottom_stitch&#x27;
  []
  construct_side_list_from_node_list = true
[]

[Adaptivity]
  marker = marker
  initial_marker = marker
  initial_steps = 2
  stop_time = 0
  max_h_level = 2
  [Markers]
    [marker]
      type = OrientedBoxMarker
      center = &#x27;0.65 -0.25 0&#x27;
      length = 0.8
      width = 0.2
      height = 1
      length_direction = &#x27;1 -1.5 0&#x27;
      width_direction = &#x27;1.5 1 0&#x27;
      inside = REFINE
      outside = DO_NOTHING
    []
  []
[]

[Variables]
  [disp_x]
  []
  [disp_y]
  []
[]

[AuxVariables]
  [fx]
  []
  [d]
  []
[]

[Kernels]
  [solid_x]
    type = ADStressDivergenceTensors
    variable = disp_x
    component = 0
    save_in = fx
  []
  [solid_y]
    type = ADStressDivergenceTensors
    variable = disp_y
    component = 1
  []
[]

[BCs]
  [xdisp]
    type = FunctionDirichletBC
    variable = &#x27;disp_x&#x27;
    boundary = &#x27;top_half_top&#x27;
    function = &#x27;t&#x27;
    preset = false
  []
  [yfix]
    type = DirichletBC
    variable = &#x27;disp_y&#x27;
    boundary = &#x27;top_half_top bottom_half_bottom&#x27;
    value = 0
  []
  [xfix]
    type = DirichletBC
    variable = &#x27;disp_x&#x27;
    boundary = &#x27;bottom_half_bottom&#x27;
    value = 0
  []
[]

[Materials]
  [bulk]
    type = ADGenericConstantMaterial
    prop_names = &#x27;K G&#x27;
    prop_values = &#x27;${K} ${G}&#x27;
  []
  [degradation]
    type = PowerDegradationFunction
    property_name = g
    expression = (1-d)^p*(1-eta)+eta
    phase_field = d
    parameter_names = &#x27;p eta &#x27;
    parameter_values = &#x27;2 1e-6&#x27;
  []
  [strain]
    type = ADComputeSmallStrain
  []
  [elasticity]
    type = SmallDeformationIsotropicElasticity
    bulk_modulus = K
    shear_modulus = G
    phase_field = d
    degradation_function = g
    decomposition = SPECTRAL
    output_properties = &#x27;elastic_strain psie_active&#x27;
    outputs = exodus
  []
  [stress]
    type = ComputeSmallDeformationStress
    elasticity_model = elasticity
    output_properties = &#x27;stress&#x27;
    outputs = exodus
  []
[]

[Postprocessors]
  [Fx]
    type = NodalSum
    variable = fx
    boundary = top_half_top
  []
[]

[Executioner]
  type = Transient

  solve_type = NEWTON
  petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
  petsc_options_value = &#x27;lu       superlu_dist                 &#x27;
  automatic_scaling = true

  nl_rel_tol = 1e-8
  nl_abs_tol = 1e-10

  dt = 2e-5
  end_time = 2e-2

  fixed_point_max_its = 20
  accept_on_max_fixed_point_iteration = true
  fixed_point_rel_tol = 1e-8
  fixed_point_abs_tol = 1e-10
[]

[Outputs]
  exodus = true
  print_linear_residuals = false
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="f20f842a-febe-4bbe-a88a-cd7e02180355"><div class="modal-content"><h4>(test/tests/nucleation_models/klr.i)</h4><pre style="max-height:350px;"><code class="language-moose">[Mesh]
  [gen]
    type = GeneratedMeshGenerator
    dim = 2
    nx = ${nx}
    ny = ${ny}
    xmax = 30
    ymin = -5
    ymax = 5
  []
[]

[Adaptivity]
  marker = marker
  initial_marker = marker
  initial_steps = ${refine}
  stop_time = 0
  max_h_level = ${refine}
  [Markers]
    [marker]
      type = BoxMarker
      bottom_left = &#x27;0 -0.7 0&#x27;
      top_right = &#x27;30 0.7 0&#x27;
      outside = DO_NOTHING
      inside = REFINE
    []
  []
[]

[Variables]
  [d]
    [InitialCondition]
      type = FunctionIC
      function = &#x27;if(y=0&amp;x&gt;=0&amp;x&lt;=5,1,0)&#x27;
    []
  []
[]

[AuxVariables]
  [bounds_dummy]
  []
  [disp_x]
  []
  [disp_y]
  []
  [strain_zz]
  []
  [psie_active]
    order = CONSTANT
    family = MONOMIAL
  []
  [ce]
    order = CONSTANT
    family = MONOMIAL
  []
[]

[Bounds]
  [conditional]
    type = ConditionalBoundsAux
    variable = bounds_dummy
    bounded_variable = d
    fixed_bound_value = 0
    threshold_value = 0.95
  []
  [upper]
    type = ConstantBounds
    variable = bounds_dummy
    bounded_variable = d
    bound_type = upper
    bound_value = 1
  []
[]

[AuxKernels]
  [get_ce]
    type = ADMaterialRealAux
    variable = ce
    property = ce
  []
[]

[Kernels]
  [diff]
    type = ADPFFDiffusion
    variable = d
    fracture_toughness = Gc
    regularization_length = l
    normalization_constant = c0
  []
  [source]
    type = ADPFFSource
    variable = d
    free_energy = psi
  []
  [nuc_force]
    type = ADCoefMatSource
    variable = d
    prop_names = &#x27;ce&#x27;
  []
[]

[Materials]
  [fracture_properties]
    type = ADGenericConstantMaterial
    prop_names = &#x27;E K G lambda Gc l sigma_ts sigma_cs delta&#x27;
    prop_values = &#x27;${E} ${K} ${G} ${Lambda} ${Gc} ${l} ${sigma_ts} ${sigma_cs} ${delta}&#x27;
  []
  [degradation]
    type = PowerDegradationFunction
    property_name = g
    expression = (1-d)^p*(1-eta)+eta
    phase_field = d
    parameter_names = &#x27;p eta &#x27;
    parameter_values = &#x27;2 0&#x27;
  []
  [crack_geometric]
    type = CrackGeometricFunction
    property_name = alpha
    expression = &#x27;d&#x27;
    phase_field = d
  []
  [psi]
    type = ADDerivativeParsedMaterial
    property_name = psi
    expression = &#x27;g*psie_active+(Gc/c0/l)*alpha&#x27;
    coupled_variables = &#x27;d psie_active&#x27;
    material_property_names = &#x27;alpha(d) g(d) Gc c0 l&#x27;
    derivative_order = 1
  []
  [kumar_material]
    type = KLRNucleationMicroForce
    phase_field = d
    normalization_constant = c0
    tensile_strength = sigma_ts
    compressive_strength = sigma_cs
    delta = delta
    external_driving_force_name = ce
  []
  [strain]
    type = ADComputePlaneSmallStrain
    out_of_plane_strain = &#x27;strain_zz&#x27;
    displacements = &#x27;disp_x disp_y&#x27;
  []
  [elasticity]
    type = SmallDeformationIsotropicElasticity
    bulk_modulus = K
    shear_modulus = G
    phase_field = d
    degradation_function = g
    decomposition = NONE
  []
  [stress]
    type = ComputeSmallDeformationStress
    elasticity_model = elasticity
  []
[]

[Executioner]
  type = Transient

  solve_type = NEWTON
  petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package -snes_type&#x27;
  petsc_options_value = &#x27;lu       superlu_dist                  vinewtonrsls&#x27;
  automatic_scaling = true

  nl_rel_tol = 1e-8
  nl_abs_tol = 1e-10
[]

[Outputs]
  print_linear_residuals = false
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="5816aa43-dce5-4a1b-814a-b318fedaf698"><div class="modal-content"><h4>(tutorials/small_deformation/elastoplasticity.i)</h4><pre style="max-height:350px;"><code class="language-moose">E = 2.1e5
nu = 0.3
K = &#x27;${fparse E/3/(1-2*nu)}&#x27;
G = &#x27;${fparse E/2/(1+nu)}&#x27;
sigma_y = 50
n = 5
ep0 = 0.001

[GlobalParams]
  displacements = &#x27;disp_x disp_y&#x27;
  volumetric_locking_correction = true
[]

[Mesh]
  [gen]
    type = GeneratedMeshGenerator
    dim = 2
    nx = 30
    ny = 15
    ymax = 0.5
  []
  [noncrack]
    type = BoundingBoxNodeSetGenerator
    input = gen
    new_boundary = noncrack
    bottom_left = &#x27;0.5 0 0&#x27;
    top_right = &#x27;1 0 0&#x27;
  []
  construct_side_list_from_node_list = true
[]

[Variables]
  [disp_x]
  []
  [disp_y]
  []
[]

[AuxVariables]
  [fy]
  []
  [d]
  []
[]

[Kernels]
  [solid_x]
    type = ADStressDivergenceTensors
    variable = disp_x
    component = 0
  []
  [solid_y]
    type = ADStressDivergenceTensors
    variable = disp_y
    component = 1
    save_in = fy
  []
[]

[BCs]
  [ydisp]
    type = FunctionDirichletBC
    variable = disp_y
    boundary = top
    function = &#x27;t&#x27;
  []
  [yfix]
    type = DirichletBC
    variable = disp_y
    boundary = noncrack
    value = 0
  []
  [xfix]
    type = DirichletBC
    variable = disp_x
    boundary = top
    value = 0
  []
[]

[Materials]
  [bulk]
    type = ADGenericConstantMaterial
    prop_names = &#x27;K G&#x27;
    prop_values = &#x27;${K} ${G}&#x27;
  []
  [no_degradation]
    type = NoDegradation
    property_name = g
    expression = 1
    phase_field = d
  []
  [strain]
    type = ADComputeSmallStrain
  []
  [elasticity]
    type = SmallDeformationIsotropicElasticity
    bulk_modulus = K
    shear_modulus = G
    phase_field = d
    degradation_function = g
    output_properties = &#x27;elastic_strain&#x27;
    outputs = exodus
  []
  [hardening]
    type = PowerLawHardening
    yield_stress = ${sigma_y}
    exponent = ${n}
    reference_plastic_strain = ${ep0}
    phase_field = d
    degradation_function = g
  []
  [plasticity]
    type = SmallDeformationJ2Plasticity
    hardening_model = hardening
    output_properties = &#x27;effective_plastic_strain plastic_strain&#x27;
    outputs = exodus
  []
  [stress]
    type = ComputeSmallDeformationStress
    elasticity_model = elasticity
    plasticity_model = plasticity
    output_properties = &#x27;stress&#x27;
    outputs = exodus
  []
[]

[Postprocessors]
  [Fy]
    type = NodalSum
    variable = fy
    boundary = top
  []
[]

[Executioner]
  type = Transient

  solve_type = NEWTON
  petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
  petsc_options_value = &#x27;lu       superlu_dist                 &#x27;
  automatic_scaling = true

  nl_rel_tol = 1e-8
  nl_abs_tol = 1e-10

  dt = 1e-5
  end_time = 1e-3
[]

[Outputs]
  exodus = true
  print_linear_residuals = false
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="3aeffdbf-717a-4712-9302-0dd7160b66c3"><div class="modal-content"><h4>(tutorials/small_deformation/elasticity.i)</h4><pre style="max-height:350px;"><code class="language-moose">E = 2.1e5
nu = 0.3
K = &#x27;${fparse E/3/(1-2*nu)}&#x27;
G = &#x27;${fparse E/2/(1+nu)}&#x27;

[GlobalParams]
  displacements = &#x27;disp_x disp_y&#x27;
[]

[Mesh]
  [gen]
    type = GeneratedMeshGenerator
    dim = 2
    nx = 30
    ny = 15
    ymax = 0.5
  []
  [noncrack]
    type = BoundingBoxNodeSetGenerator
    input = gen
    new_boundary = noncrack
    bottom_left = &#x27;0.5 0 0&#x27;
    top_right = &#x27;1 0 0&#x27;
  []
  construct_side_list_from_node_list = true
[]

[Variables]
  [disp_x]
  []
  [disp_y]
  []
[]

[AuxVariables]
  [fy]
  []
  [d]
  []
[]

[Kernels]
  [solid_x]
    type = ADStressDivergenceTensors
    variable = disp_x
    component = 0
  []
  [solid_y]
    type = ADStressDivergenceTensors
    variable = disp_y
    component = 1
    save_in = fy
  []
[]

[BCs]
  [ydisp]
    type = FunctionDirichletBC
    variable = disp_y
    boundary = top
    function = &#x27;t&#x27;
  []
  [yfix]
    type = DirichletBC
    variable = disp_y
    boundary = noncrack
    value = 0
  []
  [xfix]
    type = DirichletBC
    variable = disp_x
    boundary = top
    value = 0
  []
[]

[Materials]
  [bulk]
    type = ADGenericConstantMaterial
    prop_names = &#x27;K G&#x27;
    prop_values = &#x27;${K} ${G}&#x27;
  []
  [no_degradation]
    type = NoDegradation
    property_name = g
    expression = 1
    phase_field = d
  []
  [strain]
    type = ADComputeSmallStrain
  []
  [elasticity]
    type = SmallDeformationIsotropicElasticity
    bulk_modulus = K
    shear_modulus = G
    phase_field = d
    degradation_function = g
    output_properties = &#x27;elastic_strain&#x27;
    outputs = exodus
  []
  [stress]
    type = ComputeSmallDeformationStress
    elasticity_model = elasticity
    output_properties = &#x27;stress&#x27;
    outputs = exodus
  []
[]

[Postprocessors]
  [Fy]
    type = NodalSum
    variable = fy
    boundary = top
  []
[]

[Executioner]
  type = Transient

  solve_type = NEWTON
  petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
  petsc_options_value = &#x27;lu       superlu_dist                 &#x27;
  automatic_scaling = true

  nl_rel_tol = 1e-8
  nl_abs_tol = 1e-10

  dt = 1e-5
  end_time = 1e-4
[]

[Outputs]
  exodus = true
  print_linear_residuals = false
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="a8d8347e-1326-4682-b98a-71a2b6e15854"><div class="modal-content"><h4>(tutorials/matrix_fiber/elasticity.i)</h4><pre style="max-height:350px;"><code class="language-moose">E = 4000
nu = 0.2
K = &#x27;${fparse E/3/(1-2*nu)}&#x27;
G = &#x27;${fparse E/2/(1+nu)}&#x27;
lambda = &#x27;${fparse K-2*G/3}&#x27;

Gc = 1
psic = 2.64
l = 0.02
k = 1e-6

v = &#x27;${fparse sqrt(Gc*3/lambda)}&#x27;

[GlobalParams]
  displacements = &#x27;disp_x disp_y&#x27;
[]

[MultiApps]
  [fracture]
    type = TransientMultiApp
    input_files = &#x27;fracture.i&#x27;
    cli_args = &#x27;Gc=${Gc};l=${l};psic=${psic};k=${k}&#x27;
    execute_on = &#x27;TIMESTEP_END&#x27;
  []
[]

[Transfers]
  [from_d]
    type = MultiAppCopyTransfer
    from_multi_app = &#x27;fracture&#x27;
    source_variable = d
    variable = d
  []
  [to_psie_active]
    type = MultiAppCopyTransfer
    to_multi_app = &#x27;fracture&#x27;
    variable = psie_active
    source_variable = psie_active
  []
[]

[Mesh]
  [fmg]
    type = FileMeshGenerator
    file = &#x27;gold/matrix.msh&#x27;
  []
[]

[Variables]
  [disp_x]
  []
  [disp_y]
  []
[]

[AuxVariables]
  [d]
  []
[]

[Kernels]
  [solid_x]
    type = ADStressDivergenceTensors
    variable = disp_x
    component = 0
  []
  [solid_y]
    type = ADStressDivergenceTensors
    variable = disp_y
    component = 1
  []
[]

[BCs]
  [forcing]
    type = FunctionDirichletBC
    variable = disp_y
    boundary = &#x27;top&#x27;
    function = &#x27;${v}*t&#x27;
    preset = false
  []
  [fixed_hole_x]
    type = DirichletBC
    variable = disp_x
    boundary = &#x27;hole&#x27;
    value = 0
  []
  [fixed_hole_y]
    type = DirichletBC
    variable = disp_y
    boundary = &#x27;hole&#x27;
    value = 0
  []
[]

[Materials]
  [bulk_properties]
    type = ADGenericConstantMaterial
    prop_names = &#x27;K G l Gc psic&#x27;
    prop_values = &#x27;${K} ${G} ${l} ${Gc} ${psic}&#x27;
  []
  [crack_geometric]
    type = CrackGeometricFunction
    property_name = alpha
    expression = d
    phase_field = d
  []
  [degradation]
    type = RationalDegradationFunction
    property_name = g
    phase_field = d
    parameter_names = &#x27;p a2 a3 eta &#x27;
    parameter_values = &#x27;2 1 0 ${k}&#x27;
    material_property_names = &#x27;Gc psic xi c0 l &#x27;
  []
  [elasticity]
    type = SmallDeformationIsotropicElasticity
    bulk_modulus = K
    shear_modulus = G
    phase_field = d
    degradation_function = g
    decomposition = VOLDEV
    output_properties = &#x27;psie_active&#x27;
    outputs = exodus
  []
  [strain]
    type = ADComputeSmallStrain
  []
  [stress]
    type = ComputeSmallDeformationStress
    elasticity_model = elasticity
    output_properties = &#x27;stress&#x27;
    outputs = exodus
  []
[]

[Executioner]
  type = Transient
  solve_type = &#x27;NEWTON&#x27;
  petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
  petsc_options_value = &#x27;lu       superlu_dist&#x27;
  dt = 0.01
  end_time = 3
  nl_abs_tol = 1e-08
  nl_rel_tol = 1e-06
  automatic_scaling = true
[]

[Outputs]
  exodus = true
  print_linear_residuals = false
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="1647b738-bc7a-466f-99b3-91476564fe2a"><div class="modal-content"><h4>(tutorials/surfing_boundary_problem/fracture.i)</h4><pre style="max-height:350px;"><code class="language-moose">[Mesh]
  [gen]
    type = GeneratedMeshGenerator
    dim = 2
    nx = ${nx}
    ny = ${ny}
    xmax = 30
    ymin = -5
    ymax = 5
  []
[]

[Adaptivity]
  marker = marker
  initial_marker = marker
  initial_steps = ${refine}
  stop_time = 0
  max_h_level = ${refine}
  [Markers]
    [marker]
      type = BoxMarker
      bottom_left = &#x27;0 -0.7 0&#x27;
      top_right = &#x27;30 0.7 0&#x27;
      outside = DO_NOTHING
      inside = REFINE
    []
  []
[]

[Variables]
  [d]
    [InitialCondition]
      type = FunctionIC
      function = &#x27;if(y=0&amp;x&gt;=0&amp;x&lt;=5,${initd},0)&#x27;
    []
  []
[]

[AuxVariables]
  [bounds_dummy]
  []
  [disp_x]
  []
  [disp_y]
  []
  [strain_zz]
  []
  [psie_active]
    order = CONSTANT
    family = MONOMIAL
  []
[]

[Bounds]
  [conditional]
    type = ConditionalBoundsAux
    variable = bounds_dummy
    bounded_variable = d
    fixed_bound_value = 0.0
    threshold_value = 0.95
  []
  [upper]
    type = ConstantBounds
    variable = bounds_dummy
    bounded_variable = d
    bound_type = upper
    bound_value = 1
  []
[]

[Kernels]
  [diff]
    type = ADPFFDiffusion
    variable = d
    fracture_toughness = Gc_delta
    regularization_length = l
    normalization_constant = c0
  []
  [source]
    type = ADPFFSource
    variable = d
    free_energy = psi
  []
  [nuc_force]
    type = ADCoefMatSource
    variable = d
    prop_names = &#x27;ce&#x27;
    coefficient = 1.0
  []
[]

[Materials]
  [fracture_properties]
    type = ADGenericConstantMaterial
    prop_names = &#x27;E K G lambda Gc l sigma_ts sigma_hs&#x27;
    prop_values = &#x27;${E} ${K} ${G} ${Lambda} ${Gc} ${l} ${sigma_ts} ${sigma_hs}&#x27;
  []
  [degradation]
    type = PowerDegradationFunction
    property_name = g
    expression = (1-d)^p*(1-eta)+eta
    phase_field = d
    parameter_names = &#x27;p eta &#x27;
    parameter_values = &#x27;2 0&#x27;
  []
  [crack_geometric]
    type = CrackGeometricFunction
    property_name = alpha
    expression = &#x27;d&#x27;
    phase_field = d
  []
  [psi]
    type = ADDerivativeParsedMaterial
    property_name = psi
    expression = &#x27;g*psie_active+(Gc*delta/c0/l)*alpha&#x27;
    coupled_variables = &#x27;d psie_active&#x27;
    material_property_names = &#x27;delta alpha(d) g(d) Gc c0 l&#x27;
    derivative_order = 1
  []
  [nucleation_micro_force]
    type = LDLNucleationMicroForce
    phase_field = d
    degradation_function = g
    regularization_length = l
    normalization_constant = c0
    fracture_toughness = Gc
    tensile_strength = sigma_ts
    hydrostatic_strength = sigma_hs
    delta = delta
    h_correction = true
    external_driving_force_name = ce
  []
  [strain]
    type = ADComputePlaneSmallStrain
    out_of_plane_strain = &#x27;strain_zz&#x27;
    displacements = &#x27;disp_x disp_y&#x27;
  []
  [elasticity]
    type = SmallDeformationIsotropicElasticity
    bulk_modulus = K
    shear_modulus = G
    phase_field = d
    degradation_function = g
    decomposition = NONE
  []
  [stress]
    type = ComputeSmallDeformationStress
    elasticity_model = elasticity
  []
  [Gc_delta]
    type = ADParsedMaterial
    property_name = Gc_delta
    expression = &#x27;Gc*delta&#x27;
    material_property_names = &#x27;Gc delta&#x27;
  []
[]

[Executioner]
  type = Transient

  solve_type = NEWTON
  petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package -snes_type&#x27;
  petsc_options_value = &#x27;lu       superlu_dist                  vinewtonrsls&#x27;
  automatic_scaling = true

  nl_rel_tol = 1e-8
  nl_abs_tol = 1e-10
[]

[Outputs]
  print_linear_residuals = false
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div></div></div></div></main></div></body><script type="text/javascript" src="../../../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../../../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../../../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../../../js/init.js"></script><script type="text/javascript" src="../../../js/navigation.js"></script><script type="text/javascript" src="https://cse.google.com/cse.js?cx=008852834041008754713:g3ilnhhbbj9"></script><script type="text/javascript" src="../../../js/sqa_moose.js"></script>