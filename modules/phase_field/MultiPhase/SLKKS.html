<!DOCTYPE html><head><meta charset="UTF-8"><title>Sublattice KKS model | RACCOON</title><link rel="icon" type="image/x-icon" href="../../../media/raccoon_icon.png" sizes="16x16 32x32 64x64 128x128"></link><link href="../../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/devel_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/civet_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../contrib/katex/katex.min.css" type="text/css" rel="stylesheet"></link><link href="../../../css/katex_moose.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../../../contrib/jquery/jquery.min.js"></script><script type="text/javascript" src="../../../contrib/katex/katex.min.js"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="../../../index.html" class="left moose-logo hide-on-med-and-down" id="home-button">RACCOON</a><a href="https://github.com/hugary1995/raccoon" class="right"><img src="../../../media/framework/github-logo.png" alt="GitHub wordmark" class="github-mark"></img><img src="../../../media/framework/github-mark.png" alt="GitHub logo" class="github-logo"></img></a><ul class="right hide-on-med-and-down"><li><a href="#!" class="dropdown-trigger" data-target="a43722b0-4586-48ce-a0f1-bd733df3aee2" data-constrainWidth="false">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="721d2cbc-3bb0-476a-b480-2e7bcd04ff20" data-constrainWidth="false">Tutorials<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="584fcff3-8095-4488-8731-5a32678ee277" data-constrainWidth="false">Theory<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="d7e7f45f-fee6-4d88-8cf0-d724b4141b7d" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="../../../contribute/index.html">Contribute</a></li></ul><a href="#" class="sidenav-trigger" data-target="84292866-e362-4101-a1f2-fa0fa6c940a9"><i class="material-icons">menu</i></a><ul class="sidenav" id="84292866-e362-4101-a1f2-fa0fa6c940a9"><li><a href="#!" class="dropdown-trigger" data-target="3f1b0b04-d004-4c13-b506-97bff7522900" data-constrainWidth="false">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="48cee49d-37fc-4f68-a44d-9972ac3f8db5" data-constrainWidth="false">Tutorials<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="da473f34-763a-414d-8972-13767fc62770" data-constrainWidth="false">Theory<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="9fe88783-10c2-431a-9439-69279121b13f" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="../../../contribute/index.html">Contribute</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div><ul class="dropdown-content" id="a43722b0-4586-48ce-a0f1-bd733df3aee2"><li><a href="../../../getting_started/install.html">Install RACCOON</a></li><li><a href="../../../getting_started/update.html">Update RACCOON</a></li><li><a href="../../../getting_started/running.html">Running your first model</a></li><li><a href="../../../getting_started/paraview.html">Visualization</a></li><li><a href="../../../getting_started/ide.html">Code development</a></li><li><a href="../../../getting_started/docs.html">Browse the documentation locally</a></li></ul><ul class="dropdown-content" id="721d2cbc-3bb0-476a-b480-2e7bcd04ff20"><li><a href="../../../tutorials/01_small_deformation_elasticity.html">1. Small deformation</a></li><li><a href="../../../tutorials/02_mode1_brittle_fracture.html">2. Mode-I fracture</a></li><li><a href="../../../tutorials/03_mode2_brittle_fracture.html">3. Mode-II fracture</a></li><li><a href="../../../tutorials/04_fiber_reinforced_matrix.html">4. Fiber-reinforced matrix</a></li><li><a href="../../../tutorials/05_soil_desiccation.html">5. Soil desiccation</a></li><li><a href="../../../tutorials/06_large_deformation_elasticity.html">6. Large deformation</a></li><li><a href="../../../tutorials/07_elastoplasticity.html">7. Elastoplasticity</a></li><li><a href="../../../tutorials/08_ductile_fracture.html">8. Ductile fracture</a></li><li><a href="../../../tutorials/09_three_point_bending.html">9. Three-point bending</a></li><li><a href="../../../tutorials/10_quenching_bibeam.html">10. Quenching of bi-beam</a></li><li><a href="../../../tutorials/11_adaptivity.html">11. Adaptive mesh refinement</a></li><li><a href="../../../tutorials/12_nucleation.html">12. Crack nucleation</a></li><li><a href="../../../tutorials/13_traction_separation.html">13. Traction separation law</a></li><li><a href="../../../tutorials/14_klexpansion.html">14. Random field generation</a></li><li><a href="../../../tutorials/15_mosaic_patches.html">15. Mosaic field generation</a></li></ul><ul class="dropdown-content" id="584fcff3-8095-4488-8731-5a32678ee277"><li><a href="../../../theory/intro.html">Introduction</a></li><li><a href="../../../theory/kinematics.html">State variables and kinematics</a></li><li><a href="../../../theory/thermodynamics.html">Thermodynamics</a></li><li><a href="../../../theory/minimization.html">The minimization problem</a></li><li><a href="../../../theory/constitutive_models.html">Constitutive Models</a></li></ul><ul class="dropdown-content" id="d7e7f45f-fee6-4d88-8cf0-d724b4141b7d"><li><a href="../../index.html">Physics modules</a></li><li><a href="../../../syntax/index.html">Complete syntax</a></li><li><a href="../../../syntax/raccoon.html">RACCOON syntax</a></li><li><a href="../../../syntax/solid_mechanics.html">Solid mechanics syntax</a></li><li><a href="../../../syntax/phase_field.html">Phase field syntax</a></li><li><a href="../../../syntax/heat_transfer.html">Heat conduction syntax</a></li></ul><ul class="dropdown-content" id="3f1b0b04-d004-4c13-b506-97bff7522900"><li><a href="../../../getting_started/install.html">Install RACCOON</a></li><li><a href="../../../getting_started/update.html">Update RACCOON</a></li><li><a href="../../../getting_started/running.html">Running your first model</a></li><li><a href="../../../getting_started/paraview.html">Visualization</a></li><li><a href="../../../getting_started/ide.html">Code development</a></li><li><a href="../../../getting_started/docs.html">Browse the documentation locally</a></li></ul><ul class="dropdown-content" id="48cee49d-37fc-4f68-a44d-9972ac3f8db5"><li><a href="../../../tutorials/01_small_deformation_elasticity.html">1. Small deformation</a></li><li><a href="../../../tutorials/02_mode1_brittle_fracture.html">2. Mode-I fracture</a></li><li><a href="../../../tutorials/03_mode2_brittle_fracture.html">3. Mode-II fracture</a></li><li><a href="../../../tutorials/04_fiber_reinforced_matrix.html">4. Fiber-reinforced matrix</a></li><li><a href="../../../tutorials/05_soil_desiccation.html">5. Soil desiccation</a></li><li><a href="../../../tutorials/06_large_deformation_elasticity.html">6. Large deformation</a></li><li><a href="../../../tutorials/07_elastoplasticity.html">7. Elastoplasticity</a></li><li><a href="../../../tutorials/08_ductile_fracture.html">8. Ductile fracture</a></li><li><a href="../../../tutorials/09_three_point_bending.html">9. Three-point bending</a></li><li><a href="../../../tutorials/10_quenching_bibeam.html">10. Quenching of bi-beam</a></li><li><a href="../../../tutorials/11_adaptivity.html">11. Adaptive mesh refinement</a></li><li><a href="../../../tutorials/12_nucleation.html">12. Crack nucleation</a></li><li><a href="../../../tutorials/13_traction_separation.html">13. Traction separation law</a></li><li><a href="../../../tutorials/14_klexpansion.html">14. Random field generation</a></li><li><a href="../../../tutorials/15_mosaic_patches.html">15. Mosaic field generation</a></li></ul><ul class="dropdown-content" id="da473f34-763a-414d-8972-13767fc62770"><li><a href="../../../theory/intro.html">Introduction</a></li><li><a href="../../../theory/kinematics.html">State variables and kinematics</a></li><li><a href="../../../theory/thermodynamics.html">Thermodynamics</a></li><li><a href="../../../theory/minimization.html">The minimization problem</a></li><li><a href="../../../theory/constitutive_models.html">Constitutive Models</a></li></ul><ul class="dropdown-content" id="9fe88783-10c2-431a-9439-69279121b13f"><li><a href="../../index.html">Physics modules</a></li><li><a href="../../../syntax/index.html">Complete syntax</a></li><li><a href="../../../syntax/raccoon.html">RACCOON syntax</a></li><li><a href="../../../syntax/solid_mechanics.html">Solid mechanics syntax</a></li><li><a href="../../../syntax/phase_field.html">Phase field syntax</a></li><li><a href="../../../syntax/heat_transfer.html">Heat conduction syntax</a></li></ul></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="gcse-search"></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="moose-content col s12 m12 l12"><section id="349e8b07-9c9a-4779-bcde-b137efb42d22" data-section-level="1" data-section-text="Sublattice KKS model"><h1 id="sublattice-kks-model">Sublattice KKS model</h1><p>The sublattice Kim-Kim-Suzuki (SLKKS) <a href="#Schwen2021">Schwen et al. (2021)</a> model is an extension of the original KKS model incorporating an additional equal chemical potential constraint among the sublattice concentration in each phase.</p><p>As such each component in the system will have corresponding phase concentrations, which are split up into per-sublattice concentrations.</p><p><span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-724e36c4-e1e5-4b04-8507-0de5f78a3da5"></span><script>var element = document.getElementById("moose-equation-724e36c4-e1e5-4b04-8507-0de5f78a3da5");katex.render("c_i = \\sum_j h(\\eta_j)\\sum_k a_{jk} c_{ijk},", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\grad":"\\bs{\\nabla}","\\divergence":"\\grad \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\abs":"\\left\\lvert#1\\right\\rvert","\\tr":"\\text{tr}","\\dev":"\\text{dev}","\\sym":"\\text{sym}","\\diff":"\\text{ d}#1","\\activepart":"{\\left< A \\right>}","\\inactivepart":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\ep":"{\\varepsilon^p}","\\ep0":"{\\varepsilon_0^p}","\\epdot":"{\\dot{\\varepsilon}}^p","\\epdot0":"{\\dot{\\varepsilon}}_0^p","\\bfa":"\\boldsymbol{a}","\\bfb":"\\boldsymbol{b}","\\bfc":"\\boldsymbol{c}","\\bfd":"\\boldsymbol{d}","\\bfe":"\\boldsymbol{e}","\\bff":"\\boldsymbol{f}","\\bfg":"\\boldsymbol{g}","\\bfh":"\\boldsymbol{h}","\\bfi":"\\boldsymbol{i}","\\bfj":"\\boldsymbol{j}","\\bfk":"\\boldsymbol{k}","\\bfl":"\\boldsymbol{l}","\\bfm":"\\boldsymbol{m}","\\bfn":"\\boldsymbol{n}","\\bfo":"\\boldsymbol{o}","\\bfp":"\\boldsymbol{p}","\\bfq":"\\boldsymbol{q}","\\bfr":"\\boldsymbol{r}","\\bfs":"\\boldsymbol{s}","\\bft":"\\boldsymbol{t}","\\bfu":"\\boldsymbol{u}","\\bfv":"\\boldsymbol{v}","\\bfw":"\\boldsymbol{w}","\\bfx":"\\boldsymbol{x}","\\bfy":"\\boldsymbol{y}","\\bfz":"\\boldsymbol{z}","\\bfA":"\\boldsymbol{A}","\\bfB":"\\boldsymbol{B}","\\bfC":"\\boldsymbol{C}","\\bfD":"\\boldsymbol{D}","\\bfE":"\\boldsymbol{E}","\\bfF":"\\boldsymbol{F}","\\bfG":"\\boldsymbol{G}","\\bfH":"\\boldsymbol{H}","\\bfI":"\\boldsymbol{I}","\\bfJ":"\\boldsymbol{J}","\\bfK":"\\boldsymbol{K}","\\bfL":"\\boldsymbol{L}","\\bfM":"\\boldsymbol{M}","\\bfN":"\\boldsymbol{N}","\\bfO":"\\boldsymbol{O}","\\bfP":"\\boldsymbol{P}","\\bfQ":"\\boldsymbol{Q}","\\bfR":"\\boldsymbol{R}","\\bfS":"\\boldsymbol{S}","\\bfT":"\\boldsymbol{T}","\\bfU":"\\boldsymbol{U}","\\bfV":"\\boldsymbol{V}","\\bfW":"\\boldsymbol{W}","\\bfX":"\\boldsymbol{X}","\\bfY":"\\boldsymbol{Y}","\\bfZ":"\\boldsymbol{Z}"}});</script></span></p><section id="6ef3a9aa-6b8a-4fad-a71d-8771a8192264" data-section-level="2" data-section-text="Nomenclature"><h2 id="nomenclature">Nomenclature</h2><p><span class="moose-katex-inline-equation" id="moose-equation-a64a534b-9d1e-4384-be8c-899a5bdfb80e"><script>var element = document.getElementById("moose-equation-a64a534b-9d1e-4384-be8c-899a5bdfb80e");katex.render("i", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\grad":"\\bs{\\nabla}","\\divergence":"\\grad \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\abs":"\\left\\lvert#1\\right\\rvert","\\tr":"\\text{tr}","\\dev":"\\text{dev}","\\sym":"\\text{sym}","\\diff":"\\text{ d}#1","\\activepart":"{\\left< A \\right>}","\\inactivepart":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\ep":"{\\varepsilon^p}","\\ep0":"{\\varepsilon_0^p}","\\epdot":"{\\dot{\\varepsilon}}^p","\\epdot0":"{\\dot{\\varepsilon}}_0^p","\\bfa":"\\boldsymbol{a}","\\bfb":"\\boldsymbol{b}","\\bfc":"\\boldsymbol{c}","\\bfd":"\\boldsymbol{d}","\\bfe":"\\boldsymbol{e}","\\bff":"\\boldsymbol{f}","\\bfg":"\\boldsymbol{g}","\\bfh":"\\boldsymbol{h}","\\bfi":"\\boldsymbol{i}","\\bfj":"\\boldsymbol{j}","\\bfk":"\\boldsymbol{k}","\\bfl":"\\boldsymbol{l}","\\bfm":"\\boldsymbol{m}","\\bfn":"\\boldsymbol{n}","\\bfo":"\\boldsymbol{o}","\\bfp":"\\boldsymbol{p}","\\bfq":"\\boldsymbol{q}","\\bfr":"\\boldsymbol{r}","\\bfs":"\\boldsymbol{s}","\\bft":"\\boldsymbol{t}","\\bfu":"\\boldsymbol{u}","\\bfv":"\\boldsymbol{v}","\\bfw":"\\boldsymbol{w}","\\bfx":"\\boldsymbol{x}","\\bfy":"\\boldsymbol{y}","\\bfz":"\\boldsymbol{z}","\\bfA":"\\boldsymbol{A}","\\bfB":"\\boldsymbol{B}","\\bfC":"\\boldsymbol{C}","\\bfD":"\\boldsymbol{D}","\\bfE":"\\boldsymbol{E}","\\bfF":"\\boldsymbol{F}","\\bfG":"\\boldsymbol{G}","\\bfH":"\\boldsymbol{H}","\\bfI":"\\boldsymbol{I}","\\bfJ":"\\boldsymbol{J}","\\bfK":"\\boldsymbol{K}","\\bfL":"\\boldsymbol{L}","\\bfM":"\\boldsymbol{M}","\\bfN":"\\boldsymbol{N}","\\bfO":"\\boldsymbol{O}","\\bfP":"\\boldsymbol{P}","\\bfQ":"\\boldsymbol{Q}","\\bfR":"\\boldsymbol{R}","\\bfS":"\\boldsymbol{S}","\\bfT":"\\boldsymbol{T}","\\bfU":"\\boldsymbol{U}","\\bfV":"\\boldsymbol{V}","\\bfW":"\\boldsymbol{W}","\\bfX":"\\boldsymbol{X}","\\bfY":"\\boldsymbol{Y}","\\bfZ":"\\boldsymbol{Z}"}});</script></span> indexes a component, <span class="moose-katex-inline-equation" id="moose-equation-a3e8ca24-1203-4bec-a48f-a3f9e81b45d6"><script>var element = document.getElementById("moose-equation-a3e8ca24-1203-4bec-a48f-a3f9e81b45d6");katex.render("j", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\grad":"\\bs{\\nabla}","\\divergence":"\\grad \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\abs":"\\left\\lvert#1\\right\\rvert","\\tr":"\\text{tr}","\\dev":"\\text{dev}","\\sym":"\\text{sym}","\\diff":"\\text{ d}#1","\\activepart":"{\\left< A \\right>}","\\inactivepart":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\ep":"{\\varepsilon^p}","\\ep0":"{\\varepsilon_0^p}","\\epdot":"{\\dot{\\varepsilon}}^p","\\epdot0":"{\\dot{\\varepsilon}}_0^p","\\bfa":"\\boldsymbol{a}","\\bfb":"\\boldsymbol{b}","\\bfc":"\\boldsymbol{c}","\\bfd":"\\boldsymbol{d}","\\bfe":"\\boldsymbol{e}","\\bff":"\\boldsymbol{f}","\\bfg":"\\boldsymbol{g}","\\bfh":"\\boldsymbol{h}","\\bfi":"\\boldsymbol{i}","\\bfj":"\\boldsymbol{j}","\\bfk":"\\boldsymbol{k}","\\bfl":"\\boldsymbol{l}","\\bfm":"\\boldsymbol{m}","\\bfn":"\\boldsymbol{n}","\\bfo":"\\boldsymbol{o}","\\bfp":"\\boldsymbol{p}","\\bfq":"\\boldsymbol{q}","\\bfr":"\\boldsymbol{r}","\\bfs":"\\boldsymbol{s}","\\bft":"\\boldsymbol{t}","\\bfu":"\\boldsymbol{u}","\\bfv":"\\boldsymbol{v}","\\bfw":"\\boldsymbol{w}","\\bfx":"\\boldsymbol{x}","\\bfy":"\\boldsymbol{y}","\\bfz":"\\boldsymbol{z}","\\bfA":"\\boldsymbol{A}","\\bfB":"\\boldsymbol{B}","\\bfC":"\\boldsymbol{C}","\\bfD":"\\boldsymbol{D}","\\bfE":"\\boldsymbol{E}","\\bfF":"\\boldsymbol{F}","\\bfG":"\\boldsymbol{G}","\\bfH":"\\boldsymbol{H}","\\bfI":"\\boldsymbol{I}","\\bfJ":"\\boldsymbol{J}","\\bfK":"\\boldsymbol{K}","\\bfL":"\\boldsymbol{L}","\\bfM":"\\boldsymbol{M}","\\bfN":"\\boldsymbol{N}","\\bfO":"\\boldsymbol{O}","\\bfP":"\\boldsymbol{P}","\\bfQ":"\\boldsymbol{Q}","\\bfR":"\\boldsymbol{R}","\\bfS":"\\boldsymbol{S}","\\bfT":"\\boldsymbol{T}","\\bfU":"\\boldsymbol{U}","\\bfV":"\\boldsymbol{V}","\\bfW":"\\boldsymbol{W}","\\bfX":"\\boldsymbol{X}","\\bfY":"\\boldsymbol{Y}","\\bfZ":"\\boldsymbol{Z}"}});</script></span> a phase, and <span class="moose-katex-inline-equation" id="moose-equation-690884c5-31f2-4e80-81be-8f1f964a897c"><script>var element = document.getElementById("moose-equation-690884c5-31f2-4e80-81be-8f1f964a897c");katex.render("k", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\grad":"\\bs{\\nabla}","\\divergence":"\\grad \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\abs":"\\left\\lvert#1\\right\\rvert","\\tr":"\\text{tr}","\\dev":"\\text{dev}","\\sym":"\\text{sym}","\\diff":"\\text{ d}#1","\\activepart":"{\\left< A \\right>}","\\inactivepart":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\ep":"{\\varepsilon^p}","\\ep0":"{\\varepsilon_0^p}","\\epdot":"{\\dot{\\varepsilon}}^p","\\epdot0":"{\\dot{\\varepsilon}}_0^p","\\bfa":"\\boldsymbol{a}","\\bfb":"\\boldsymbol{b}","\\bfc":"\\boldsymbol{c}","\\bfd":"\\boldsymbol{d}","\\bfe":"\\boldsymbol{e}","\\bff":"\\boldsymbol{f}","\\bfg":"\\boldsymbol{g}","\\bfh":"\\boldsymbol{h}","\\bfi":"\\boldsymbol{i}","\\bfj":"\\boldsymbol{j}","\\bfk":"\\boldsymbol{k}","\\bfl":"\\boldsymbol{l}","\\bfm":"\\boldsymbol{m}","\\bfn":"\\boldsymbol{n}","\\bfo":"\\boldsymbol{o}","\\bfp":"\\boldsymbol{p}","\\bfq":"\\boldsymbol{q}","\\bfr":"\\boldsymbol{r}","\\bfs":"\\boldsymbol{s}","\\bft":"\\boldsymbol{t}","\\bfu":"\\boldsymbol{u}","\\bfv":"\\boldsymbol{v}","\\bfw":"\\boldsymbol{w}","\\bfx":"\\boldsymbol{x}","\\bfy":"\\boldsymbol{y}","\\bfz":"\\boldsymbol{z}","\\bfA":"\\boldsymbol{A}","\\bfB":"\\boldsymbol{B}","\\bfC":"\\boldsymbol{C}","\\bfD":"\\boldsymbol{D}","\\bfE":"\\boldsymbol{E}","\\bfF":"\\boldsymbol{F}","\\bfG":"\\boldsymbol{G}","\\bfH":"\\boldsymbol{H}","\\bfI":"\\boldsymbol{I}","\\bfJ":"\\boldsymbol{J}","\\bfK":"\\boldsymbol{K}","\\bfL":"\\boldsymbol{L}","\\bfM":"\\boldsymbol{M}","\\bfN":"\\boldsymbol{N}","\\bfO":"\\boldsymbol{O}","\\bfP":"\\boldsymbol{P}","\\bfQ":"\\boldsymbol{Q}","\\bfR":"\\boldsymbol{R}","\\bfS":"\\boldsymbol{S}","\\bfT":"\\boldsymbol{T}","\\bfU":"\\boldsymbol{U}","\\bfV":"\\boldsymbol{V}","\\bfW":"\\boldsymbol{W}","\\bfX":"\\boldsymbol{X}","\\bfY":"\\boldsymbol{Y}","\\bfZ":"\\boldsymbol{Z}"}});</script></span> a sublattice in the given phase. <span class="moose-katex-inline-equation" id="moose-equation-23a72a2a-325e-4710-9890-51f85e693a9c"><script>var element = document.getElementById("moose-equation-23a72a2a-325e-4710-9890-51f85e693a9c");katex.render("a_{jk}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\grad":"\\bs{\\nabla}","\\divergence":"\\grad \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\abs":"\\left\\lvert#1\\right\\rvert","\\tr":"\\text{tr}","\\dev":"\\text{dev}","\\sym":"\\text{sym}","\\diff":"\\text{ d}#1","\\activepart":"{\\left< A \\right>}","\\inactivepart":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\ep":"{\\varepsilon^p}","\\ep0":"{\\varepsilon_0^p}","\\epdot":"{\\dot{\\varepsilon}}^p","\\epdot0":"{\\dot{\\varepsilon}}_0^p","\\bfa":"\\boldsymbol{a}","\\bfb":"\\boldsymbol{b}","\\bfc":"\\boldsymbol{c}","\\bfd":"\\boldsymbol{d}","\\bfe":"\\boldsymbol{e}","\\bff":"\\boldsymbol{f}","\\bfg":"\\boldsymbol{g}","\\bfh":"\\boldsymbol{h}","\\bfi":"\\boldsymbol{i}","\\bfj":"\\boldsymbol{j}","\\bfk":"\\boldsymbol{k}","\\bfl":"\\boldsymbol{l}","\\bfm":"\\boldsymbol{m}","\\bfn":"\\boldsymbol{n}","\\bfo":"\\boldsymbol{o}","\\bfp":"\\boldsymbol{p}","\\bfq":"\\boldsymbol{q}","\\bfr":"\\boldsymbol{r}","\\bfs":"\\boldsymbol{s}","\\bft":"\\boldsymbol{t}","\\bfu":"\\boldsymbol{u}","\\bfv":"\\boldsymbol{v}","\\bfw":"\\boldsymbol{w}","\\bfx":"\\boldsymbol{x}","\\bfy":"\\boldsymbol{y}","\\bfz":"\\boldsymbol{z}","\\bfA":"\\boldsymbol{A}","\\bfB":"\\boldsymbol{B}","\\bfC":"\\boldsymbol{C}","\\bfD":"\\boldsymbol{D}","\\bfE":"\\boldsymbol{E}","\\bfF":"\\boldsymbol{F}","\\bfG":"\\boldsymbol{G}","\\bfH":"\\boldsymbol{H}","\\bfI":"\\boldsymbol{I}","\\bfJ":"\\boldsymbol{J}","\\bfK":"\\boldsymbol{K}","\\bfL":"\\boldsymbol{L}","\\bfM":"\\boldsymbol{M}","\\bfN":"\\boldsymbol{N}","\\bfO":"\\boldsymbol{O}","\\bfP":"\\boldsymbol{P}","\\bfQ":"\\boldsymbol{Q}","\\bfR":"\\boldsymbol{R}","\\bfS":"\\boldsymbol{S}","\\bfT":"\\boldsymbol{T}","\\bfU":"\\boldsymbol{U}","\\bfV":"\\boldsymbol{V}","\\bfW":"\\boldsymbol{W}","\\bfX":"\\boldsymbol{X}","\\bfY":"\\boldsymbol{Y}","\\bfZ":"\\boldsymbol{Z}"}});</script></span> is the fraction of <span class="moose-katex-inline-equation" id="moose-equation-bf22df49-f486-4b63-82d7-8bd91e4d78f4"><script>var element = document.getElementById("moose-equation-bf22df49-f486-4b63-82d7-8bd91e4d78f4");katex.render("k", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\grad":"\\bs{\\nabla}","\\divergence":"\\grad \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\abs":"\\left\\lvert#1\\right\\rvert","\\tr":"\\text{tr}","\\dev":"\\text{dev}","\\sym":"\\text{sym}","\\diff":"\\text{ d}#1","\\activepart":"{\\left< A \\right>}","\\inactivepart":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\ep":"{\\varepsilon^p}","\\ep0":"{\\varepsilon_0^p}","\\epdot":"{\\dot{\\varepsilon}}^p","\\epdot0":"{\\dot{\\varepsilon}}_0^p","\\bfa":"\\boldsymbol{a}","\\bfb":"\\boldsymbol{b}","\\bfc":"\\boldsymbol{c}","\\bfd":"\\boldsymbol{d}","\\bfe":"\\boldsymbol{e}","\\bff":"\\boldsymbol{f}","\\bfg":"\\boldsymbol{g}","\\bfh":"\\boldsymbol{h}","\\bfi":"\\boldsymbol{i}","\\bfj":"\\boldsymbol{j}","\\bfk":"\\boldsymbol{k}","\\bfl":"\\boldsymbol{l}","\\bfm":"\\boldsymbol{m}","\\bfn":"\\boldsymbol{n}","\\bfo":"\\boldsymbol{o}","\\bfp":"\\boldsymbol{p}","\\bfq":"\\boldsymbol{q}","\\bfr":"\\boldsymbol{r}","\\bfs":"\\boldsymbol{s}","\\bft":"\\boldsymbol{t}","\\bfu":"\\boldsymbol{u}","\\bfv":"\\boldsymbol{v}","\\bfw":"\\boldsymbol{w}","\\bfx":"\\boldsymbol{x}","\\bfy":"\\boldsymbol{y}","\\bfz":"\\boldsymbol{z}","\\bfA":"\\boldsymbol{A}","\\bfB":"\\boldsymbol{B}","\\bfC":"\\boldsymbol{C}","\\bfD":"\\boldsymbol{D}","\\bfE":"\\boldsymbol{E}","\\bfF":"\\boldsymbol{F}","\\bfG":"\\boldsymbol{G}","\\bfH":"\\boldsymbol{H}","\\bfI":"\\boldsymbol{I}","\\bfJ":"\\boldsymbol{J}","\\bfK":"\\boldsymbol{K}","\\bfL":"\\boldsymbol{L}","\\bfM":"\\boldsymbol{M}","\\bfN":"\\boldsymbol{N}","\\bfO":"\\boldsymbol{O}","\\bfP":"\\boldsymbol{P}","\\bfQ":"\\boldsymbol{Q}","\\bfR":"\\boldsymbol{R}","\\bfS":"\\boldsymbol{S}","\\bfT":"\\boldsymbol{T}","\\bfU":"\\boldsymbol{U}","\\bfV":"\\boldsymbol{V}","\\bfW":"\\boldsymbol{W}","\\bfX":"\\boldsymbol{X}","\\bfY":"\\boldsymbol{Y}","\\bfZ":"\\boldsymbol{Z}"}});</script></span> sublattice sites in phase <span class="moose-katex-inline-equation" id="moose-equation-d00cae66-44f0-47d4-85fd-31a2efcec954"><script>var element = document.getElementById("moose-equation-d00cae66-44f0-47d4-85fd-31a2efcec954");katex.render("j", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\grad":"\\bs{\\nabla}","\\divergence":"\\grad \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\abs":"\\left\\lvert#1\\right\\rvert","\\tr":"\\text{tr}","\\dev":"\\text{dev}","\\sym":"\\text{sym}","\\diff":"\\text{ d}#1","\\activepart":"{\\left< A \\right>}","\\inactivepart":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\ep":"{\\varepsilon^p}","\\ep0":"{\\varepsilon_0^p}","\\epdot":"{\\dot{\\varepsilon}}^p","\\epdot0":"{\\dot{\\varepsilon}}_0^p","\\bfa":"\\boldsymbol{a}","\\bfb":"\\boldsymbol{b}","\\bfc":"\\boldsymbol{c}","\\bfd":"\\boldsymbol{d}","\\bfe":"\\boldsymbol{e}","\\bff":"\\boldsymbol{f}","\\bfg":"\\boldsymbol{g}","\\bfh":"\\boldsymbol{h}","\\bfi":"\\boldsymbol{i}","\\bfj":"\\boldsymbol{j}","\\bfk":"\\boldsymbol{k}","\\bfl":"\\boldsymbol{l}","\\bfm":"\\boldsymbol{m}","\\bfn":"\\boldsymbol{n}","\\bfo":"\\boldsymbol{o}","\\bfp":"\\boldsymbol{p}","\\bfq":"\\boldsymbol{q}","\\bfr":"\\boldsymbol{r}","\\bfs":"\\boldsymbol{s}","\\bft":"\\boldsymbol{t}","\\bfu":"\\boldsymbol{u}","\\bfv":"\\boldsymbol{v}","\\bfw":"\\boldsymbol{w}","\\bfx":"\\boldsymbol{x}","\\bfy":"\\boldsymbol{y}","\\bfz":"\\boldsymbol{z}","\\bfA":"\\boldsymbol{A}","\\bfB":"\\boldsymbol{B}","\\bfC":"\\boldsymbol{C}","\\bfD":"\\boldsymbol{D}","\\bfE":"\\boldsymbol{E}","\\bfF":"\\boldsymbol{F}","\\bfG":"\\boldsymbol{G}","\\bfH":"\\boldsymbol{H}","\\bfI":"\\boldsymbol{I}","\\bfJ":"\\boldsymbol{J}","\\bfK":"\\boldsymbol{K}","\\bfL":"\\boldsymbol{L}","\\bfM":"\\boldsymbol{M}","\\bfN":"\\boldsymbol{N}","\\bfO":"\\boldsymbol{O}","\\bfP":"\\boldsymbol{P}","\\bfQ":"\\boldsymbol{Q}","\\bfR":"\\boldsymbol{R}","\\bfS":"\\boldsymbol{S}","\\bfT":"\\boldsymbol{T}","\\bfU":"\\boldsymbol{U}","\\bfV":"\\boldsymbol{V}","\\bfW":"\\boldsymbol{W}","\\bfX":"\\boldsymbol{X}","\\bfY":"\\boldsymbol{Y}","\\bfZ":"\\boldsymbol{Z}"}});</script></span>.</p></section><section id="311b26b7-3750-4a6e-a69b-6b9ad95f203f" data-section-level="2" data-section-text="Sublattice equilibrium"><h2 id="sublattice-equilibrium">Sublattice equilibrium</h2><p>All sublattice pairs <span class="moose-katex-inline-equation" id="moose-equation-4690a6d7-3201-4900-9957-399becf9227a"><script>var element = document.getElementById("moose-equation-4690a6d7-3201-4900-9957-399becf9227a");katex.render("k", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\grad":"\\bs{\\nabla}","\\divergence":"\\grad \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\abs":"\\left\\lvert#1\\right\\rvert","\\tr":"\\text{tr}","\\dev":"\\text{dev}","\\sym":"\\text{sym}","\\diff":"\\text{ d}#1","\\activepart":"{\\left< A \\right>}","\\inactivepart":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\ep":"{\\varepsilon^p}","\\ep0":"{\\varepsilon_0^p}","\\epdot":"{\\dot{\\varepsilon}}^p","\\epdot0":"{\\dot{\\varepsilon}}_0^p","\\bfa":"\\boldsymbol{a}","\\bfb":"\\boldsymbol{b}","\\bfc":"\\boldsymbol{c}","\\bfd":"\\boldsymbol{d}","\\bfe":"\\boldsymbol{e}","\\bff":"\\boldsymbol{f}","\\bfg":"\\boldsymbol{g}","\\bfh":"\\boldsymbol{h}","\\bfi":"\\boldsymbol{i}","\\bfj":"\\boldsymbol{j}","\\bfk":"\\boldsymbol{k}","\\bfl":"\\boldsymbol{l}","\\bfm":"\\boldsymbol{m}","\\bfn":"\\boldsymbol{n}","\\bfo":"\\boldsymbol{o}","\\bfp":"\\boldsymbol{p}","\\bfq":"\\boldsymbol{q}","\\bfr":"\\boldsymbol{r}","\\bfs":"\\boldsymbol{s}","\\bft":"\\boldsymbol{t}","\\bfu":"\\boldsymbol{u}","\\bfv":"\\boldsymbol{v}","\\bfw":"\\boldsymbol{w}","\\bfx":"\\boldsymbol{x}","\\bfy":"\\boldsymbol{y}","\\bfz":"\\boldsymbol{z}","\\bfA":"\\boldsymbol{A}","\\bfB":"\\boldsymbol{B}","\\bfC":"\\boldsymbol{C}","\\bfD":"\\boldsymbol{D}","\\bfE":"\\boldsymbol{E}","\\bfF":"\\boldsymbol{F}","\\bfG":"\\boldsymbol{G}","\\bfH":"\\boldsymbol{H}","\\bfI":"\\boldsymbol{I}","\\bfJ":"\\boldsymbol{J}","\\bfK":"\\boldsymbol{K}","\\bfL":"\\boldsymbol{L}","\\bfM":"\\boldsymbol{M}","\\bfN":"\\boldsymbol{N}","\\bfO":"\\boldsymbol{O}","\\bfP":"\\boldsymbol{P}","\\bfQ":"\\boldsymbol{Q}","\\bfR":"\\boldsymbol{R}","\\bfS":"\\boldsymbol{S}","\\bfT":"\\boldsymbol{T}","\\bfU":"\\boldsymbol{U}","\\bfV":"\\boldsymbol{V}","\\bfW":"\\boldsymbol{W}","\\bfX":"\\boldsymbol{X}","\\bfY":"\\boldsymbol{Y}","\\bfZ":"\\boldsymbol{Z}"}});</script></span> and <span class="moose-katex-inline-equation" id="moose-equation-f3c1326e-eee1-4c72-8f25-060e4a5ef182"><script>var element = document.getElementById("moose-equation-f3c1326e-eee1-4c72-8f25-060e4a5ef182");katex.render("k'", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\grad":"\\bs{\\nabla}","\\divergence":"\\grad \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\abs":"\\left\\lvert#1\\right\\rvert","\\tr":"\\text{tr}","\\dev":"\\text{dev}","\\sym":"\\text{sym}","\\diff":"\\text{ d}#1","\\activepart":"{\\left< A \\right>}","\\inactivepart":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\ep":"{\\varepsilon^p}","\\ep0":"{\\varepsilon_0^p}","\\epdot":"{\\dot{\\varepsilon}}^p","\\epdot0":"{\\dot{\\varepsilon}}_0^p","\\bfa":"\\boldsymbol{a}","\\bfb":"\\boldsymbol{b}","\\bfc":"\\boldsymbol{c}","\\bfd":"\\boldsymbol{d}","\\bfe":"\\boldsymbol{e}","\\bff":"\\boldsymbol{f}","\\bfg":"\\boldsymbol{g}","\\bfh":"\\boldsymbol{h}","\\bfi":"\\boldsymbol{i}","\\bfj":"\\boldsymbol{j}","\\bfk":"\\boldsymbol{k}","\\bfl":"\\boldsymbol{l}","\\bfm":"\\boldsymbol{m}","\\bfn":"\\boldsymbol{n}","\\bfo":"\\boldsymbol{o}","\\bfp":"\\boldsymbol{p}","\\bfq":"\\boldsymbol{q}","\\bfr":"\\boldsymbol{r}","\\bfs":"\\boldsymbol{s}","\\bft":"\\boldsymbol{t}","\\bfu":"\\boldsymbol{u}","\\bfv":"\\boldsymbol{v}","\\bfw":"\\boldsymbol{w}","\\bfx":"\\boldsymbol{x}","\\bfy":"\\boldsymbol{y}","\\bfz":"\\boldsymbol{z}","\\bfA":"\\boldsymbol{A}","\\bfB":"\\boldsymbol{B}","\\bfC":"\\boldsymbol{C}","\\bfD":"\\boldsymbol{D}","\\bfE":"\\boldsymbol{E}","\\bfF":"\\boldsymbol{F}","\\bfG":"\\boldsymbol{G}","\\bfH":"\\boldsymbol{H}","\\bfI":"\\boldsymbol{I}","\\bfJ":"\\boldsymbol{J}","\\bfK":"\\boldsymbol{K}","\\bfL":"\\boldsymbol{L}","\\bfM":"\\boldsymbol{M}","\\bfN":"\\boldsymbol{N}","\\bfO":"\\boldsymbol{O}","\\bfP":"\\boldsymbol{P}","\\bfQ":"\\boldsymbol{Q}","\\bfR":"\\boldsymbol{R}","\\bfS":"\\boldsymbol{S}","\\bfT":"\\boldsymbol{T}","\\bfU":"\\boldsymbol{U}","\\bfV":"\\boldsymbol{V}","\\bfW":"\\boldsymbol{W}","\\bfX":"\\boldsymbol{X}","\\bfY":"\\boldsymbol{Y}","\\bfZ":"\\boldsymbol{Z}"}});</script></span> in a given phase are assumed to be always in equilibrium, thus</p><p><span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-7291c126-bb8d-40d3-b8da-84c9db5207e7"></span><script>var element = document.getElementById("moose-equation-7291c126-bb8d-40d3-b8da-84c9db5207e7");katex.render("\\frac 1{a_{jk}} \\frac{\\partial F_j}{\\partial c_{ijk}} = \\frac 1{a_{jk'}} \\frac{\\partial F_j}{\\partial c_{ijk'}}", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\grad":"\\bs{\\nabla}","\\divergence":"\\grad \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\abs":"\\left\\lvert#1\\right\\rvert","\\tr":"\\text{tr}","\\dev":"\\text{dev}","\\sym":"\\text{sym}","\\diff":"\\text{ d}#1","\\activepart":"{\\left< A \\right>}","\\inactivepart":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\ep":"{\\varepsilon^p}","\\ep0":"{\\varepsilon_0^p}","\\epdot":"{\\dot{\\varepsilon}}^p","\\epdot0":"{\\dot{\\varepsilon}}_0^p","\\bfa":"\\boldsymbol{a}","\\bfb":"\\boldsymbol{b}","\\bfc":"\\boldsymbol{c}","\\bfd":"\\boldsymbol{d}","\\bfe":"\\boldsymbol{e}","\\bff":"\\boldsymbol{f}","\\bfg":"\\boldsymbol{g}","\\bfh":"\\boldsymbol{h}","\\bfi":"\\boldsymbol{i}","\\bfj":"\\boldsymbol{j}","\\bfk":"\\boldsymbol{k}","\\bfl":"\\boldsymbol{l}","\\bfm":"\\boldsymbol{m}","\\bfn":"\\boldsymbol{n}","\\bfo":"\\boldsymbol{o}","\\bfp":"\\boldsymbol{p}","\\bfq":"\\boldsymbol{q}","\\bfr":"\\boldsymbol{r}","\\bfs":"\\boldsymbol{s}","\\bft":"\\boldsymbol{t}","\\bfu":"\\boldsymbol{u}","\\bfv":"\\boldsymbol{v}","\\bfw":"\\boldsymbol{w}","\\bfx":"\\boldsymbol{x}","\\bfy":"\\boldsymbol{y}","\\bfz":"\\boldsymbol{z}","\\bfA":"\\boldsymbol{A}","\\bfB":"\\boldsymbol{B}","\\bfC":"\\boldsymbol{C}","\\bfD":"\\boldsymbol{D}","\\bfE":"\\boldsymbol{E}","\\bfF":"\\boldsymbol{F}","\\bfG":"\\boldsymbol{G}","\\bfH":"\\boldsymbol{H}","\\bfI":"\\boldsymbol{I}","\\bfJ":"\\boldsymbol{J}","\\bfK":"\\boldsymbol{K}","\\bfL":"\\boldsymbol{L}","\\bfM":"\\boldsymbol{M}","\\bfN":"\\boldsymbol{N}","\\bfO":"\\boldsymbol{O}","\\bfP":"\\boldsymbol{P}","\\bfQ":"\\boldsymbol{Q}","\\bfR":"\\boldsymbol{R}","\\bfS":"\\boldsymbol{S}","\\bfT":"\\boldsymbol{T}","\\bfU":"\\boldsymbol{U}","\\bfV":"\\boldsymbol{V}","\\bfW":"\\boldsymbol{W}","\\bfX":"\\boldsymbol{X}","\\bfY":"\\boldsymbol{Y}","\\bfZ":"\\boldsymbol{Z}"}});</script></span></p><p>This condition is enforced by the <a href="../../../source/kernels/SLKKSChemicalPotential.html"><code>SLKKSChemicalPotential</code></a> kernel.</p><pre style="max-height:350px;"><code class="language-text">
[chempot1a1b]
  type = SLKKSChemicalPotential
  variable = Cijk
  k        = ajk
  cs       = Cijk&#x27;
  ks       = ajk&#x27;
  F  = Fj
[]
</code></pre><p>With <span class="moose-katex-inline-equation" id="moose-equation-0fbba143-e51d-4cf9-867a-e201e9dcd960"><script>var element = document.getElementById("moose-equation-0fbba143-e51d-4cf9-867a-e201e9dcd960");katex.render("N", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\grad":"\\bs{\\nabla}","\\divergence":"\\grad \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\abs":"\\left\\lvert#1\\right\\rvert","\\tr":"\\text{tr}","\\dev":"\\text{dev}","\\sym":"\\text{sym}","\\diff":"\\text{ d}#1","\\activepart":"{\\left< A \\right>}","\\inactivepart":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\ep":"{\\varepsilon^p}","\\ep0":"{\\varepsilon_0^p}","\\epdot":"{\\dot{\\varepsilon}}^p","\\epdot0":"{\\dot{\\varepsilon}}_0^p","\\bfa":"\\boldsymbol{a}","\\bfb":"\\boldsymbol{b}","\\bfc":"\\boldsymbol{c}","\\bfd":"\\boldsymbol{d}","\\bfe":"\\boldsymbol{e}","\\bff":"\\boldsymbol{f}","\\bfg":"\\boldsymbol{g}","\\bfh":"\\boldsymbol{h}","\\bfi":"\\boldsymbol{i}","\\bfj":"\\boldsymbol{j}","\\bfk":"\\boldsymbol{k}","\\bfl":"\\boldsymbol{l}","\\bfm":"\\boldsymbol{m}","\\bfn":"\\boldsymbol{n}","\\bfo":"\\boldsymbol{o}","\\bfp":"\\boldsymbol{p}","\\bfq":"\\boldsymbol{q}","\\bfr":"\\boldsymbol{r}","\\bfs":"\\boldsymbol{s}","\\bft":"\\boldsymbol{t}","\\bfu":"\\boldsymbol{u}","\\bfv":"\\boldsymbol{v}","\\bfw":"\\boldsymbol{w}","\\bfx":"\\boldsymbol{x}","\\bfy":"\\boldsymbol{y}","\\bfz":"\\boldsymbol{z}","\\bfA":"\\boldsymbol{A}","\\bfB":"\\boldsymbol{B}","\\bfC":"\\boldsymbol{C}","\\bfD":"\\boldsymbol{D}","\\bfE":"\\boldsymbol{E}","\\bfF":"\\boldsymbol{F}","\\bfG":"\\boldsymbol{G}","\\bfH":"\\boldsymbol{H}","\\bfI":"\\boldsymbol{I}","\\bfJ":"\\boldsymbol{J}","\\bfK":"\\boldsymbol{K}","\\bfL":"\\boldsymbol{L}","\\bfM":"\\boldsymbol{M}","\\bfN":"\\boldsymbol{N}","\\bfO":"\\boldsymbol{O}","\\bfP":"\\boldsymbol{P}","\\bfQ":"\\boldsymbol{Q}","\\bfR":"\\boldsymbol{R}","\\bfS":"\\boldsymbol{S}","\\bfT":"\\boldsymbol{T}","\\bfU":"\\boldsymbol{U}","\\bfV":"\\boldsymbol{V}","\\bfW":"\\boldsymbol{W}","\\bfX":"\\boldsymbol{X}","\\bfY":"\\boldsymbol{Y}","\\bfZ":"\\boldsymbol{Z}"}});</script></span> sublattices in a phase <span class="moose-katex-inline-equation" id="moose-equation-f6b824f1-e03c-40a9-ae6f-9d1c135cb21b"><script>var element = document.getElementById("moose-equation-f6b824f1-e03c-40a9-ae6f-9d1c135cb21b");katex.render("N-1", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\grad":"\\bs{\\nabla}","\\divergence":"\\grad \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\abs":"\\left\\lvert#1\\right\\rvert","\\tr":"\\text{tr}","\\dev":"\\text{dev}","\\sym":"\\text{sym}","\\diff":"\\text{ d}#1","\\activepart":"{\\left< A \\right>}","\\inactivepart":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\ep":"{\\varepsilon^p}","\\ep0":"{\\varepsilon_0^p}","\\epdot":"{\\dot{\\varepsilon}}^p","\\epdot0":"{\\dot{\\varepsilon}}_0^p","\\bfa":"\\boldsymbol{a}","\\bfb":"\\boldsymbol{b}","\\bfc":"\\boldsymbol{c}","\\bfd":"\\boldsymbol{d}","\\bfe":"\\boldsymbol{e}","\\bff":"\\boldsymbol{f}","\\bfg":"\\boldsymbol{g}","\\bfh":"\\boldsymbol{h}","\\bfi":"\\boldsymbol{i}","\\bfj":"\\boldsymbol{j}","\\bfk":"\\boldsymbol{k}","\\bfl":"\\boldsymbol{l}","\\bfm":"\\boldsymbol{m}","\\bfn":"\\boldsymbol{n}","\\bfo":"\\boldsymbol{o}","\\bfp":"\\boldsymbol{p}","\\bfq":"\\boldsymbol{q}","\\bfr":"\\boldsymbol{r}","\\bfs":"\\boldsymbol{s}","\\bft":"\\boldsymbol{t}","\\bfu":"\\boldsymbol{u}","\\bfv":"\\boldsymbol{v}","\\bfw":"\\boldsymbol{w}","\\bfx":"\\boldsymbol{x}","\\bfy":"\\boldsymbol{y}","\\bfz":"\\boldsymbol{z}","\\bfA":"\\boldsymbol{A}","\\bfB":"\\boldsymbol{B}","\\bfC":"\\boldsymbol{C}","\\bfD":"\\boldsymbol{D}","\\bfE":"\\boldsymbol{E}","\\bfF":"\\boldsymbol{F}","\\bfG":"\\boldsymbol{G}","\\bfH":"\\boldsymbol{H}","\\bfI":"\\boldsymbol{I}","\\bfJ":"\\boldsymbol{J}","\\bfK":"\\boldsymbol{K}","\\bfL":"\\boldsymbol{L}","\\bfM":"\\boldsymbol{M}","\\bfN":"\\boldsymbol{N}","\\bfO":"\\boldsymbol{O}","\\bfP":"\\boldsymbol{P}","\\bfQ":"\\boldsymbol{Q}","\\bfR":"\\boldsymbol{R}","\\bfS":"\\boldsymbol{S}","\\bfT":"\\boldsymbol{T}","\\bfU":"\\boldsymbol{U}","\\bfV":"\\boldsymbol{V}","\\bfW":"\\boldsymbol{W}","\\bfX":"\\boldsymbol{X}","\\bfY":"\\boldsymbol{Y}","\\bfZ":"\\boldsymbol{Z}"}});</script></span> such kernels are required. That leaves one sublattice concentration variable in a given phase to be covered by a kernel.</p></section></section><section id="2c472c73-eaf8-4731-9cc4-320115f8d752" data-section-level="1" data-section-text="Phase equilibrium"><h1 id="phase-equilibrium">Phase equilibrium</h1><p>At the same time the original KKS model chemical potential equilibria still hold</p><p><span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-6e9f7a66-3588-4c4c-b614-d7710fa17342"></span><script>var element = document.getElementById("moose-equation-6e9f7a66-3588-4c4c-b614-d7710fa17342");katex.render("\\frac{\\partial F}{\\partial c_i} = \\frac{\\partial F_j}{\\partial c_{ijk}} \\quad ,\\quad \\forall \\{j,k\\}.", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\grad":"\\bs{\\nabla}","\\divergence":"\\grad \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\abs":"\\left\\lvert#1\\right\\rvert","\\tr":"\\text{tr}","\\dev":"\\text{dev}","\\sym":"\\text{sym}","\\diff":"\\text{ d}#1","\\activepart":"{\\left< A \\right>}","\\inactivepart":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\ep":"{\\varepsilon^p}","\\ep0":"{\\varepsilon_0^p}","\\epdot":"{\\dot{\\varepsilon}}^p","\\epdot0":"{\\dot{\\varepsilon}}_0^p","\\bfa":"\\boldsymbol{a}","\\bfb":"\\boldsymbol{b}","\\bfc":"\\boldsymbol{c}","\\bfd":"\\boldsymbol{d}","\\bfe":"\\boldsymbol{e}","\\bff":"\\boldsymbol{f}","\\bfg":"\\boldsymbol{g}","\\bfh":"\\boldsymbol{h}","\\bfi":"\\boldsymbol{i}","\\bfj":"\\boldsymbol{j}","\\bfk":"\\boldsymbol{k}","\\bfl":"\\boldsymbol{l}","\\bfm":"\\boldsymbol{m}","\\bfn":"\\boldsymbol{n}","\\bfo":"\\boldsymbol{o}","\\bfp":"\\boldsymbol{p}","\\bfq":"\\boldsymbol{q}","\\bfr":"\\boldsymbol{r}","\\bfs":"\\boldsymbol{s}","\\bft":"\\boldsymbol{t}","\\bfu":"\\boldsymbol{u}","\\bfv":"\\boldsymbol{v}","\\bfw":"\\boldsymbol{w}","\\bfx":"\\boldsymbol{x}","\\bfy":"\\boldsymbol{y}","\\bfz":"\\boldsymbol{z}","\\bfA":"\\boldsymbol{A}","\\bfB":"\\boldsymbol{B}","\\bfC":"\\boldsymbol{C}","\\bfD":"\\boldsymbol{D}","\\bfE":"\\boldsymbol{E}","\\bfF":"\\boldsymbol{F}","\\bfG":"\\boldsymbol{G}","\\bfH":"\\boldsymbol{H}","\\bfI":"\\boldsymbol{I}","\\bfJ":"\\boldsymbol{J}","\\bfK":"\\boldsymbol{K}","\\bfL":"\\boldsymbol{L}","\\bfM":"\\boldsymbol{M}","\\bfN":"\\boldsymbol{N}","\\bfO":"\\boldsymbol{O}","\\bfP":"\\boldsymbol{P}","\\bfQ":"\\boldsymbol{Q}","\\bfR":"\\boldsymbol{R}","\\bfS":"\\boldsymbol{S}","\\bfT":"\\boldsymbol{T}","\\bfU":"\\boldsymbol{U}","\\bfV":"\\boldsymbol{V}","\\bfW":"\\boldsymbol{W}","\\bfX":"\\boldsymbol{X}","\\bfY":"\\boldsymbol{Y}","\\bfZ":"\\boldsymbol{Z}"}});</script></span></p><p>meaning that sublattice chemical potentials (corrected for the sublattice site fractions) must be in equilibrium across phases.</p><p><span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-666e7482-eacb-4c95-906a-d9330e4d8d91"></span><script>var element = document.getElementById("moose-equation-666e7482-eacb-4c95-906a-d9330e4d8d91");katex.render("\\frac 1{a_{jk}} \\frac{\\partial F_j}{\\partial c_{ijk}} = \\frac 1{a_{j'k}} \\frac{\\partial F_{j'}}{\\partial c_{ij'k}}", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\grad":"\\bs{\\nabla}","\\divergence":"\\grad \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\abs":"\\left\\lvert#1\\right\\rvert","\\tr":"\\text{tr}","\\dev":"\\text{dev}","\\sym":"\\text{sym}","\\diff":"\\text{ d}#1","\\activepart":"{\\left< A \\right>}","\\inactivepart":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\ep":"{\\varepsilon^p}","\\ep0":"{\\varepsilon_0^p}","\\epdot":"{\\dot{\\varepsilon}}^p","\\epdot0":"{\\dot{\\varepsilon}}_0^p","\\bfa":"\\boldsymbol{a}","\\bfb":"\\boldsymbol{b}","\\bfc":"\\boldsymbol{c}","\\bfd":"\\boldsymbol{d}","\\bfe":"\\boldsymbol{e}","\\bff":"\\boldsymbol{f}","\\bfg":"\\boldsymbol{g}","\\bfh":"\\boldsymbol{h}","\\bfi":"\\boldsymbol{i}","\\bfj":"\\boldsymbol{j}","\\bfk":"\\boldsymbol{k}","\\bfl":"\\boldsymbol{l}","\\bfm":"\\boldsymbol{m}","\\bfn":"\\boldsymbol{n}","\\bfo":"\\boldsymbol{o}","\\bfp":"\\boldsymbol{p}","\\bfq":"\\boldsymbol{q}","\\bfr":"\\boldsymbol{r}","\\bfs":"\\boldsymbol{s}","\\bft":"\\boldsymbol{t}","\\bfu":"\\boldsymbol{u}","\\bfv":"\\boldsymbol{v}","\\bfw":"\\boldsymbol{w}","\\bfx":"\\boldsymbol{x}","\\bfy":"\\boldsymbol{y}","\\bfz":"\\boldsymbol{z}","\\bfA":"\\boldsymbol{A}","\\bfB":"\\boldsymbol{B}","\\bfC":"\\boldsymbol{C}","\\bfD":"\\boldsymbol{D}","\\bfE":"\\boldsymbol{E}","\\bfF":"\\boldsymbol{F}","\\bfG":"\\boldsymbol{G}","\\bfH":"\\boldsymbol{H}","\\bfI":"\\boldsymbol{I}","\\bfJ":"\\boldsymbol{J}","\\bfK":"\\boldsymbol{K}","\\bfL":"\\boldsymbol{L}","\\bfM":"\\boldsymbol{M}","\\bfN":"\\boldsymbol{N}","\\bfO":"\\boldsymbol{O}","\\bfP":"\\boldsymbol{P}","\\bfQ":"\\boldsymbol{Q}","\\bfR":"\\boldsymbol{R}","\\bfS":"\\boldsymbol{S}","\\bfT":"\\boldsymbol{T}","\\bfU":"\\boldsymbol{U}","\\bfV":"\\boldsymbol{V}","\\bfW":"\\boldsymbol{W}","\\bfX":"\\boldsymbol{X}","\\bfY":"\\boldsymbol{Y}","\\bfZ":"\\boldsymbol{Z}"}});</script></span></p><p>That remaining sublattice concentration will couple to the next phase using a <a href="../../../source/kernels/KKSPhaseChemicalPotential.html"><code>KKSPhaseChemicalPotential</code></a> kernel.</p><pre style="max-height:350px;"><code class="language-text">
[chempot1c2a]
  type = KKSPhaseChemicalPotential
  variable = Cijk
  ka = ajk
  fa_name = Fj
  cb = Cij&#x27;k
  kb = aj&#x27;k
  fb_name = Fj&#x27;
[]
</code></pre><p>Note that in this kernel the <code>ajk</code> and <code>aj&#x27;k</code> must be true site fractions ranging from 0 to 1.</p><section id="d0b2b85b-b547-4254-9cd4-a373cda91fc6" data-section-level="2" data-section-text="Mass transport"><h2 id="mass-transport">Mass transport</h2><p>The global concentration variables <span class="moose-katex-inline-equation" id="moose-equation-1931e720-f347-46d8-9c1a-400fb18115d0"><script>var element = document.getElementById("moose-equation-1931e720-f347-46d8-9c1a-400fb18115d0");katex.render("c_i", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\grad":"\\bs{\\nabla}","\\divergence":"\\grad \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\abs":"\\left\\lvert#1\\right\\rvert","\\tr":"\\text{tr}","\\dev":"\\text{dev}","\\sym":"\\text{sym}","\\diff":"\\text{ d}#1","\\activepart":"{\\left< A \\right>}","\\inactivepart":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\ep":"{\\varepsilon^p}","\\ep0":"{\\varepsilon_0^p}","\\epdot":"{\\dot{\\varepsilon}}^p","\\epdot0":"{\\dot{\\varepsilon}}_0^p","\\bfa":"\\boldsymbol{a}","\\bfb":"\\boldsymbol{b}","\\bfc":"\\boldsymbol{c}","\\bfd":"\\boldsymbol{d}","\\bfe":"\\boldsymbol{e}","\\bff":"\\boldsymbol{f}","\\bfg":"\\boldsymbol{g}","\\bfh":"\\boldsymbol{h}","\\bfi":"\\boldsymbol{i}","\\bfj":"\\boldsymbol{j}","\\bfk":"\\boldsymbol{k}","\\bfl":"\\boldsymbol{l}","\\bfm":"\\boldsymbol{m}","\\bfn":"\\boldsymbol{n}","\\bfo":"\\boldsymbol{o}","\\bfp":"\\boldsymbol{p}","\\bfq":"\\boldsymbol{q}","\\bfr":"\\boldsymbol{r}","\\bfs":"\\boldsymbol{s}","\\bft":"\\boldsymbol{t}","\\bfu":"\\boldsymbol{u}","\\bfv":"\\boldsymbol{v}","\\bfw":"\\boldsymbol{w}","\\bfx":"\\boldsymbol{x}","\\bfy":"\\boldsymbol{y}","\\bfz":"\\boldsymbol{z}","\\bfA":"\\boldsymbol{A}","\\bfB":"\\boldsymbol{B}","\\bfC":"\\boldsymbol{C}","\\bfD":"\\boldsymbol{D}","\\bfE":"\\boldsymbol{E}","\\bfF":"\\boldsymbol{F}","\\bfG":"\\boldsymbol{G}","\\bfH":"\\boldsymbol{H}","\\bfI":"\\boldsymbol{I}","\\bfJ":"\\boldsymbol{J}","\\bfK":"\\boldsymbol{K}","\\bfL":"\\boldsymbol{L}","\\bfM":"\\boldsymbol{M}","\\bfN":"\\boldsymbol{N}","\\bfO":"\\boldsymbol{O}","\\bfP":"\\boldsymbol{P}","\\bfQ":"\\boldsymbol{Q}","\\bfR":"\\boldsymbol{R}","\\bfS":"\\boldsymbol{S}","\\bfT":"\\boldsymbol{T}","\\bfU":"\\boldsymbol{U}","\\bfV":"\\boldsymbol{V}","\\bfW":"\\boldsymbol{W}","\\bfX":"\\boldsymbol{X}","\\bfY":"\\boldsymbol{Y}","\\bfZ":"\\boldsymbol{Z}"}});</script></span> govern the mass transport along chemical potential gradients.</p><p><span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-1669d800-07fb-456a-af57-b08255b18367"></span><span class="moose-katex-equation-number">(1)</span><script>var element = document.getElementById("moose-equation-1669d800-07fb-456a-af57-b08255b18367");katex.render("   \\frac{\\partial c_i}{\\partial t} = \\nabla\\cdot D_i\\sum_j h_j\\sum_k a_{jk}\\nabla c_{ijk}. ", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\grad":"\\bs{\\nabla}","\\divergence":"\\grad \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\abs":"\\left\\lvert#1\\right\\rvert","\\tr":"\\text{tr}","\\dev":"\\text{dev}","\\sym":"\\text{sym}","\\diff":"\\text{ d}#1","\\activepart":"{\\left< A \\right>}","\\inactivepart":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\ep":"{\\varepsilon^p}","\\ep0":"{\\varepsilon_0^p}","\\epdot":"{\\dot{\\varepsilon}}^p","\\epdot0":"{\\dot{\\varepsilon}}_0^p","\\bfa":"\\boldsymbol{a}","\\bfb":"\\boldsymbol{b}","\\bfc":"\\boldsymbol{c}","\\bfd":"\\boldsymbol{d}","\\bfe":"\\boldsymbol{e}","\\bff":"\\boldsymbol{f}","\\bfg":"\\boldsymbol{g}","\\bfh":"\\boldsymbol{h}","\\bfi":"\\boldsymbol{i}","\\bfj":"\\boldsymbol{j}","\\bfk":"\\boldsymbol{k}","\\bfl":"\\boldsymbol{l}","\\bfm":"\\boldsymbol{m}","\\bfn":"\\boldsymbol{n}","\\bfo":"\\boldsymbol{o}","\\bfp":"\\boldsymbol{p}","\\bfq":"\\boldsymbol{q}","\\bfr":"\\boldsymbol{r}","\\bfs":"\\boldsymbol{s}","\\bft":"\\boldsymbol{t}","\\bfu":"\\boldsymbol{u}","\\bfv":"\\boldsymbol{v}","\\bfw":"\\boldsymbol{w}","\\bfx":"\\boldsymbol{x}","\\bfy":"\\boldsymbol{y}","\\bfz":"\\boldsymbol{z}","\\bfA":"\\boldsymbol{A}","\\bfB":"\\boldsymbol{B}","\\bfC":"\\boldsymbol{C}","\\bfD":"\\boldsymbol{D}","\\bfE":"\\boldsymbol{E}","\\bfF":"\\boldsymbol{F}","\\bfG":"\\boldsymbol{G}","\\bfH":"\\boldsymbol{H}","\\bfI":"\\boldsymbol{I}","\\bfJ":"\\boldsymbol{J}","\\bfK":"\\boldsymbol{K}","\\bfL":"\\boldsymbol{L}","\\bfM":"\\boldsymbol{M}","\\bfN":"\\boldsymbol{N}","\\bfO":"\\boldsymbol{O}","\\bfP":"\\boldsymbol{P}","\\bfQ":"\\boldsymbol{Q}","\\bfR":"\\boldsymbol{R}","\\bfS":"\\boldsymbol{S}","\\bfT":"\\boldsymbol{T}","\\bfU":"\\boldsymbol{U}","\\bfV":"\\boldsymbol{V}","\\bfW":"\\boldsymbol{W}","\\bfX":"\\boldsymbol{X}","\\bfY":"\\boldsymbol{Y}","\\bfZ":"\\boldsymbol{Z}"}});</script></span></p><p>This equation can be implemented using multiple <code>MatDiffusion</code> kernels in MOOSE. To illustrate this we can re-order the summation to yield</p><p><span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-a6b2b5d0-8942-41d8-9c24-756e216a04b8"></span><span class="moose-katex-equation-number">(2)</span><script>var element = document.getElementById("moose-equation-a6b2b5d0-8942-41d8-9c24-756e216a04b8");katex.render("   \\frac{\\partial c_i}{\\partial t} = \\sum_j\\sum_k \\nabla\\cdot \\underbrace{D_i h_j a_{jk}}_{D'_i}\\nabla c_{ijk}. ", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\grad":"\\bs{\\nabla}","\\divergence":"\\grad \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\abs":"\\left\\lvert#1\\right\\rvert","\\tr":"\\text{tr}","\\dev":"\\text{dev}","\\sym":"\\text{sym}","\\diff":"\\text{ d}#1","\\activepart":"{\\left< A \\right>}","\\inactivepart":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\ep":"{\\varepsilon^p}","\\ep0":"{\\varepsilon_0^p}","\\epdot":"{\\dot{\\varepsilon}}^p","\\epdot0":"{\\dot{\\varepsilon}}_0^p","\\bfa":"\\boldsymbol{a}","\\bfb":"\\boldsymbol{b}","\\bfc":"\\boldsymbol{c}","\\bfd":"\\boldsymbol{d}","\\bfe":"\\boldsymbol{e}","\\bff":"\\boldsymbol{f}","\\bfg":"\\boldsymbol{g}","\\bfh":"\\boldsymbol{h}","\\bfi":"\\boldsymbol{i}","\\bfj":"\\boldsymbol{j}","\\bfk":"\\boldsymbol{k}","\\bfl":"\\boldsymbol{l}","\\bfm":"\\boldsymbol{m}","\\bfn":"\\boldsymbol{n}","\\bfo":"\\boldsymbol{o}","\\bfp":"\\boldsymbol{p}","\\bfq":"\\boldsymbol{q}","\\bfr":"\\boldsymbol{r}","\\bfs":"\\boldsymbol{s}","\\bft":"\\boldsymbol{t}","\\bfu":"\\boldsymbol{u}","\\bfv":"\\boldsymbol{v}","\\bfw":"\\boldsymbol{w}","\\bfx":"\\boldsymbol{x}","\\bfy":"\\boldsymbol{y}","\\bfz":"\\boldsymbol{z}","\\bfA":"\\boldsymbol{A}","\\bfB":"\\boldsymbol{B}","\\bfC":"\\boldsymbol{C}","\\bfD":"\\boldsymbol{D}","\\bfE":"\\boldsymbol{E}","\\bfF":"\\boldsymbol{F}","\\bfG":"\\boldsymbol{G}","\\bfH":"\\boldsymbol{H}","\\bfI":"\\boldsymbol{I}","\\bfJ":"\\boldsymbol{J}","\\bfK":"\\boldsymbol{K}","\\bfL":"\\boldsymbol{L}","\\bfM":"\\boldsymbol{M}","\\bfN":"\\boldsymbol{N}","\\bfO":"\\boldsymbol{O}","\\bfP":"\\boldsymbol{P}","\\bfQ":"\\boldsymbol{Q}","\\bfR":"\\boldsymbol{R}","\\bfS":"\\boldsymbol{S}","\\bfT":"\\boldsymbol{T}","\\bfU":"\\boldsymbol{U}","\\bfV":"\\boldsymbol{V}","\\bfW":"\\boldsymbol{W}","\\bfX":"\\boldsymbol{X}","\\bfY":"\\boldsymbol{Y}","\\bfZ":"\\boldsymbol{Z}"}});</script></span></p><p>This means we need to add a <code>MatDiffusion</code> kernel for sublattice in all phases, each operating on the variable <span class="moose-katex-inline-equation" id="moose-equation-46ee15b5-d7f9-4cbe-85bb-9570765e9918"><script>var element = document.getElementById("moose-equation-46ee15b5-d7f9-4cbe-85bb-9570765e9918");katex.render("c_i", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\grad":"\\bs{\\nabla}","\\divergence":"\\grad \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\abs":"\\left\\lvert#1\\right\\rvert","\\tr":"\\text{tr}","\\dev":"\\text{dev}","\\sym":"\\text{sym}","\\diff":"\\text{ d}#1","\\activepart":"{\\left< A \\right>}","\\inactivepart":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\ep":"{\\varepsilon^p}","\\ep0":"{\\varepsilon_0^p}","\\epdot":"{\\dot{\\varepsilon}}^p","\\epdot0":"{\\dot{\\varepsilon}}_0^p","\\bfa":"\\boldsymbol{a}","\\bfb":"\\boldsymbol{b}","\\bfc":"\\boldsymbol{c}","\\bfd":"\\boldsymbol{d}","\\bfe":"\\boldsymbol{e}","\\bff":"\\boldsymbol{f}","\\bfg":"\\boldsymbol{g}","\\bfh":"\\boldsymbol{h}","\\bfi":"\\boldsymbol{i}","\\bfj":"\\boldsymbol{j}","\\bfk":"\\boldsymbol{k}","\\bfl":"\\boldsymbol{l}","\\bfm":"\\boldsymbol{m}","\\bfn":"\\boldsymbol{n}","\\bfo":"\\boldsymbol{o}","\\bfp":"\\boldsymbol{p}","\\bfq":"\\boldsymbol{q}","\\bfr":"\\boldsymbol{r}","\\bfs":"\\boldsymbol{s}","\\bft":"\\boldsymbol{t}","\\bfu":"\\boldsymbol{u}","\\bfv":"\\boldsymbol{v}","\\bfw":"\\boldsymbol{w}","\\bfx":"\\boldsymbol{x}","\\bfy":"\\boldsymbol{y}","\\bfz":"\\boldsymbol{z}","\\bfA":"\\boldsymbol{A}","\\bfB":"\\boldsymbol{B}","\\bfC":"\\boldsymbol{C}","\\bfD":"\\boldsymbol{D}","\\bfE":"\\boldsymbol{E}","\\bfF":"\\boldsymbol{F}","\\bfG":"\\boldsymbol{G}","\\bfH":"\\boldsymbol{H}","\\bfI":"\\boldsymbol{I}","\\bfJ":"\\boldsymbol{J}","\\bfK":"\\boldsymbol{K}","\\bfL":"\\boldsymbol{L}","\\bfM":"\\boldsymbol{M}","\\bfN":"\\boldsymbol{N}","\\bfO":"\\boldsymbol{O}","\\bfP":"\\boldsymbol{P}","\\bfQ":"\\boldsymbol{Q}","\\bfR":"\\boldsymbol{R}","\\bfS":"\\boldsymbol{S}","\\bfT":"\\boldsymbol{T}","\\bfU":"\\boldsymbol{U}","\\bfV":"\\boldsymbol{V}","\\bfW":"\\boldsymbol{W}","\\bfX":"\\boldsymbol{X}","\\bfY":"\\boldsymbol{Y}","\\bfZ":"\\boldsymbol{Z}"}});</script></span>. We use the <a href="#1b1c9a10-c99e-45db-a390-d8515f837a6d" class="moose-modal-link modal-trigger">&quot;v&quot;</a> parameter to  specify <span class="moose-katex-inline-equation" id="moose-equation-1262c681-8909-4cf5-9cc0-1c567f511651"><script>var element = document.getElementById("moose-equation-1262c681-8909-4cf5-9cc0-1c567f511651");katex.render("c_{ijk}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\grad":"\\bs{\\nabla}","\\divergence":"\\grad \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\abs":"\\left\\lvert#1\\right\\rvert","\\tr":"\\text{tr}","\\dev":"\\text{dev}","\\sym":"\\text{sym}","\\diff":"\\text{ d}#1","\\activepart":"{\\left< A \\right>}","\\inactivepart":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\ep":"{\\varepsilon^p}","\\ep0":"{\\varepsilon_0^p}","\\epdot":"{\\dot{\\varepsilon}}^p","\\epdot0":"{\\dot{\\varepsilon}}_0^p","\\bfa":"\\boldsymbol{a}","\\bfb":"\\boldsymbol{b}","\\bfc":"\\boldsymbol{c}","\\bfd":"\\boldsymbol{d}","\\bfe":"\\boldsymbol{e}","\\bff":"\\boldsymbol{f}","\\bfg":"\\boldsymbol{g}","\\bfh":"\\boldsymbol{h}","\\bfi":"\\boldsymbol{i}","\\bfj":"\\boldsymbol{j}","\\bfk":"\\boldsymbol{k}","\\bfl":"\\boldsymbol{l}","\\bfm":"\\boldsymbol{m}","\\bfn":"\\boldsymbol{n}","\\bfo":"\\boldsymbol{o}","\\bfp":"\\boldsymbol{p}","\\bfq":"\\boldsymbol{q}","\\bfr":"\\boldsymbol{r}","\\bfs":"\\boldsymbol{s}","\\bft":"\\boldsymbol{t}","\\bfu":"\\boldsymbol{u}","\\bfv":"\\boldsymbol{v}","\\bfw":"\\boldsymbol{w}","\\bfx":"\\boldsymbol{x}","\\bfy":"\\boldsymbol{y}","\\bfz":"\\boldsymbol{z}","\\bfA":"\\boldsymbol{A}","\\bfB":"\\boldsymbol{B}","\\bfC":"\\boldsymbol{C}","\\bfD":"\\boldsymbol{D}","\\bfE":"\\boldsymbol{E}","\\bfF":"\\boldsymbol{F}","\\bfG":"\\boldsymbol{G}","\\bfH":"\\boldsymbol{H}","\\bfI":"\\boldsymbol{I}","\\bfJ":"\\boldsymbol{J}","\\bfK":"\\boldsymbol{K}","\\bfL":"\\boldsymbol{L}","\\bfM":"\\boldsymbol{M}","\\bfN":"\\boldsymbol{N}","\\bfO":"\\boldsymbol{O}","\\bfP":"\\boldsymbol{P}","\\bfQ":"\\boldsymbol{Q}","\\bfR":"\\boldsymbol{R}","\\bfS":"\\boldsymbol{S}","\\bfT":"\\boldsymbol{T}","\\bfU":"\\boldsymbol{U}","\\bfV":"\\boldsymbol{V}","\\bfW":"\\boldsymbol{W}","\\bfX":"\\boldsymbol{X}","\\bfY":"\\boldsymbol{Y}","\\bfZ":"\\boldsymbol{Z}"}});</script></span> as the variable to take the gradient of (rather than <span class="moose-katex-inline-equation" id="moose-equation-edd4cea6-45ec-4293-b069-5daae171603e"><script>var element = document.getElementById("moose-equation-edd4cea6-45ec-4293-b069-5daae171603e");katex.render("c_i", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\grad":"\\bs{\\nabla}","\\divergence":"\\grad \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\abs":"\\left\\lvert#1\\right\\rvert","\\tr":"\\text{tr}","\\dev":"\\text{dev}","\\sym":"\\text{sym}","\\diff":"\\text{ d}#1","\\activepart":"{\\left< A \\right>}","\\inactivepart":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\ep":"{\\varepsilon^p}","\\ep0":"{\\varepsilon_0^p}","\\epdot":"{\\dot{\\varepsilon}}^p","\\epdot0":"{\\dot{\\varepsilon}}_0^p","\\bfa":"\\boldsymbol{a}","\\bfb":"\\boldsymbol{b}","\\bfc":"\\boldsymbol{c}","\\bfd":"\\boldsymbol{d}","\\bfe":"\\boldsymbol{e}","\\bff":"\\boldsymbol{f}","\\bfg":"\\boldsymbol{g}","\\bfh":"\\boldsymbol{h}","\\bfi":"\\boldsymbol{i}","\\bfj":"\\boldsymbol{j}","\\bfk":"\\boldsymbol{k}","\\bfl":"\\boldsymbol{l}","\\bfm":"\\boldsymbol{m}","\\bfn":"\\boldsymbol{n}","\\bfo":"\\boldsymbol{o}","\\bfp":"\\boldsymbol{p}","\\bfq":"\\boldsymbol{q}","\\bfr":"\\boldsymbol{r}","\\bfs":"\\boldsymbol{s}","\\bft":"\\boldsymbol{t}","\\bfu":"\\boldsymbol{u}","\\bfv":"\\boldsymbol{v}","\\bfw":"\\boldsymbol{w}","\\bfx":"\\boldsymbol{x}","\\bfy":"\\boldsymbol{y}","\\bfz":"\\boldsymbol{z}","\\bfA":"\\boldsymbol{A}","\\bfB":"\\boldsymbol{B}","\\bfC":"\\boldsymbol{C}","\\bfD":"\\boldsymbol{D}","\\bfE":"\\boldsymbol{E}","\\bfF":"\\boldsymbol{F}","\\bfG":"\\boldsymbol{G}","\\bfH":"\\boldsymbol{H}","\\bfI":"\\boldsymbol{I}","\\bfJ":"\\boldsymbol{J}","\\bfK":"\\boldsymbol{K}","\\bfL":"\\boldsymbol{L}","\\bfM":"\\boldsymbol{M}","\\bfN":"\\boldsymbol{N}","\\bfO":"\\boldsymbol{O}","\\bfP":"\\boldsymbol{P}","\\bfQ":"\\boldsymbol{Q}","\\bfR":"\\boldsymbol{R}","\\bfS":"\\boldsymbol{S}","\\bfT":"\\boldsymbol{T}","\\bfU":"\\boldsymbol{U}","\\bfV":"\\boldsymbol{V}","\\bfW":"\\boldsymbol{W}","\\bfX":"\\boldsymbol{X}","\\bfY":"\\boldsymbol{Y}","\\bfZ":"\\boldsymbol{Z}"}});</script></span>). The effective diffusivity <span class="moose-katex-inline-equation" id="moose-equation-b0917046-835e-4754-a6e9-2a2fe2393b63"><script>var element = document.getElementById("moose-equation-b0917046-835e-4754-a6e9-2a2fe2393b63");katex.render("D'_i", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\grad":"\\bs{\\nabla}","\\divergence":"\\grad \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\abs":"\\left\\lvert#1\\right\\rvert","\\tr":"\\text{tr}","\\dev":"\\text{dev}","\\sym":"\\text{sym}","\\diff":"\\text{ d}#1","\\activepart":"{\\left< A \\right>}","\\inactivepart":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\ep":"{\\varepsilon^p}","\\ep0":"{\\varepsilon_0^p}","\\epdot":"{\\dot{\\varepsilon}}^p","\\epdot0":"{\\dot{\\varepsilon}}_0^p","\\bfa":"\\boldsymbol{a}","\\bfb":"\\boldsymbol{b}","\\bfc":"\\boldsymbol{c}","\\bfd":"\\boldsymbol{d}","\\bfe":"\\boldsymbol{e}","\\bff":"\\boldsymbol{f}","\\bfg":"\\boldsymbol{g}","\\bfh":"\\boldsymbol{h}","\\bfi":"\\boldsymbol{i}","\\bfj":"\\boldsymbol{j}","\\bfk":"\\boldsymbol{k}","\\bfl":"\\boldsymbol{l}","\\bfm":"\\boldsymbol{m}","\\bfn":"\\boldsymbol{n}","\\bfo":"\\boldsymbol{o}","\\bfp":"\\boldsymbol{p}","\\bfq":"\\boldsymbol{q}","\\bfr":"\\boldsymbol{r}","\\bfs":"\\boldsymbol{s}","\\bft":"\\boldsymbol{t}","\\bfu":"\\boldsymbol{u}","\\bfv":"\\boldsymbol{v}","\\bfw":"\\boldsymbol{w}","\\bfx":"\\boldsymbol{x}","\\bfy":"\\boldsymbol{y}","\\bfz":"\\boldsymbol{z}","\\bfA":"\\boldsymbol{A}","\\bfB":"\\boldsymbol{B}","\\bfC":"\\boldsymbol{C}","\\bfD":"\\boldsymbol{D}","\\bfE":"\\boldsymbol{E}","\\bfF":"\\boldsymbol{F}","\\bfG":"\\boldsymbol{G}","\\bfH":"\\boldsymbol{H}","\\bfI":"\\boldsymbol{I}","\\bfJ":"\\boldsymbol{J}","\\bfK":"\\boldsymbol{K}","\\bfL":"\\boldsymbol{L}","\\bfM":"\\boldsymbol{M}","\\bfN":"\\boldsymbol{N}","\\bfO":"\\boldsymbol{O}","\\bfP":"\\boldsymbol{P}","\\bfQ":"\\boldsymbol{Q}","\\bfR":"\\boldsymbol{R}","\\bfS":"\\boldsymbol{S}","\\bfT":"\\boldsymbol{T}","\\bfU":"\\boldsymbol{U}","\\bfV":"\\boldsymbol{V}","\\bfW":"\\boldsymbol{W}","\\bfX":"\\boldsymbol{X}","\\bfY":"\\boldsymbol{Y}","\\bfZ":"\\boldsymbol{Z}"}});</script></span> passed into the kernel is <span class="moose-katex-inline-equation" id="moose-equation-9bbacad7-b0f0-4079-9997-f778a989ca87"><script>var element = document.getElementById("moose-equation-9bbacad7-b0f0-4079-9997-f778a989ca87");katex.render("D\\cdot h_j \\cdot a_{jk}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\grad":"\\bs{\\nabla}","\\divergence":"\\grad \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\abs":"\\left\\lvert#1\\right\\rvert","\\tr":"\\text{tr}","\\dev":"\\text{dev}","\\sym":"\\text{sym}","\\diff":"\\text{ d}#1","\\activepart":"{\\left< A \\right>}","\\inactivepart":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\ep":"{\\varepsilon^p}","\\ep0":"{\\varepsilon_0^p}","\\epdot":"{\\dot{\\varepsilon}}^p","\\epdot0":"{\\dot{\\varepsilon}}_0^p","\\bfa":"\\boldsymbol{a}","\\bfb":"\\boldsymbol{b}","\\bfc":"\\boldsymbol{c}","\\bfd":"\\boldsymbol{d}","\\bfe":"\\boldsymbol{e}","\\bff":"\\boldsymbol{f}","\\bfg":"\\boldsymbol{g}","\\bfh":"\\boldsymbol{h}","\\bfi":"\\boldsymbol{i}","\\bfj":"\\boldsymbol{j}","\\bfk":"\\boldsymbol{k}","\\bfl":"\\boldsymbol{l}","\\bfm":"\\boldsymbol{m}","\\bfn":"\\boldsymbol{n}","\\bfo":"\\boldsymbol{o}","\\bfp":"\\boldsymbol{p}","\\bfq":"\\boldsymbol{q}","\\bfr":"\\boldsymbol{r}","\\bfs":"\\boldsymbol{s}","\\bft":"\\boldsymbol{t}","\\bfu":"\\boldsymbol{u}","\\bfv":"\\boldsymbol{v}","\\bfw":"\\boldsymbol{w}","\\bfx":"\\boldsymbol{x}","\\bfy":"\\boldsymbol{y}","\\bfz":"\\boldsymbol{z}","\\bfA":"\\boldsymbol{A}","\\bfB":"\\boldsymbol{B}","\\bfC":"\\boldsymbol{C}","\\bfD":"\\boldsymbol{D}","\\bfE":"\\boldsymbol{E}","\\bfF":"\\boldsymbol{F}","\\bfG":"\\boldsymbol{G}","\\bfH":"\\boldsymbol{H}","\\bfI":"\\boldsymbol{I}","\\bfJ":"\\boldsymbol{J}","\\bfK":"\\boldsymbol{K}","\\bfL":"\\boldsymbol{L}","\\bfM":"\\boldsymbol{M}","\\bfN":"\\boldsymbol{N}","\\bfO":"\\boldsymbol{O}","\\bfP":"\\boldsymbol{P}","\\bfQ":"\\boldsymbol{Q}","\\bfR":"\\boldsymbol{R}","\\bfS":"\\boldsymbol{S}","\\bfT":"\\boldsymbol{T}","\\bfU":"\\boldsymbol{U}","\\bfV":"\\boldsymbol{V}","\\bfW":"\\boldsymbol{W}","\\bfX":"\\boldsymbol{X}","\\bfY":"\\boldsymbol{Y}","\\bfZ":"\\boldsymbol{Z}"}});</script></span>, which can be provided by a <a href="../../../source/materials/DerivativeParsedMaterial.html"><code>DerivativeParsedMaterial</code></a></p><pre style="max-height:350px;"><code class="language-text">
[D&#x27;i]
  type = DerivativeParsedMaterial
  f_name = D&#x27;i
  function = Di*hi*ajk
  material_property_names = &#x27;Di hi&#x27;
  constant_names = ajk
  constant_expressions = 1/3
[]
</code></pre><p>Here we assume the site fraction of the current sublattice to be <span class="moose-katex-inline-equation" id="moose-equation-b12c20f5-86e9-4e14-8e85-bcfeb373b412"><script>var element = document.getElementById("moose-equation-b12c20f5-86e9-4e14-8e85-bcfeb373b412");katex.render("1/3", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\grad":"\\bs{\\nabla}","\\divergence":"\\grad \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\abs":"\\left\\lvert#1\\right\\rvert","\\tr":"\\text{tr}","\\dev":"\\text{dev}","\\sym":"\\text{sym}","\\diff":"\\text{ d}#1","\\activepart":"{\\left< A \\right>}","\\inactivepart":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\ep":"{\\varepsilon^p}","\\ep0":"{\\varepsilon_0^p}","\\epdot":"{\\dot{\\varepsilon}}^p","\\epdot0":"{\\dot{\\varepsilon}}_0^p","\\bfa":"\\boldsymbol{a}","\\bfb":"\\boldsymbol{b}","\\bfc":"\\boldsymbol{c}","\\bfd":"\\boldsymbol{d}","\\bfe":"\\boldsymbol{e}","\\bff":"\\boldsymbol{f}","\\bfg":"\\boldsymbol{g}","\\bfh":"\\boldsymbol{h}","\\bfi":"\\boldsymbol{i}","\\bfj":"\\boldsymbol{j}","\\bfk":"\\boldsymbol{k}","\\bfl":"\\boldsymbol{l}","\\bfm":"\\boldsymbol{m}","\\bfn":"\\boldsymbol{n}","\\bfo":"\\boldsymbol{o}","\\bfp":"\\boldsymbol{p}","\\bfq":"\\boldsymbol{q}","\\bfr":"\\boldsymbol{r}","\\bfs":"\\boldsymbol{s}","\\bft":"\\boldsymbol{t}","\\bfu":"\\boldsymbol{u}","\\bfv":"\\boldsymbol{v}","\\bfw":"\\boldsymbol{w}","\\bfx":"\\boldsymbol{x}","\\bfy":"\\boldsymbol{y}","\\bfz":"\\boldsymbol{z}","\\bfA":"\\boldsymbol{A}","\\bfB":"\\boldsymbol{B}","\\bfC":"\\boldsymbol{C}","\\bfD":"\\boldsymbol{D}","\\bfE":"\\boldsymbol{E}","\\bfF":"\\boldsymbol{F}","\\bfG":"\\boldsymbol{G}","\\bfH":"\\boldsymbol{H}","\\bfI":"\\boldsymbol{I}","\\bfJ":"\\boldsymbol{J}","\\bfK":"\\boldsymbol{K}","\\bfL":"\\boldsymbol{L}","\\bfM":"\\boldsymbol{M}","\\bfN":"\\boldsymbol{N}","\\bfO":"\\boldsymbol{O}","\\bfP":"\\boldsymbol{P}","\\bfQ":"\\boldsymbol{Q}","\\bfR":"\\boldsymbol{R}","\\bfS":"\\boldsymbol{S}","\\bfT":"\\boldsymbol{T}","\\bfU":"\\boldsymbol{U}","\\bfV":"\\boldsymbol{V}","\\bfW":"\\boldsymbol{W}","\\bfX":"\\boldsymbol{X}","\\bfY":"\\boldsymbol{Y}","\\bfZ":"\\boldsymbol{Z}"}});</script></span>.</p><div class="card moose-alert moose-alert-note"><div class="card-title moose-alert-title"><i class="material-icons moose-inline-icon">comment</i><span class="moose-alert-title-brand">note:</span>Extension to phase/sublattice dependent diffusivities</div><div class="card-content"><div class="moose-alert-content"><p>The derivation should be check to see if a phase dependent concentration <span class="moose-katex-inline-equation" id="moose-equation-6e7a88b9-5d5d-4ac6-a398-20e188e7bcda"><script>var element = document.getElementById("moose-equation-6e7a88b9-5d5d-4ac6-a398-20e188e7bcda");katex.render("D_{ij}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\grad":"\\bs{\\nabla}","\\divergence":"\\grad \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\abs":"\\left\\lvert#1\\right\\rvert","\\tr":"\\text{tr}","\\dev":"\\text{dev}","\\sym":"\\text{sym}","\\diff":"\\text{ d}#1","\\activepart":"{\\left< A \\right>}","\\inactivepart":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\ep":"{\\varepsilon^p}","\\ep0":"{\\varepsilon_0^p}","\\epdot":"{\\dot{\\varepsilon}}^p","\\epdot0":"{\\dot{\\varepsilon}}_0^p","\\bfa":"\\boldsymbol{a}","\\bfb":"\\boldsymbol{b}","\\bfc":"\\boldsymbol{c}","\\bfd":"\\boldsymbol{d}","\\bfe":"\\boldsymbol{e}","\\bff":"\\boldsymbol{f}","\\bfg":"\\boldsymbol{g}","\\bfh":"\\boldsymbol{h}","\\bfi":"\\boldsymbol{i}","\\bfj":"\\boldsymbol{j}","\\bfk":"\\boldsymbol{k}","\\bfl":"\\boldsymbol{l}","\\bfm":"\\boldsymbol{m}","\\bfn":"\\boldsymbol{n}","\\bfo":"\\boldsymbol{o}","\\bfp":"\\boldsymbol{p}","\\bfq":"\\boldsymbol{q}","\\bfr":"\\boldsymbol{r}","\\bfs":"\\boldsymbol{s}","\\bft":"\\boldsymbol{t}","\\bfu":"\\boldsymbol{u}","\\bfv":"\\boldsymbol{v}","\\bfw":"\\boldsymbol{w}","\\bfx":"\\boldsymbol{x}","\\bfy":"\\boldsymbol{y}","\\bfz":"\\boldsymbol{z}","\\bfA":"\\boldsymbol{A}","\\bfB":"\\boldsymbol{B}","\\bfC":"\\boldsymbol{C}","\\bfD":"\\boldsymbol{D}","\\bfE":"\\boldsymbol{E}","\\bfF":"\\boldsymbol{F}","\\bfG":"\\boldsymbol{G}","\\bfH":"\\boldsymbol{H}","\\bfI":"\\boldsymbol{I}","\\bfJ":"\\boldsymbol{J}","\\bfK":"\\boldsymbol{K}","\\bfL":"\\boldsymbol{L}","\\bfM":"\\boldsymbol{M}","\\bfN":"\\boldsymbol{N}","\\bfO":"\\boldsymbol{O}","\\bfP":"\\boldsymbol{P}","\\bfQ":"\\boldsymbol{Q}","\\bfR":"\\boldsymbol{R}","\\bfS":"\\boldsymbol{S}","\\bfT":"\\boldsymbol{T}","\\bfU":"\\boldsymbol{U}","\\bfV":"\\boldsymbol{V}","\\bfW":"\\boldsymbol{W}","\\bfX":"\\boldsymbol{X}","\\bfY":"\\boldsymbol{Y}","\\bfZ":"\\boldsymbol{Z}"}});</script></span> or even sublattice dependent concentration <span class="moose-katex-inline-equation" id="moose-equation-8a648e1b-4e0b-4223-bcca-393c478366a6"><script>var element = document.getElementById("moose-equation-8a648e1b-4e0b-4223-bcca-393c478366a6");katex.render("D_{ijk}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\grad":"\\bs{\\nabla}","\\divergence":"\\grad \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\abs":"\\left\\lvert#1\\right\\rvert","\\tr":"\\text{tr}","\\dev":"\\text{dev}","\\sym":"\\text{sym}","\\diff":"\\text{ d}#1","\\activepart":"{\\left< A \\right>}","\\inactivepart":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\ep":"{\\varepsilon^p}","\\ep0":"{\\varepsilon_0^p}","\\epdot":"{\\dot{\\varepsilon}}^p","\\epdot0":"{\\dot{\\varepsilon}}_0^p","\\bfa":"\\boldsymbol{a}","\\bfb":"\\boldsymbol{b}","\\bfc":"\\boldsymbol{c}","\\bfd":"\\boldsymbol{d}","\\bfe":"\\boldsymbol{e}","\\bff":"\\boldsymbol{f}","\\bfg":"\\boldsymbol{g}","\\bfh":"\\boldsymbol{h}","\\bfi":"\\boldsymbol{i}","\\bfj":"\\boldsymbol{j}","\\bfk":"\\boldsymbol{k}","\\bfl":"\\boldsymbol{l}","\\bfm":"\\boldsymbol{m}","\\bfn":"\\boldsymbol{n}","\\bfo":"\\boldsymbol{o}","\\bfp":"\\boldsymbol{p}","\\bfq":"\\boldsymbol{q}","\\bfr":"\\boldsymbol{r}","\\bfs":"\\boldsymbol{s}","\\bft":"\\boldsymbol{t}","\\bfu":"\\boldsymbol{u}","\\bfv":"\\boldsymbol{v}","\\bfw":"\\boldsymbol{w}","\\bfx":"\\boldsymbol{x}","\\bfy":"\\boldsymbol{y}","\\bfz":"\\boldsymbol{z}","\\bfA":"\\boldsymbol{A}","\\bfB":"\\boldsymbol{B}","\\bfC":"\\boldsymbol{C}","\\bfD":"\\boldsymbol{D}","\\bfE":"\\boldsymbol{E}","\\bfF":"\\boldsymbol{F}","\\bfG":"\\boldsymbol{G}","\\bfH":"\\boldsymbol{H}","\\bfI":"\\boldsymbol{I}","\\bfJ":"\\boldsymbol{J}","\\bfK":"\\boldsymbol{K}","\\bfL":"\\boldsymbol{L}","\\bfM":"\\boldsymbol{M}","\\bfN":"\\boldsymbol{N}","\\bfO":"\\boldsymbol{O}","\\bfP":"\\boldsymbol{P}","\\bfQ":"\\boldsymbol{Q}","\\bfR":"\\boldsymbol{R}","\\bfS":"\\boldsymbol{S}","\\bfT":"\\boldsymbol{T}","\\bfU":"\\boldsymbol{U}","\\bfV":"\\boldsymbol{V}","\\bfW":"\\boldsymbol{W}","\\bfX":"\\boldsymbol{X}","\\bfY":"\\boldsymbol{Y}","\\bfZ":"\\boldsymbol{Z}"}});</script></span> is feasible.</p></div></div></div></section><section id="a165cc4c-b6ca-42f4-80fc-700d09384907" data-section-level="2" data-section-text="Example"><h2 id="example">Example</h2><p>An open TDB file for the Fe-Cr system was graciously provided by Aurélie Jacob at TU Wien, based on the work in <a href="#jacob2018revised">Jacob et al. (2018)</a>.</p><p>The TDB file can be converted into MOOSE <a href="../../../source/materials/DerivativeParsedMaterial.html"><code>DerivativeParsedMaterial</code></a> syntax using the <a href="../CALPHAD.html"><code>free_energy.py</code> script</a>.</p><pre style="max-height:350px;"><code class="language-text">
mamba activate pycalphad
cd $MOOSE_DIR/modules/phase_field/examples/slkks
../../../../python/calphad/free_energy.py CrFe_Jacob.tdb BCC_A2 SIGMA
</code></pre><p>The example directory also contains an Jupyter notebook to visualize the phase diagram for the supplied Fe-Cr thermodynamic database file and the simulation results,</p><pre style="max-height:350px;"><code class="language-moose">#
# SLKKS two phase example for the BCC and SIGMA phases. The sigma phase contains
# multiple sublattices. Free energy from
# Jacob, Aurelie, Erwin Povoden-Karadeniz, and Ernst Kozeschnik. &quot;Revised thermodynamic
# description of the Fe-Cr system based on an improved sublattice model of the sigma phase.&quot;
# Calphad 60 (2018): 16-28.
#
# In this simulation we consider diffusion (Cahn-Hilliard) and phase transformation.
#
# This example requires CrFe_sigma_out_var_0001.csv file, which generated by first
# running the CrFe_sigma.i input file.

[Mesh&lt;&lt;&lt;{&quot;href&quot;: &quot;../../../syntax/Mesh/index.html&quot;}&gt;&gt;&gt;]
  [gen]
    type = GeneratedMeshGenerator&lt;&lt;&lt;{&quot;description&quot;: &quot;Create a line, square, or cube mesh with uniformly spaced or biased elements.&quot;, &quot;href&quot;: &quot;../../../source/meshgenerators/GeneratedMeshGenerator.html&quot;}&gt;&gt;&gt;
    dim&lt;&lt;&lt;{&quot;description&quot;: &quot;The dimension of the mesh to be generated&quot;}&gt;&gt;&gt; = 2
    nx&lt;&lt;&lt;{&quot;description&quot;: &quot;Number of elements in the X direction&quot;}&gt;&gt;&gt; = 160
    ny&lt;&lt;&lt;{&quot;description&quot;: &quot;Number of elements in the Y direction&quot;}&gt;&gt;&gt; = 1
    nz&lt;&lt;&lt;{&quot;description&quot;: &quot;Number of elements in the Z direction&quot;}&gt;&gt;&gt; = 0
    xmin&lt;&lt;&lt;{&quot;description&quot;: &quot;Lower X Coordinate of the generated mesh&quot;}&gt;&gt;&gt; = -25
    xmax&lt;&lt;&lt;{&quot;description&quot;: &quot;Upper X Coordinate of the generated mesh&quot;}&gt;&gt;&gt; = 25
    ymin&lt;&lt;&lt;{&quot;description&quot;: &quot;Lower Y Coordinate of the generated mesh&quot;}&gt;&gt;&gt; = -2.5
    ymax&lt;&lt;&lt;{&quot;description&quot;: &quot;Upper Y Coordinate of the generated mesh&quot;}&gt;&gt;&gt; = 2.5
    elem_type&lt;&lt;&lt;{&quot;description&quot;: &quot;The type of element from libMesh to generate (default: linear element for requested dimension)&quot;}&gt;&gt;&gt; = QUAD4
  []
[]

[AuxVariables&lt;&lt;&lt;{&quot;href&quot;: &quot;../../../syntax/AuxVariables/index.html&quot;}&gt;&gt;&gt;]
  [Fglobal]
    order&lt;&lt;&lt;{&quot;description&quot;: &quot;Specifies the order of the FE shape function to use for this variable (additional orders not listed are allowed)&quot;}&gt;&gt;&gt; = CONSTANT
    family&lt;&lt;&lt;{&quot;description&quot;: &quot;Specifies the family of FE shape functions to use for this variable&quot;}&gt;&gt;&gt; = MONOMIAL
  []
[]

[Functions&lt;&lt;&lt;{&quot;href&quot;: &quot;../../../syntax/Functions/index.html&quot;}&gt;&gt;&gt;]
  [sigma_cr0]
    type = PiecewiseLinear&lt;&lt;&lt;{&quot;description&quot;: &quot;Linearly interpolates between pairs of x-y data&quot;, &quot;href&quot;: &quot;../../../source/functions/PiecewiseLinear.html&quot;}&gt;&gt;&gt;
    data_file&lt;&lt;&lt;{&quot;description&quot;: &quot;File holding CSV data&quot;}&gt;&gt;&gt; = CrFe_sigma_out_var_0001.csv
    format&lt;&lt;&lt;{&quot;description&quot;: &quot;Format of csv data file that is in either in columns or rows&quot;}&gt;&gt;&gt; = columns
    x_index_in_file&lt;&lt;&lt;{&quot;description&quot;: &quot;The abscissa index in the data file&quot;}&gt;&gt;&gt; = 5
    y_index_in_file&lt;&lt;&lt;{&quot;description&quot;: &quot;The ordinate index in the data file&quot;}&gt;&gt;&gt; = 2
    xy_in_file_only&lt;&lt;&lt;{&quot;description&quot;: &quot;If the data file only contains abscissa and ordinate data&quot;}&gt;&gt;&gt; = false
  []
  [sigma_cr1]
    type = PiecewiseLinear&lt;&lt;&lt;{&quot;description&quot;: &quot;Linearly interpolates between pairs of x-y data&quot;, &quot;href&quot;: &quot;../../../source/functions/PiecewiseLinear.html&quot;}&gt;&gt;&gt;
    data_file&lt;&lt;&lt;{&quot;description&quot;: &quot;File holding CSV data&quot;}&gt;&gt;&gt; = CrFe_sigma_out_var_0001.csv
    format&lt;&lt;&lt;{&quot;description&quot;: &quot;Format of csv data file that is in either in columns or rows&quot;}&gt;&gt;&gt; = columns
    x_index_in_file&lt;&lt;&lt;{&quot;description&quot;: &quot;The abscissa index in the data file&quot;}&gt;&gt;&gt; = 5
    y_index_in_file&lt;&lt;&lt;{&quot;description&quot;: &quot;The ordinate index in the data file&quot;}&gt;&gt;&gt; = 3
    xy_in_file_only&lt;&lt;&lt;{&quot;description&quot;: &quot;If the data file only contains abscissa and ordinate data&quot;}&gt;&gt;&gt; = false
  []
  [sigma_cr2]
    type = PiecewiseLinear&lt;&lt;&lt;{&quot;description&quot;: &quot;Linearly interpolates between pairs of x-y data&quot;, &quot;href&quot;: &quot;../../../source/functions/PiecewiseLinear.html&quot;}&gt;&gt;&gt;
    data_file&lt;&lt;&lt;{&quot;description&quot;: &quot;File holding CSV data&quot;}&gt;&gt;&gt; = CrFe_sigma_out_var_0001.csv
    format&lt;&lt;&lt;{&quot;description&quot;: &quot;Format of csv data file that is in either in columns or rows&quot;}&gt;&gt;&gt; = columns
    x_index_in_file&lt;&lt;&lt;{&quot;description&quot;: &quot;The abscissa index in the data file&quot;}&gt;&gt;&gt; = 5
    y_index_in_file&lt;&lt;&lt;{&quot;description&quot;: &quot;The ordinate index in the data file&quot;}&gt;&gt;&gt; = 4
    xy_in_file_only&lt;&lt;&lt;{&quot;description&quot;: &quot;If the data file only contains abscissa and ordinate data&quot;}&gt;&gt;&gt; = false
  []
[]

[Variables&lt;&lt;&lt;{&quot;href&quot;: &quot;../../../syntax/Variables/index.html&quot;}&gt;&gt;&gt;]
  # order parameters
  [eta1]
    order&lt;&lt;&lt;{&quot;description&quot;: &quot;Specifies the order of the FE shape function to use for this variable (additional orders not listed are allowed)&quot;}&gt;&gt;&gt; = FIRST
    family&lt;&lt;&lt;{&quot;description&quot;: &quot;Specifies the family of FE shape functions to use for this variable&quot;}&gt;&gt;&gt; = LAGRANGE
    initial_condition&lt;&lt;&lt;{&quot;description&quot;: &quot;Specifies a constant initial condition for this variable&quot;}&gt;&gt;&gt; = 0.5
  []
  [eta2]
    order&lt;&lt;&lt;{&quot;description&quot;: &quot;Specifies the order of the FE shape function to use for this variable (additional orders not listed are allowed)&quot;}&gt;&gt;&gt; = FIRST
    family&lt;&lt;&lt;{&quot;description&quot;: &quot;Specifies the family of FE shape functions to use for this variable&quot;}&gt;&gt;&gt; = LAGRANGE
    initial_condition&lt;&lt;&lt;{&quot;description&quot;: &quot;Specifies a constant initial condition for this variable&quot;}&gt;&gt;&gt; = 0.5
  []

  # solute concentration
  [cCr]
    order&lt;&lt;&lt;{&quot;description&quot;: &quot;Specifies the order of the FE shape function to use for this variable (additional orders not listed are allowed)&quot;}&gt;&gt;&gt; = FIRST
    family&lt;&lt;&lt;{&quot;description&quot;: &quot;Specifies the family of FE shape functions to use for this variable&quot;}&gt;&gt;&gt; = LAGRANGE
    [InitialCondition]
      type = FunctionIC
      function = &#x27;(x+25)/50*0.5+0.1&#x27;
    []
  []

  # sublattice concentrations
  [BCC_CR]
    initial_condition&lt;&lt;&lt;{&quot;description&quot;: &quot;Specifies a constant initial condition for this variable&quot;}&gt;&gt;&gt; = 0.45
  []
  [SIGMA_0CR]
    [InitialCondition]
      type = CoupledValueFunctionIC
      function = sigma_cr0
      v = cCr
      variable = SIGMA_0CR
    []
  []
  [SIGMA_1CR]
    [InitialCondition]
      type = CoupledValueFunctionIC
      function = sigma_cr1
      v = cCr
      variable = SIGMA_1CR
    []
  []
  [SIGMA_2CR]
    [InitialCondition]
      type = CoupledValueFunctionIC
      function = sigma_cr2
      v = cCr
      variable = SIGMA_2CR
    []
  []
  # Lagrange multiplier
  [lambda]
  []
[]

[Materials&lt;&lt;&lt;{&quot;href&quot;: &quot;../../../syntax/Materials/index.html&quot;}&gt;&gt;&gt;]
  # CALPHAD free energies
  [F_BCC_A2]
    type = DerivativeParsedMaterial&lt;&lt;&lt;{&quot;description&quot;: &quot;Parsed Function Material with automatic derivatives.&quot;, &quot;href&quot;: &quot;../../../source/materials/DerivativeParsedMaterial.html&quot;}&gt;&gt;&gt;
    property_name&lt;&lt;&lt;{&quot;description&quot;: &quot;Name of the parsed material property&quot;}&gt;&gt;&gt; = F_BCC_A2
    outputs&lt;&lt;&lt;{&quot;description&quot;: &quot;Vector of output names where you would like to restrict the output of variables(s) associated with this object&quot;}&gt;&gt;&gt; = exodus
    output_properties&lt;&lt;&lt;{&quot;description&quot;: &quot;List of material properties, from this material, to output (outputs must also be defined to an output type)&quot;}&gt;&gt;&gt; = F_BCC_A2
    expression&lt;&lt;&lt;{&quot;description&quot;: &quot;Parsed function (see FParser) expression for the parsed material&quot;}&gt;&gt;&gt; = &#x27;BCC_FE:=1-BCC_CR; G := 8.3145*T*(1.0*if(BCC_CR &gt; 1.0e-15,BCC_CR*log(BCC_CR),0) + &#x27;
               &#x27;1.0*if(BCC_FE &gt; 1.0e-15,BCC_FE*plog(BCC_FE,eps),0) + 3.0*if(BCC_VA &gt; &#x27;
               &#x27;1.0e-15,BCC_VA*log(BCC_VA),0))/(BCC_CR + BCC_FE) + 8.3145*T*if(T &lt; &#x27;
               &#x27;548.2*BCC_CR*BCC_FE*BCC_VA*(BCC_CR - BCC_FE) - 932.5*BCC_CR*BCC_FE*BCC_VA + &#x27;
               &#x27;311.5*BCC_CR*BCC_VA - &#x27;
               &#x27;1043.0*BCC_FE*BCC_VA,-8.13674105561218e-49*T^15/(0.525599232981783*BCC_CR*BCC_FE*BCC_&#x27;
               &#x27;VA*(BCC_CR - BCC_FE) - 0.894055608820709*BCC_CR*BCC_FE*BCC_VA + &#x27;
               &#x27;0.298657718120805*BCC_CR*BCC_VA - BCC_FE*BCC_VA + 9.58772770853308e-13)^15 - &#x27;
               &#x27;4.65558036243985e-30*T^9/(0.525599232981783*BCC_CR*BCC_FE*BCC_VA*(BCC_CR - BCC_FE) - &#x27;
               &#x27;0.894055608820709*BCC_CR*BCC_FE*BCC_VA + 0.298657718120805*BCC_CR*BCC_VA - &#x27;
               &#x27;BCC_FE*BCC_VA + 9.58772770853308e-13)^9 - &#x27;
               &#x27;1.3485349181899e-10*T^3/(0.525599232981783*BCC_CR*BCC_FE*BCC_VA*(BCC_CR - BCC_FE) - &#x27;
               &#x27;0.894055608820709*BCC_CR*BCC_FE*BCC_VA + 0.298657718120805*BCC_CR*BCC_VA - &#x27;
               &#x27;BCC_FE*BCC_VA + 9.58772770853308e-13)^3 + 1 - &#x27;
               &#x27;0.905299382744392*(548.2*BCC_CR*BCC_FE*BCC_VA*(BCC_CR - BCC_FE) - &#x27;
               &#x27;932.5*BCC_CR*BCC_FE*BCC_VA + 311.5*BCC_CR*BCC_VA - 1043.0*BCC_FE*BCC_VA + &#x27;
               &#x27;1.0e-9)/T,if(T &lt; -548.2*BCC_CR*BCC_FE*BCC_VA*(BCC_CR - BCC_FE) + &#x27;
               &#x27;932.5*BCC_CR*BCC_FE*BCC_VA - 311.5*BCC_CR*BCC_VA + &#x27;
               &#x27;1043.0*BCC_FE*BCC_VA,-8.13674105561218e-49*T^15/(-0.525599232981783*BCC_CR*BCC_FE*BCC&#x27;
               &#x27;_VA*(BCC_CR - BCC_FE) + 0.894055608820709*BCC_CR*BCC_FE*BCC_VA - &#x27;
               &#x27;0.298657718120805*BCC_CR*BCC_VA + BCC_FE*BCC_VA + 9.58772770853308e-13)^15 - &#x27;
               &#x27;4.65558036243985e-30*T^9/(-0.525599232981783*BCC_CR*BCC_FE*BCC_VA*(BCC_CR - BCC_FE) &#x27;
               &#x27;+ 0.894055608820709*BCC_CR*BCC_FE*BCC_VA - 0.298657718120805*BCC_CR*BCC_VA + &#x27;
               &#x27;BCC_FE*BCC_VA + 9.58772770853308e-13)^9 - &#x27;
               &#x27;1.3485349181899e-10*T^3/(-0.525599232981783*BCC_CR*BCC_FE*BCC_VA*(BCC_CR - BCC_FE) + &#x27;
               &#x27;0.894055608820709*BCC_CR*BCC_FE*BCC_VA - 0.298657718120805*BCC_CR*BCC_VA + &#x27;
               &#x27;BCC_FE*BCC_VA + 9.58772770853308e-13)^3 + 1 - &#x27;
               &#x27;0.905299382744392*(-548.2*BCC_CR*BCC_FE*BCC_VA*(BCC_CR - BCC_FE) + &#x27;
               &#x27;932.5*BCC_CR*BCC_FE*BCC_VA - 311.5*BCC_CR*BCC_VA + 1043.0*BCC_FE*BCC_VA + &#x27;
               &#x27;1.0e-9)/T,if(T &gt; -548.2*BCC_CR*BCC_FE*BCC_VA*(BCC_CR - BCC_FE) + &#x27;
               &#x27;932.5*BCC_CR*BCC_FE*BCC_VA - 311.5*BCC_CR*BCC_VA + 1043.0*BCC_FE*BCC_VA &amp; &#x27;
               &#x27;548.2*BCC_CR*BCC_FE*BCC_VA*(BCC_CR - BCC_FE) - 932.5*BCC_CR*BCC_FE*BCC_VA + &#x27;
               &#x27;311.5*BCC_CR*BCC_VA - 1043.0*BCC_FE*BCC_VA &lt; &#x27;
               &#x27;0,-79209031311018.7*(-0.525599232981783*BCC_CR*BCC_FE*BCC_VA*(BCC_CR - BCC_FE) + &#x27;
               &#x27;0.894055608820709*BCC_CR*BCC_FE*BCC_VA - 0.298657718120805*BCC_CR*BCC_VA + &#x27;
               &#x27;BCC_FE*BCC_VA + 9.58772770853308e-13)^5/T^5 - &#x27;
               &#x27;3.83095660520737e+42*(-0.525599232981783*BCC_CR*BCC_FE*BCC_VA*(BCC_CR - BCC_FE) + &#x27;
               &#x27;0.894055608820709*BCC_CR*BCC_FE*BCC_VA - 0.298657718120805*BCC_CR*BCC_VA + &#x27;
               &#x27;BCC_FE*BCC_VA + 9.58772770853308e-13)^15/T^15 - &#x27;
               &#x27;1.22565886734485e+72*(-0.525599232981783*BCC_CR*BCC_FE*BCC_VA*(BCC_CR - BCC_FE) + &#x27;
               &#x27;0.894055608820709*BCC_CR*BCC_FE*BCC_VA - 0.298657718120805*BCC_CR*BCC_VA + &#x27;
               &#x27;BCC_FE*BCC_VA + 9.58772770853308e-13)^25/T^25,if(T &gt; &#x27;
               &#x27;548.2*BCC_CR*BCC_FE*BCC_VA*(BCC_CR - BCC_FE) - 932.5*BCC_CR*BCC_FE*BCC_VA + &#x27;
               &#x27;311.5*BCC_CR*BCC_VA - 1043.0*BCC_FE*BCC_VA &amp; 548.2*BCC_CR*BCC_FE*BCC_VA*(BCC_CR - &#x27;
               &#x27;BCC_FE) - 932.5*BCC_CR*BCC_FE*BCC_VA + 311.5*BCC_CR*BCC_VA - 1043.0*BCC_FE*BCC_VA &gt; &#x27;
               &#x27;0,-79209031311018.7*(0.525599232981783*BCC_CR*BCC_FE*BCC_VA*(BCC_CR - BCC_FE) - &#x27;
               &#x27;0.894055608820709*BCC_CR*BCC_FE*BCC_VA + 0.298657718120805*BCC_CR*BCC_VA - &#x27;
               &#x27;BCC_FE*BCC_VA + 9.58772770853308e-13)^5/T^5 - &#x27;
               &#x27;3.83095660520737e+42*(0.525599232981783*BCC_CR*BCC_FE*BCC_VA*(BCC_CR - BCC_FE) - &#x27;
               &#x27;0.894055608820709*BCC_CR*BCC_FE*BCC_VA + 0.298657718120805*BCC_CR*BCC_VA - &#x27;
               &#x27;BCC_FE*BCC_VA + 9.58772770853308e-13)^15/T^15 - &#x27;
               &#x27;1.22565886734485e+72*(0.525599232981783*BCC_CR*BCC_FE*BCC_VA*(BCC_CR - BCC_FE) - &#x27;
               &#x27;0.894055608820709*BCC_CR*BCC_FE*BCC_VA + 0.298657718120805*BCC_CR*BCC_VA - &#x27;
               &#x27;BCC_FE*BCC_VA + 9.58772770853308e-13)^25/T^25,0))))*log((2.15*BCC_CR*BCC_FE*BCC_VA - &#x27;
               &#x27;0.008*BCC_CR*BCC_VA + 2.22*BCC_FE*BCC_VA)*if(2.15*BCC_CR*BCC_FE*BCC_VA - &#x27;
               &#x27;0.008*BCC_CR*BCC_VA + 2.22*BCC_FE*BCC_VA &lt;= 0,-1.0,1.0) + 1)/(BCC_CR + BCC_FE) + &#x27;
               &#x27;1.0*(BCC_CR*BCC_VA*if(T &gt;= 298.15 &amp; T &lt; 2180.0,139250.0*1/T - 26.908*T*log(T) + &#x27;
               &#x27;157.48*T + 0.00189435*T^2.0 - 1.47721e-6*T^3.0 - 8856.94,if(T &gt;= 2180.0 &amp; T &lt; &#x27;
               &#x27;6000.0,-2.88526e+32*T^(-9.0) - 50.0*T*log(T) + 344.18*T - 34869.344,0)) + &#x27;
               &#x27;BCC_FE*BCC_VA*if(T &gt;= 298.15 &amp; T &lt; 1811.0,77358.5*1/T - 23.5143*T*log(T) + 124.134*T &#x27;
               &#x27;- 0.00439752*T^2.0 - 5.89269e-8*T^3.0 + 1225.7,if(T &gt;= 1811.0 &amp; T &lt; &#x27;
               &#x27;6000.0,2.2960305e+31*T^(-9.0) - 46.0*T*log(T) + 299.31255*T - 25383.581,0)))/(BCC_CR &#x27;
               &#x27;+ BCC_FE) + 1.0*(BCC_CR*BCC_FE*BCC_VA*(500.0 - 1.5*T)*(BCC_CR - BCC_FE) + &#x27;
               &#x27;BCC_CR*BCC_FE*BCC_VA*(24600.0 - 14.98*T) + BCC_CR*BCC_FE*BCC_VA*(9.15*T - &#x27;
               &#x27;14000.0)*(BCC_CR - BCC_FE)^2)/(BCC_CR + BCC_FE); G/100000&#x27;
    coupled_variables&lt;&lt;&lt;{&quot;description&quot;: &quot;Vector of variables used in the parsed function&quot;}&gt;&gt;&gt; = &#x27;BCC_CR&#x27;
    constant_names&lt;&lt;&lt;{&quot;description&quot;: &quot;Vector of constants used in the parsed function (use this for kB etc.)&quot;}&gt;&gt;&gt; = &#x27;BCC_VA T eps&#x27;
    constant_expressions&lt;&lt;&lt;{&quot;description&quot;: &quot;Vector of values for the constants in constant_names (can be an FParser expression)&quot;}&gt;&gt;&gt; = &#x27;1 1000 0.01&#x27;
  []

  [F_SIGMA]
    type = DerivativeParsedMaterial&lt;&lt;&lt;{&quot;description&quot;: &quot;Parsed Function Material with automatic derivatives.&quot;, &quot;href&quot;: &quot;../../../source/materials/DerivativeParsedMaterial.html&quot;}&gt;&gt;&gt;
    property_name&lt;&lt;&lt;{&quot;description&quot;: &quot;Name of the parsed material property&quot;}&gt;&gt;&gt; = F_SIGMA
    outputs&lt;&lt;&lt;{&quot;description&quot;: &quot;Vector of output names where you would like to restrict the output of variables(s) associated with this object&quot;}&gt;&gt;&gt; = exodus
    output_properties&lt;&lt;&lt;{&quot;description&quot;: &quot;List of material properties, from this material, to output (outputs must also be defined to an output type)&quot;}&gt;&gt;&gt; = F_SIGMA
    expression&lt;&lt;&lt;{&quot;description&quot;: &quot;Parsed function (see FParser) expression for the parsed material&quot;}&gt;&gt;&gt; = &#x27;SIGMA_0FE := 1-SIGMA_0CR; SIGMA_1FE := 1-SIGMA_1CR; SIGMA_2FE := 1-SIGMA_2CR; G := &#x27;
               &#x27;8.3145*T*(10.0*if(SIGMA_0CR &gt; 1.0e-15,SIGMA_0CR*plog(SIGMA_0CR,eps),0) + &#x27;
               &#x27;10.0*if(SIGMA_0FE &gt; 1.0e-15,SIGMA_0FE*plog(SIGMA_0FE,eps),0) + 4.0*if(SIGMA_1CR &gt; &#x27;
               &#x27;1.0e-15,SIGMA_1CR*plog(SIGMA_1CR,eps),0) + 4.0*if(SIGMA_1FE &gt; &#x27;
               &#x27;1.0e-15,SIGMA_1FE*plog(SIGMA_1FE,eps),0) + 16.0*if(SIGMA_2CR &gt; &#x27;
               &#x27;1.0e-15,SIGMA_2CR*plog(SIGMA_2CR,eps),0) + 16.0*if(SIGMA_2FE &gt; &#x27;
               &#x27;1.0e-15,SIGMA_2FE*plog(SIGMA_2FE,eps),0))/(10.0*SIGMA_0CR + 10.0*SIGMA_0FE + &#x27;
               &#x27;4.0*SIGMA_1CR + 4.0*SIGMA_1FE + 16.0*SIGMA_2CR + 16.0*SIGMA_2FE) + &#x27;
               &#x27;(SIGMA_0FE*SIGMA_1CR*SIGMA_2CR*SIGMA_2FE*(-70.0*T - 170400.0) + &#x27;
               &#x27;SIGMA_0FE*SIGMA_1FE*SIGMA_2CR*SIGMA_2FE*(-10.0*T - 330839.0))/(10.0*SIGMA_0CR + &#x27;
               &#x27;10.0*SIGMA_0FE + 4.0*SIGMA_1CR + 4.0*SIGMA_1FE + 16.0*SIGMA_2CR + 16.0*SIGMA_2FE) + &#x27;
               &#x27;(SIGMA_0CR*SIGMA_1CR*SIGMA_2CR*(30.0*if(T &gt;= 298.15 &amp; T &lt; 2180.0,139250.0*1/T - &#x27;
               &#x27;26.908*T*log(T) + 157.48*T + 0.00189435*T^2.0 - 1.47721e-6*T^3.0 - 8856.94,if(T &gt;= &#x27;
               &#x27;2180.0 &amp; T &lt; 6000.0,-2.88526e+32*T^(-9.0) - 50.0*T*log(T) + 344.18*T - 34869.344,0)) &#x27;
               &#x27;+ 132000.0) + SIGMA_0CR*SIGMA_1CR*SIGMA_2FE*(-110.0*T + 16.0*if(T &gt;= 298.15 &amp; T &lt; &#x27;
               &#x27;1811.0,77358.5*1/T - 23.5143*T*log(T) + 124.134*T - 0.00439752*T^2.0 - &#x27;
               &#x27;5.89269e-8*T^3.0 + 1225.7,if(T &gt;= 1811.0 &amp; T &lt; 6000.0,2.2960305e+31*T^(-9.0) - &#x27;
               &#x27;46.0*T*log(T) + 299.31255*T - 25383.581,0)) + 14.0*if(T &gt;= 298.15 &amp; T &lt; &#x27;
               &#x27;2180.0,139250.0*1/T - 26.908*T*log(T) + 157.48*T + 0.00189435*T^2.0 - &#x27;
               &#x27;1.47721e-6*T^3.0 - 8856.94,if(T &gt;= 2180.0 &amp; T &lt; 6000.0,-2.88526e+32*T^(-9.0) - &#x27;
               &#x27;50.0*T*log(T) + 344.18*T - 34869.344,0)) + 123500.0) + &#x27;
               &#x27;SIGMA_0CR*SIGMA_1FE*SIGMA_2CR*(4.0*if(T &gt;= 298.15 &amp; T &lt; 1811.0,77358.5*1/T - &#x27;
               &#x27;23.5143*T*log(T) + 124.134*T - 0.00439752*T^2.0 - 5.89269e-8*T^3.0 + 1225.7,if(T &gt;= &#x27;
               &#x27;1811.0 &amp; T &lt; 6000.0,2.2960305e+31*T^(-9.0) - 46.0*T*log(T) + 299.31255*T - &#x27;
               &#x27;25383.581,0)) + 26.0*if(T &gt;= 298.15 &amp; T &lt; 2180.0,139250.0*1/T - 26.908*T*log(T) + &#x27;
               &#x27;157.48*T + 0.00189435*T^2.0 - 1.47721e-6*T^3.0 - 8856.94,if(T &gt;= 2180.0 &amp; T &lt; &#x27;
               &#x27;6000.0,-2.88526e+32*T^(-9.0) - 50.0*T*log(T) + 344.18*T - 34869.344,0)) + 140486.0) &#x27;
               &#x27;+ SIGMA_0CR*SIGMA_1FE*SIGMA_2FE*(20.0*if(T &gt;= 298.15 &amp; T &lt; 1811.0,77358.5*1/T - &#x27;
               &#x27;23.5143*T*log(T) + 124.134*T - 0.00439752*T^2.0 - 5.89269e-8*T^3.0 + 1225.7,if(T &gt;= &#x27;
               &#x27;1811.0 &amp; T &lt; 6000.0,2.2960305e+31*T^(-9.0) - 46.0*T*log(T) + 299.31255*T - &#x27;
               &#x27;25383.581,0)) + 10.0*if(T &gt;= 298.15 &amp; T &lt; 2180.0,139250.0*1/T - 26.908*T*log(T) + &#x27;
               &#x27;157.48*T + 0.00189435*T^2.0 - 1.47721e-6*T^3.0 - 8856.94,if(T &gt;= 2180.0 &amp; T &lt; &#x27;
               &#x27;6000.0,-2.88526e+32*T^(-9.0) - 50.0*T*log(T) + 344.18*T - 34869.344,0)) + 148800.0) &#x27;
               &#x27;+ SIGMA_0FE*SIGMA_1CR*SIGMA_2CR*(10.0*if(T &gt;= 298.15 &amp; T &lt; 1811.0,77358.5*1/T - &#x27;
               &#x27;23.5143*T*log(T) + 124.134*T - 0.00439752*T^2.0 - 5.89269e-8*T^3.0 + 1225.7,if(T &gt;= &#x27;
               &#x27;1811.0 &amp; T &lt; 6000.0,2.2960305e+31*T^(-9.0) - 46.0*T*log(T) + 299.31255*T - &#x27;
               &#x27;25383.581,0)) + 20.0*if(T &gt;= 298.15 &amp; T &lt; 2180.0,139250.0*1/T - 26.908*T*log(T) + &#x27;
               &#x27;157.48*T + 0.00189435*T^2.0 - 1.47721e-6*T^3.0 - 8856.94,if(T &gt;= 2180.0 &amp; T &lt; &#x27;
               &#x27;6000.0,-2.88526e+32*T^(-9.0) - 50.0*T*log(T) + 344.18*T - 34869.344,0)) + 56200.0) + &#x27;
               &#x27;SIGMA_0FE*SIGMA_1CR*SIGMA_2FE*(26.0*if(T &gt;= 298.15 &amp; T &lt; 1811.0,77358.5*1/T - &#x27;
               &#x27;23.5143*T*log(T) + 124.134*T - 0.00439752*T^2.0 - 5.89269e-8*T^3.0 + 1225.7,if(T &gt;= &#x27;
               &#x27;1811.0 &amp; T &lt; 6000.0,2.2960305e+31*T^(-9.0) - 46.0*T*log(T) + 299.31255*T - &#x27;
               &#x27;25383.581,0)) + 4.0*if(T &gt;= 298.15 &amp; T &lt; 2180.0,139250.0*1/T - 26.908*T*log(T) + &#x27;
               &#x27;157.48*T + 0.00189435*T^2.0 - 1.47721e-6*T^3.0 - 8856.94,if(T &gt;= 2180.0 &amp; T &lt; &#x27;
               &#x27;6000.0,-2.88526e+32*T^(-9.0) - 50.0*T*log(T) + 344.18*T - 34869.344,0)) + 152700.0) &#x27;
               &#x27;+ SIGMA_0FE*SIGMA_1FE*SIGMA_2CR*(14.0*if(T &gt;= 298.15 &amp; T &lt; 1811.0,77358.5*1/T - &#x27;
               &#x27;23.5143*T*log(T) + 124.134*T - 0.00439752*T^2.0 - 5.89269e-8*T^3.0 + 1225.7,if(T &gt;= &#x27;
               &#x27;1811.0 &amp; T &lt; 6000.0,2.2960305e+31*T^(-9.0) - 46.0*T*log(T) + 299.31255*T - &#x27;
               &#x27;25383.581,0)) + 16.0*if(T &gt;= 298.15 &amp; T &lt; 2180.0,139250.0*1/T - 26.908*T*log(T) + &#x27;
               &#x27;157.48*T + 0.00189435*T^2.0 - 1.47721e-6*T^3.0 - 8856.94,if(T &gt;= 2180.0 &amp; T &lt; &#x27;
               &#x27;6000.0,-2.88526e+32*T^(-9.0) - 50.0*T*log(T) + 344.18*T - 34869.344,0)) + 46200.0) + &#x27;
               &#x27;SIGMA_0FE*SIGMA_1FE*SIGMA_2FE*(30.0*if(T &gt;= 298.15 &amp; T &lt; 1811.0,77358.5*1/T - &#x27;
               &#x27;23.5143*T*log(T) + 124.134*T - 0.00439752*T^2.0 - 5.89269e-8*T^3.0 + 1225.7,if(T &gt;= &#x27;
               &#x27;1811.0 &amp; T &lt; 6000.0,2.2960305e+31*T^(-9.0) - 46.0*T*log(T) + 299.31255*T - &#x27;
               &#x27;25383.581,0)) + 173333.0))/(10.0*SIGMA_0CR + 10.0*SIGMA_0FE + 4.0*SIGMA_1CR + &#x27;
               &#x27;4.0*SIGMA_1FE + 16.0*SIGMA_2CR + 16.0*SIGMA_2FE); G/100000&#x27;
    coupled_variables&lt;&lt;&lt;{&quot;description&quot;: &quot;Vector of variables used in the parsed function&quot;}&gt;&gt;&gt; = &#x27;SIGMA_0CR SIGMA_1CR SIGMA_2CR&#x27;
    constant_names&lt;&lt;&lt;{&quot;description&quot;: &quot;Vector of constants used in the parsed function (use this for kB etc.)&quot;}&gt;&gt;&gt; = &#x27;T eps&#x27;
    constant_expressions&lt;&lt;&lt;{&quot;description&quot;: &quot;Vector of values for the constants in constant_names (can be an FParser expression)&quot;}&gt;&gt;&gt; = &#x27;1000 0.01&#x27;
  []

  # h(eta)
  [h1]
    type = SwitchingFunctionMaterial&lt;&lt;&lt;{&quot;description&quot;: &quot;Helper material to provide $h(\\eta)$ and its derivative in one of two polynomial forms.\nSIMPLE: $3\\eta^2-2\\eta^3$\nHIGH: $\\eta^3(6\\eta^2-15\\eta+10)$&quot;, &quot;href&quot;: &quot;../../../source/materials/SwitchingFunctionMaterial.html&quot;}&gt;&gt;&gt;
    function_name&lt;&lt;&lt;{&quot;description&quot;: &quot;actual name for f(eta), i.e. &#x27;h&#x27; or &#x27;g&#x27;&quot;}&gt;&gt;&gt; = h1
    h_order&lt;&lt;&lt;{&quot;description&quot;: &quot;Polynomial order of the switching function h(eta)&quot;}&gt;&gt;&gt; = HIGH
    eta&lt;&lt;&lt;{&quot;description&quot;: &quot;Order parameter variable&quot;}&gt;&gt;&gt; = eta1
  []
  [h2]
    type = SwitchingFunctionMaterial&lt;&lt;&lt;{&quot;description&quot;: &quot;Helper material to provide $h(\\eta)$ and its derivative in one of two polynomial forms.\nSIMPLE: $3\\eta^2-2\\eta^3$\nHIGH: $\\eta^3(6\\eta^2-15\\eta+10)$&quot;, &quot;href&quot;: &quot;../../../source/materials/SwitchingFunctionMaterial.html&quot;}&gt;&gt;&gt;
    function_name&lt;&lt;&lt;{&quot;description&quot;: &quot;actual name for f(eta), i.e. &#x27;h&#x27; or &#x27;g&#x27;&quot;}&gt;&gt;&gt; = h2
    h_order&lt;&lt;&lt;{&quot;description&quot;: &quot;Polynomial order of the switching function h(eta)&quot;}&gt;&gt;&gt; = HIGH
    eta&lt;&lt;&lt;{&quot;description&quot;: &quot;Order parameter variable&quot;}&gt;&gt;&gt; = eta2
  []

  # g(eta)
  [g1]
    type = BarrierFunctionMaterial&lt;&lt;&lt;{&quot;description&quot;: &quot;Helper material to provide $g(\\eta)$ and its derivative in a polynomial.\nSIMPLE: $\\eta^2(1-\\eta)^2$\nLOW: $\\eta(1-\\eta)$\nHIGH: $\\eta^2(1-\\eta^2)^2$&quot;, &quot;href&quot;: &quot;../../../source/materials/BarrierFunctionMaterial.html&quot;}&gt;&gt;&gt;
    function_name&lt;&lt;&lt;{&quot;description&quot;: &quot;actual name for f(eta), i.e. &#x27;h&#x27; or &#x27;g&#x27;&quot;}&gt;&gt;&gt; = g1
    g_order&lt;&lt;&lt;{&quot;description&quot;: &quot;Polynomial order of the barrier function g(eta)&quot;}&gt;&gt;&gt; = SIMPLE
    eta&lt;&lt;&lt;{&quot;description&quot;: &quot;Order parameter variable&quot;}&gt;&gt;&gt; = eta1
  []
  [g2]
    type = BarrierFunctionMaterial&lt;&lt;&lt;{&quot;description&quot;: &quot;Helper material to provide $g(\\eta)$ and its derivative in a polynomial.\nSIMPLE: $\\eta^2(1-\\eta)^2$\nLOW: $\\eta(1-\\eta)$\nHIGH: $\\eta^2(1-\\eta^2)^2$&quot;, &quot;href&quot;: &quot;../../../source/materials/BarrierFunctionMaterial.html&quot;}&gt;&gt;&gt;
    function_name&lt;&lt;&lt;{&quot;description&quot;: &quot;actual name for f(eta), i.e. &#x27;h&#x27; or &#x27;g&#x27;&quot;}&gt;&gt;&gt; = g2
    g_order&lt;&lt;&lt;{&quot;description&quot;: &quot;Polynomial order of the barrier function g(eta)&quot;}&gt;&gt;&gt; = SIMPLE
    eta&lt;&lt;&lt;{&quot;description&quot;: &quot;Order parameter variable&quot;}&gt;&gt;&gt; = eta2
  []

  # constant properties
  [constants]
    type = GenericConstantMaterial&lt;&lt;&lt;{&quot;description&quot;: &quot;Declares material properties based on names and values prescribed by input parameters.&quot;, &quot;href&quot;: &quot;../../../source/materials/GenericConstantMaterial.html&quot;}&gt;&gt;&gt;
    prop_names&lt;&lt;&lt;{&quot;description&quot;: &quot;The names of the properties this material will have&quot;}&gt;&gt;&gt; = &#x27;D   L   kappa&#x27;
    prop_values&lt;&lt;&lt;{&quot;description&quot;: &quot;The values associated with the named properties&quot;}&gt;&gt;&gt; = &#x27;10  1   0.1  &#x27;
  []

  # Coefficients for diffusion equation
  [Dh1]
    type = DerivativeParsedMaterial&lt;&lt;&lt;{&quot;description&quot;: &quot;Parsed Function Material with automatic derivatives.&quot;, &quot;href&quot;: &quot;../../../source/materials/DerivativeParsedMaterial.html&quot;}&gt;&gt;&gt;
    material_property_names&lt;&lt;&lt;{&quot;description&quot;: &quot;Vector of material properties used in the parsed function&quot;}&gt;&gt;&gt; = &#x27;D h1(eta1)&#x27;
    expression&lt;&lt;&lt;{&quot;description&quot;: &quot;Parsed function (see FParser) expression for the parsed material&quot;}&gt;&gt;&gt; = D*h1
    property_name&lt;&lt;&lt;{&quot;description&quot;: &quot;Name of the parsed material property&quot;}&gt;&gt;&gt; = Dh1
    coupled_variables&lt;&lt;&lt;{&quot;description&quot;: &quot;Vector of variables used in the parsed function&quot;}&gt;&gt;&gt; = eta1
    derivative_order&lt;&lt;&lt;{&quot;description&quot;: &quot;Maximum order of derivatives taken&quot;}&gt;&gt;&gt; = 1
  []
  [Dh2a]
    type = DerivativeParsedMaterial&lt;&lt;&lt;{&quot;description&quot;: &quot;Parsed Function Material with automatic derivatives.&quot;, &quot;href&quot;: &quot;../../../source/materials/DerivativeParsedMaterial.html&quot;}&gt;&gt;&gt;
    material_property_names&lt;&lt;&lt;{&quot;description&quot;: &quot;Vector of material properties used in the parsed function&quot;}&gt;&gt;&gt; = &#x27;D h2(eta2)&#x27;
    expression&lt;&lt;&lt;{&quot;description&quot;: &quot;Parsed function (see FParser) expression for the parsed material&quot;}&gt;&gt;&gt; = D*h2*10/30
    property_name&lt;&lt;&lt;{&quot;description&quot;: &quot;Name of the parsed material property&quot;}&gt;&gt;&gt; = Dh2a
    coupled_variables&lt;&lt;&lt;{&quot;description&quot;: &quot;Vector of variables used in the parsed function&quot;}&gt;&gt;&gt; = eta2
    derivative_order&lt;&lt;&lt;{&quot;description&quot;: &quot;Maximum order of derivatives taken&quot;}&gt;&gt;&gt; = 1
  []
  [Dh2b]
    type = DerivativeParsedMaterial&lt;&lt;&lt;{&quot;description&quot;: &quot;Parsed Function Material with automatic derivatives.&quot;, &quot;href&quot;: &quot;../../../source/materials/DerivativeParsedMaterial.html&quot;}&gt;&gt;&gt;
    material_property_names&lt;&lt;&lt;{&quot;description&quot;: &quot;Vector of material properties used in the parsed function&quot;}&gt;&gt;&gt; = &#x27;D h2(eta2)&#x27;
    expression&lt;&lt;&lt;{&quot;description&quot;: &quot;Parsed function (see FParser) expression for the parsed material&quot;}&gt;&gt;&gt; = D*h2*4/30
    property_name&lt;&lt;&lt;{&quot;description&quot;: &quot;Name of the parsed material property&quot;}&gt;&gt;&gt; = Dh2b
    coupled_variables&lt;&lt;&lt;{&quot;description&quot;: &quot;Vector of variables used in the parsed function&quot;}&gt;&gt;&gt; = eta2
    derivative_order&lt;&lt;&lt;{&quot;description&quot;: &quot;Maximum order of derivatives taken&quot;}&gt;&gt;&gt; = 1
  []
  [Dh2c]
    type = DerivativeParsedMaterial&lt;&lt;&lt;{&quot;description&quot;: &quot;Parsed Function Material with automatic derivatives.&quot;, &quot;href&quot;: &quot;../../../source/materials/DerivativeParsedMaterial.html&quot;}&gt;&gt;&gt;
    material_property_names&lt;&lt;&lt;{&quot;description&quot;: &quot;Vector of material properties used in the parsed function&quot;}&gt;&gt;&gt; = &#x27;D h2(eta2)&#x27;
    expression&lt;&lt;&lt;{&quot;description&quot;: &quot;Parsed function (see FParser) expression for the parsed material&quot;}&gt;&gt;&gt; = D*h2*16/30
    property_name&lt;&lt;&lt;{&quot;description&quot;: &quot;Name of the parsed material property&quot;}&gt;&gt;&gt; = Dh2c
    coupled_variables&lt;&lt;&lt;{&quot;description&quot;: &quot;Vector of variables used in the parsed function&quot;}&gt;&gt;&gt; = eta2
    derivative_order&lt;&lt;&lt;{&quot;description&quot;: &quot;Maximum order of derivatives taken&quot;}&gt;&gt;&gt; = 1
  []
[]

[Kernels&lt;&lt;&lt;{&quot;href&quot;: &quot;../../../syntax/Kernels/index.html&quot;}&gt;&gt;&gt;]
  #Kernels for diffusion equation
  [diff_time]
    type = TimeDerivative&lt;&lt;&lt;{&quot;description&quot;: &quot;The time derivative operator with the weak form of $(\\psi_i, \\frac{\\partial u_h}{\\partial t})$.&quot;, &quot;href&quot;: &quot;../../../source/kernels/TimeDerivative.html&quot;}&gt;&gt;&gt;
    variable&lt;&lt;&lt;{&quot;description&quot;: &quot;The name of the variable that this residual object operates on&quot;}&gt;&gt;&gt; = cCr
  []
  [diff_c1]
    type = MatDiffusion&lt;&lt;&lt;{&quot;description&quot;: &quot;Diffusion equation Kernel that takes an isotropic Diffusivity from a material property&quot;, &quot;href&quot;: &quot;../../../source/kernels/MatDiffusion.html&quot;}&gt;&gt;&gt;
    variable&lt;&lt;&lt;{&quot;description&quot;: &quot;The name of the variable that this residual object operates on&quot;}&gt;&gt;&gt; = cCr
    diffusivity&lt;&lt;&lt;{&quot;description&quot;: &quot;The diffusivity value or material property&quot;}&gt;&gt;&gt; = Dh1
    v&lt;&lt;&lt;{&quot;description&quot;: &quot;Coupled concentration variable for kernel to operate on; if this is not specified, the kernel&#x27;s nonlinear variable will be used as usual&quot;}&gt;&gt;&gt; = BCC_CR
    args&lt;&lt;&lt;{&quot;description&quot;: &quot;Optional vector of arguments for the diffusivity. If provided and diffusivity is a derivative parsed material, Jacobian contributions from the diffusivity will be automatically computed&quot;}&gt;&gt;&gt; = eta1
  []
  [diff_c2a]
    type = MatDiffusion&lt;&lt;&lt;{&quot;description&quot;: &quot;Diffusion equation Kernel that takes an isotropic Diffusivity from a material property&quot;, &quot;href&quot;: &quot;../../../source/kernels/MatDiffusion.html&quot;}&gt;&gt;&gt;
    variable&lt;&lt;&lt;{&quot;description&quot;: &quot;The name of the variable that this residual object operates on&quot;}&gt;&gt;&gt; = cCr
    diffusivity&lt;&lt;&lt;{&quot;description&quot;: &quot;The diffusivity value or material property&quot;}&gt;&gt;&gt; = Dh2a
    v&lt;&lt;&lt;{&quot;description&quot;: &quot;Coupled concentration variable for kernel to operate on; if this is not specified, the kernel&#x27;s nonlinear variable will be used as usual&quot;}&gt;&gt;&gt; = SIGMA_0CR
    args&lt;&lt;&lt;{&quot;description&quot;: &quot;Optional vector of arguments for the diffusivity. If provided and diffusivity is a derivative parsed material, Jacobian contributions from the diffusivity will be automatically computed&quot;}&gt;&gt;&gt; = eta2
  []
  [diff_c2b]
    type = MatDiffusion&lt;&lt;&lt;{&quot;description&quot;: &quot;Diffusion equation Kernel that takes an isotropic Diffusivity from a material property&quot;, &quot;href&quot;: &quot;../../../source/kernels/MatDiffusion.html&quot;}&gt;&gt;&gt;
    variable&lt;&lt;&lt;{&quot;description&quot;: &quot;The name of the variable that this residual object operates on&quot;}&gt;&gt;&gt; = cCr
    diffusivity&lt;&lt;&lt;{&quot;description&quot;: &quot;The diffusivity value or material property&quot;}&gt;&gt;&gt; = Dh2b
    v&lt;&lt;&lt;{&quot;description&quot;: &quot;Coupled concentration variable for kernel to operate on; if this is not specified, the kernel&#x27;s nonlinear variable will be used as usual&quot;}&gt;&gt;&gt; = SIGMA_1CR
    args&lt;&lt;&lt;{&quot;description&quot;: &quot;Optional vector of arguments for the diffusivity. If provided and diffusivity is a derivative parsed material, Jacobian contributions from the diffusivity will be automatically computed&quot;}&gt;&gt;&gt; = eta2
  []
  [diff_c2c]
    type = MatDiffusion&lt;&lt;&lt;{&quot;description&quot;: &quot;Diffusion equation Kernel that takes an isotropic Diffusivity from a material property&quot;, &quot;href&quot;: &quot;../../../source/kernels/MatDiffusion.html&quot;}&gt;&gt;&gt;
    variable&lt;&lt;&lt;{&quot;description&quot;: &quot;The name of the variable that this residual object operates on&quot;}&gt;&gt;&gt; = cCr
    diffusivity&lt;&lt;&lt;{&quot;description&quot;: &quot;The diffusivity value or material property&quot;}&gt;&gt;&gt; = Dh2c
    v&lt;&lt;&lt;{&quot;description&quot;: &quot;Coupled concentration variable for kernel to operate on; if this is not specified, the kernel&#x27;s nonlinear variable will be used as usual&quot;}&gt;&gt;&gt; = SIGMA_2CR
    args&lt;&lt;&lt;{&quot;description&quot;: &quot;Optional vector of arguments for the diffusivity. If provided and diffusivity is a derivative parsed material, Jacobian contributions from the diffusivity will be automatically computed&quot;}&gt;&gt;&gt; = eta2
  []

  # enforce pointwise equality of chemical potentials
  [chempot1a2a]
    # The BCC phase has only one sublattice
    # we tie it to the first sublattice with site fraction 10/(10+4+16) in the sigma phase
    type = KKSPhaseChemicalPotential&lt;&lt;&lt;{&quot;description&quot;: &quot;KKS model kernel to enforce the pointwise equality of phase chemical potentials $dF_a/dc_a = dF_b/dc_b$. The non-linear variable of this kernel is $c_a$.&quot;, &quot;href&quot;: &quot;../../../source/kernels/KKSPhaseChemicalPotential.html&quot;}&gt;&gt;&gt;
    variable&lt;&lt;&lt;{&quot;description&quot;: &quot;The name of the variable that this residual object operates on&quot;}&gt;&gt;&gt; = BCC_CR
    cb&lt;&lt;&lt;{&quot;description&quot;: &quot;Phase b concentration&quot;}&gt;&gt;&gt; = SIGMA_0CR
    kb&lt;&lt;&lt;{&quot;description&quot;: &quot;Site fraction for the cb variable (specify this if ca is a sublattice concentration, and make sure it is a true site fraction eg. 0.6666666) &quot;}&gt;&gt;&gt; = &#x27;${fparse 10/30}&#x27;
    fa_name&lt;&lt;&lt;{&quot;description&quot;: &quot;Base name of the free energy function Fa (f_name in the corresponding derivative function material)&quot;}&gt;&gt;&gt; = F_BCC_A2
    fb_name&lt;&lt;&lt;{&quot;description&quot;: &quot;Base name of the free energy function Fb (f_name in the corresponding derivative function material)&quot;}&gt;&gt;&gt; = F_SIGMA
    args_b&lt;&lt;&lt;{&quot;description&quot;: &quot;Vector of further parameters to Fb (optional, to add in second cross derivatives of Fb)&quot;}&gt;&gt;&gt; = &#x27;SIGMA_1CR SIGMA_2CR&#x27;
  []
  [chempot2a2b]
    # This kernel ties the first two sublattices in the sigma phase together
    type = SLKKSChemicalPotential&lt;&lt;&lt;{&quot;description&quot;: &quot;SLKKS model kernel to enforce the pointwise equality of sublattice chemical potentials in the same phase.&quot;, &quot;href&quot;: &quot;../../../source/kernels/SLKKSChemicalPotential.html&quot;}&gt;&gt;&gt;
    variable&lt;&lt;&lt;{&quot;description&quot;: &quot;The name of the variable that this residual object operates on&quot;}&gt;&gt;&gt; = SIGMA_0CR
    a&lt;&lt;&lt;{&quot;description&quot;: &quot;sublattice site fraction for the kernel variable&quot;}&gt;&gt;&gt; = 10
    cs&lt;&lt;&lt;{&quot;description&quot;: &quot;other sublattice concentration in the same phase&quot;}&gt;&gt;&gt; = SIGMA_1CR
    as&lt;&lt;&lt;{&quot;description&quot;: &quot;other sublattice site fraction in the same phase&quot;}&gt;&gt;&gt; = 4
    F&lt;&lt;&lt;{&quot;description&quot;: &quot;Base name of the free energy function&quot;}&gt;&gt;&gt; = F_SIGMA
    coupled_variables&lt;&lt;&lt;{&quot;description&quot;: &quot;Vector of variable arguments to the free energy function&quot;}&gt;&gt;&gt; = &#x27;SIGMA_2CR&#x27;
  []
  [chempot2b2c]
    # This kernel ties the remaining two sublattices in the sigma phase together
    type = SLKKSChemicalPotential&lt;&lt;&lt;{&quot;description&quot;: &quot;SLKKS model kernel to enforce the pointwise equality of sublattice chemical potentials in the same phase.&quot;, &quot;href&quot;: &quot;../../../source/kernels/SLKKSChemicalPotential.html&quot;}&gt;&gt;&gt;
    variable&lt;&lt;&lt;{&quot;description&quot;: &quot;The name of the variable that this residual object operates on&quot;}&gt;&gt;&gt; = SIGMA_1CR
    a&lt;&lt;&lt;{&quot;description&quot;: &quot;sublattice site fraction for the kernel variable&quot;}&gt;&gt;&gt; = 4
    cs&lt;&lt;&lt;{&quot;description&quot;: &quot;other sublattice concentration in the same phase&quot;}&gt;&gt;&gt; = SIGMA_2CR
    as&lt;&lt;&lt;{&quot;description&quot;: &quot;other sublattice site fraction in the same phase&quot;}&gt;&gt;&gt; = 16
    F&lt;&lt;&lt;{&quot;description&quot;: &quot;Base name of the free energy function&quot;}&gt;&gt;&gt; = F_SIGMA
    coupled_variables&lt;&lt;&lt;{&quot;description&quot;: &quot;Vector of variable arguments to the free energy function&quot;}&gt;&gt;&gt; = &#x27;SIGMA_0CR&#x27;
  []

  [phaseconcentration]
    # This kernel ties the sum of the sublattice concentrations to the global concentration cCr
    type = SLKKSMultiPhaseConcentration&lt;&lt;&lt;{&quot;description&quot;: &quot;SLKKS multi-phase model kernel to enforce $c_i = \\sum_j h_j\\sum_k a_{jk} c_{ijk}$. The non-linear variable of this kernel is a phase&#x27;s sublattice concentration&quot;, &quot;href&quot;: &quot;../../../source/kernels/SLKKSMultiPhaseConcentration.html&quot;}&gt;&gt;&gt;
    variable&lt;&lt;&lt;{&quot;description&quot;: &quot;The name of the variable that this residual object operates on&quot;}&gt;&gt;&gt; = SIGMA_2CR
    c&lt;&lt;&lt;{&quot;description&quot;: &quot;Physical concentration&quot;}&gt;&gt;&gt; = cCr
    ns&lt;&lt;&lt;{&quot;description&quot;: &quot;Number of sublattices in each phase&quot;}&gt;&gt;&gt; = &#x27;1      3&#x27;
    as&lt;&lt;&lt;{&quot;description&quot;: &quot;Sublattice site fractions n all phases&quot;}&gt;&gt;&gt; = &#x27;1      10        4         16&#x27;
    cs&lt;&lt;&lt;{&quot;description&quot;: &quot;Array of sublattice concentrations phase for all phases&quot;}&gt;&gt;&gt; = &#x27;BCC_CR SIGMA_0CR SIGMA_1CR SIGMA_2CR&#x27;
    h_names&lt;&lt;&lt;{&quot;description&quot;: &quot;Switching Function Materials for all phases&quot;}&gt;&gt;&gt; = &#x27;h1   h2&#x27;
    eta&lt;&lt;&lt;{&quot;description&quot;: &quot;Order parameters for all phases&quot;}&gt;&gt;&gt; = &#x27;eta1 eta2&#x27;
  []

  # Kernels for Allen-Cahn equation for eta1
  [deta1dt]
    type = TimeDerivative&lt;&lt;&lt;{&quot;description&quot;: &quot;The time derivative operator with the weak form of $(\\psi_i, \\frac{\\partial u_h}{\\partial t})$.&quot;, &quot;href&quot;: &quot;../../../source/kernels/TimeDerivative.html&quot;}&gt;&gt;&gt;
    variable&lt;&lt;&lt;{&quot;description&quot;: &quot;The name of the variable that this residual object operates on&quot;}&gt;&gt;&gt; = eta1
  []
  [ACBulkF1]
    type = KKSMultiACBulkF&lt;&lt;&lt;{&quot;description&quot;: &quot;KKS model kernel (part 1 of 2) for the Bulk Allen-Cahn. This includes all terms NOT dependent on chemical potential.&quot;, &quot;href&quot;: &quot;../../../source/kernels/KKSMultiACBulkF.html&quot;}&gt;&gt;&gt;
    variable&lt;&lt;&lt;{&quot;description&quot;: &quot;The name of the variable that this residual object operates on&quot;}&gt;&gt;&gt; = eta1
    Fj_names&lt;&lt;&lt;{&quot;description&quot;: &quot;List of free energies for each phase. Place in same order as hj_names!&quot;}&gt;&gt;&gt; = &#x27;F_BCC_A2 F_SIGMA&#x27;
    hj_names&lt;&lt;&lt;{&quot;description&quot;: &quot;Switching Function Materials that provide h. Place in same order as Fj_names!&quot;}&gt;&gt;&gt; = &#x27;h1    h2&#x27;
    gi_name&lt;&lt;&lt;{&quot;description&quot;: &quot;Base name for the double well function g_i(eta_i)&quot;}&gt;&gt;&gt; = g1
    eta_i&lt;&lt;&lt;{&quot;description&quot;: &quot;Order parameter that derivatives are taken with respect to&quot;}&gt;&gt;&gt; = eta1
    wi&lt;&lt;&lt;{&quot;description&quot;: &quot;Double well height parameter&quot;}&gt;&gt;&gt; = 0.1
    coupled_variables&lt;&lt;&lt;{&quot;description&quot;: &quot;Vector of nonlinear variable arguments this object depends on&quot;}&gt;&gt;&gt; = &#x27;BCC_CR SIGMA_0CR SIGMA_1CR SIGMA_2CR eta2&#x27;
  []
  [ACBulkC1]
    type = SLKKSMultiACBulkC&lt;&lt;&lt;{&quot;description&quot;: &quot;Multi-phase SLKKS model kernel for the bulk Allen-Cahn. This includes all terms dependent on chemical potential.&quot;, &quot;href&quot;: &quot;../../../source/kernels/SLKKSMultiACBulkC.html&quot;}&gt;&gt;&gt;
    variable&lt;&lt;&lt;{&quot;description&quot;: &quot;The name of the variable that this residual object operates on&quot;}&gt;&gt;&gt; = eta1
    F&lt;&lt;&lt;{&quot;description&quot;: &quot;Phase free energy function that is a function of &#x27;c&#x27;&quot;}&gt;&gt;&gt; = F_BCC_A2
    c&lt;&lt;&lt;{&quot;description&quot;: &quot;Concentration variable F depends on&quot;}&gt;&gt;&gt; = BCC_CR
    ns&lt;&lt;&lt;{&quot;description&quot;: &quot;Number of sublattices in each phase&quot;}&gt;&gt;&gt; = &#x27;1      3&#x27;
    as&lt;&lt;&lt;{&quot;description&quot;: &quot;Sublattice site fractions n all phases&quot;}&gt;&gt;&gt; = &#x27;1      10        4         16&#x27;
    cs&lt;&lt;&lt;{&quot;description&quot;: &quot;Array of sublattice concentrations phase for all phases&quot;}&gt;&gt;&gt; = &#x27;BCC_CR SIGMA_0CR SIGMA_1CR SIGMA_2CR&#x27;
    h_names&lt;&lt;&lt;{&quot;description&quot;: &quot;Switching Function Materials for all phases&quot;}&gt;&gt;&gt; = &#x27;h1   h2&#x27;
    eta&lt;&lt;&lt;{&quot;description&quot;: &quot;Order parameters for all phases&quot;}&gt;&gt;&gt; = &#x27;eta1 eta2&#x27;
  []
  [ACInterface1]
    type = ACInterface&lt;&lt;&lt;{&quot;description&quot;: &quot;Gradient energy Allen-Cahn Kernel&quot;, &quot;href&quot;: &quot;../../../source/kernels/ACInterface.html&quot;}&gt;&gt;&gt;
    variable&lt;&lt;&lt;{&quot;description&quot;: &quot;The name of the variable that this residual object operates on&quot;}&gt;&gt;&gt; = eta1
    kappa_name&lt;&lt;&lt;{&quot;description&quot;: &quot;The kappa used with the kernel&quot;}&gt;&gt;&gt; = kappa
  []
  [lagrange1]
    type = SwitchingFunctionConstraintEta&lt;&lt;&lt;{&quot;description&quot;: &quot;Lagrange multiplier kernel to constrain the sum of all switching functions in a multiphase system. This kernel acts on a non-conserved order parameter eta_i.&quot;, &quot;href&quot;: &quot;../../../source/kernels/SwitchingFunctionConstraintEta.html&quot;}&gt;&gt;&gt;
    variable&lt;&lt;&lt;{&quot;description&quot;: &quot;The name of the variable that this residual object operates on&quot;}&gt;&gt;&gt; = eta1
    h_name&lt;&lt;&lt;{&quot;description&quot;: &quot;Switching Function Materials that provides h(eta_i)&quot;}&gt;&gt;&gt; = h1
    lambda&lt;&lt;&lt;{&quot;description&quot;: &quot;Lagrange multiplier&quot;}&gt;&gt;&gt; = lambda
    coupled_variables&lt;&lt;&lt;{&quot;description&quot;: &quot;Vector of further variable arguments to the switching function&quot;}&gt;&gt;&gt; = &#x27;eta2&#x27;
  []

  # Kernels for Allen-Cahn equation for eta1
  [deta2dt]
    type = TimeDerivative&lt;&lt;&lt;{&quot;description&quot;: &quot;The time derivative operator with the weak form of $(\\psi_i, \\frac{\\partial u_h}{\\partial t})$.&quot;, &quot;href&quot;: &quot;../../../source/kernels/TimeDerivative.html&quot;}&gt;&gt;&gt;
    variable&lt;&lt;&lt;{&quot;description&quot;: &quot;The name of the variable that this residual object operates on&quot;}&gt;&gt;&gt; = eta2
  []
  [ACBulkF2]
    type = KKSMultiACBulkF&lt;&lt;&lt;{&quot;description&quot;: &quot;KKS model kernel (part 1 of 2) for the Bulk Allen-Cahn. This includes all terms NOT dependent on chemical potential.&quot;, &quot;href&quot;: &quot;../../../source/kernels/KKSMultiACBulkF.html&quot;}&gt;&gt;&gt;
    variable&lt;&lt;&lt;{&quot;description&quot;: &quot;The name of the variable that this residual object operates on&quot;}&gt;&gt;&gt; = eta2
    Fj_names&lt;&lt;&lt;{&quot;description&quot;: &quot;List of free energies for each phase. Place in same order as hj_names!&quot;}&gt;&gt;&gt; = &#x27;F_BCC_A2 F_SIGMA&#x27;
    hj_names&lt;&lt;&lt;{&quot;description&quot;: &quot;Switching Function Materials that provide h. Place in same order as Fj_names!&quot;}&gt;&gt;&gt; = &#x27;h1    h2&#x27;
    gi_name&lt;&lt;&lt;{&quot;description&quot;: &quot;Base name for the double well function g_i(eta_i)&quot;}&gt;&gt;&gt; = g2
    eta_i&lt;&lt;&lt;{&quot;description&quot;: &quot;Order parameter that derivatives are taken with respect to&quot;}&gt;&gt;&gt; = eta2
    wi&lt;&lt;&lt;{&quot;description&quot;: &quot;Double well height parameter&quot;}&gt;&gt;&gt; = 0.1
    coupled_variables&lt;&lt;&lt;{&quot;description&quot;: &quot;Vector of nonlinear variable arguments this object depends on&quot;}&gt;&gt;&gt; = &#x27;BCC_CR SIGMA_0CR SIGMA_1CR SIGMA_2CR eta1&#x27;
  []
  [ACBulkC2]
    type = SLKKSMultiACBulkC&lt;&lt;&lt;{&quot;description&quot;: &quot;Multi-phase SLKKS model kernel for the bulk Allen-Cahn. This includes all terms dependent on chemical potential.&quot;, &quot;href&quot;: &quot;../../../source/kernels/SLKKSMultiACBulkC.html&quot;}&gt;&gt;&gt;
    variable&lt;&lt;&lt;{&quot;description&quot;: &quot;The name of the variable that this residual object operates on&quot;}&gt;&gt;&gt; = eta2
    F&lt;&lt;&lt;{&quot;description&quot;: &quot;Phase free energy function that is a function of &#x27;c&#x27;&quot;}&gt;&gt;&gt; = F_BCC_A2
    c&lt;&lt;&lt;{&quot;description&quot;: &quot;Concentration variable F depends on&quot;}&gt;&gt;&gt; = BCC_CR
    ns&lt;&lt;&lt;{&quot;description&quot;: &quot;Number of sublattices in each phase&quot;}&gt;&gt;&gt; = &#x27;1      3&#x27;
    as&lt;&lt;&lt;{&quot;description&quot;: &quot;Sublattice site fractions n all phases&quot;}&gt;&gt;&gt; = &#x27;1      10        4         16&#x27;
    cs&lt;&lt;&lt;{&quot;description&quot;: &quot;Array of sublattice concentrations phase for all phases&quot;}&gt;&gt;&gt; = &#x27;BCC_CR SIGMA_0CR SIGMA_1CR SIGMA_2CR&#x27;
    h_names&lt;&lt;&lt;{&quot;description&quot;: &quot;Switching Function Materials for all phases&quot;}&gt;&gt;&gt; = &#x27;h1   h2&#x27;
    eta&lt;&lt;&lt;{&quot;description&quot;: &quot;Order parameters for all phases&quot;}&gt;&gt;&gt; = &#x27;eta1 eta2&#x27;
  []
  [ACInterface2]
    type = ACInterface&lt;&lt;&lt;{&quot;description&quot;: &quot;Gradient energy Allen-Cahn Kernel&quot;, &quot;href&quot;: &quot;../../../source/kernels/ACInterface.html&quot;}&gt;&gt;&gt;
    variable&lt;&lt;&lt;{&quot;description&quot;: &quot;The name of the variable that this residual object operates on&quot;}&gt;&gt;&gt; = eta2
    kappa_name&lt;&lt;&lt;{&quot;description&quot;: &quot;The kappa used with the kernel&quot;}&gt;&gt;&gt; = kappa
  []
  [lagrange2]
    type = SwitchingFunctionConstraintEta&lt;&lt;&lt;{&quot;description&quot;: &quot;Lagrange multiplier kernel to constrain the sum of all switching functions in a multiphase system. This kernel acts on a non-conserved order parameter eta_i.&quot;, &quot;href&quot;: &quot;../../../source/kernels/SwitchingFunctionConstraintEta.html&quot;}&gt;&gt;&gt;
    variable&lt;&lt;&lt;{&quot;description&quot;: &quot;The name of the variable that this residual object operates on&quot;}&gt;&gt;&gt; = eta2
    h_name&lt;&lt;&lt;{&quot;description&quot;: &quot;Switching Function Materials that provides h(eta_i)&quot;}&gt;&gt;&gt; = h2
    lambda&lt;&lt;&lt;{&quot;description&quot;: &quot;Lagrange multiplier&quot;}&gt;&gt;&gt; = lambda
    coupled_variables&lt;&lt;&lt;{&quot;description&quot;: &quot;Vector of further variable arguments to the switching function&quot;}&gt;&gt;&gt; = &#x27;eta1&#x27;
  []

  # Lagrange-multiplier constraint kernel for lambda
  [lagrange]
    type = SwitchingFunctionConstraintLagrange&lt;&lt;&lt;{&quot;description&quot;: &quot;Lagrange multiplier kernel to constrain the sum of all switching functions in a multiphase system. This kernel acts on the Lagrange multiplier variable.&quot;, &quot;href&quot;: &quot;../../../source/kernels/SwitchingFunctionConstraintLagrange.html&quot;}&gt;&gt;&gt;
    variable&lt;&lt;&lt;{&quot;description&quot;: &quot;The name of the variable that this residual object operates on&quot;}&gt;&gt;&gt; = lambda
    h_names&lt;&lt;&lt;{&quot;description&quot;: &quot;Switching function materials&quot;}&gt;&gt;&gt; = &#x27;h1   h2&#x27;
    etas&lt;&lt;&lt;{&quot;description&quot;: &quot;eta order parameters&quot;}&gt;&gt;&gt; = &#x27;eta1 eta2&#x27;
    epsilon&lt;&lt;&lt;{&quot;description&quot;: &quot;Shift factor to avoid a zero pivot&quot;}&gt;&gt;&gt; = 1e-6
  []
[]

[AuxKernels&lt;&lt;&lt;{&quot;href&quot;: &quot;../../../syntax/AuxKernels/index.html&quot;}&gt;&gt;&gt;]
  [GlobalFreeEnergy]
    type = KKSMultiFreeEnergy&lt;&lt;&lt;{&quot;description&quot;: &quot;Total free energy in multi-phase KKS system, including chemical, barrier and gradient terms&quot;, &quot;href&quot;: &quot;../../../source/auxkernels/KKSMultiFreeEnergy.html&quot;}&gt;&gt;&gt;
    variable&lt;&lt;&lt;{&quot;description&quot;: &quot;The name of the variable that this object applies to&quot;}&gt;&gt;&gt; = Fglobal
    Fj_names&lt;&lt;&lt;{&quot;description&quot;: &quot;List of free energies for each phase. Place in same order as hj_names and gj_names!&quot;}&gt;&gt;&gt; = &#x27;F_BCC_A2 F_SIGMA&#x27;
    hj_names&lt;&lt;&lt;{&quot;description&quot;: &quot;Switching Function Materials that provide h. Place in same order as Fj_names and gj_names!&quot;}&gt;&gt;&gt; = &#x27;h1 h2&#x27;
    gj_names&lt;&lt;&lt;{&quot;description&quot;: &quot;Barrier Function Materials that provide g. Place in same order as Fj_names and hj_names!&quot;}&gt;&gt;&gt; = &#x27;g1 g2&#x27;
    interfacial_vars&lt;&lt;&lt;{&quot;description&quot;: &quot;Variable names that contribute to interfacial energy&quot;}&gt;&gt;&gt; = &#x27;eta1 eta2&#x27;
    kappa_names&lt;&lt;&lt;{&quot;description&quot;: &quot;Vector of kappa names corresponding to each variable name in interfacial_vars in the same order.&quot;}&gt;&gt;&gt; = &#x27;kappa kappa&#x27;
    w&lt;&lt;&lt;{&quot;description&quot;: &quot;Double well height parameter&quot;}&gt;&gt;&gt; = 0.1
  []
[]

[Executioner&lt;&lt;&lt;{&quot;href&quot;: &quot;../../../syntax/Executioner/index.html&quot;}&gt;&gt;&gt;]
  type = Transient
  solve_type = &#x27;NEWTON&#x27;
  line_search = none

  petsc_options_iname = &#x27;-pc_type -sub_pc_type -sub_pc_factor_shift_type -ksp_gmres_restart&#x27;
  petsc_options_value = &#x27;asm      lu          nonzero                    30&#x27;

  l_max_its = 100
  nl_max_its = 20
  nl_abs_tol = 1e-10

  end_time = 10000

  [TimeStepper&lt;&lt;&lt;{&quot;href&quot;: &quot;../../../syntax/Executioner/TimeStepper/index.html&quot;}&gt;&gt;&gt;]
    type = IterationAdaptiveDT
    optimal_iterations = 12
    iteration_window = 2
    growth_factor = 1.5
    cutback_factor = 0.7
    dt = 0.1
  []
[]

[VectorPostprocessors&lt;&lt;&lt;{&quot;href&quot;: &quot;../../../syntax/VectorPostprocessors/index.html&quot;}&gt;&gt;&gt;]
  [var]
    type = LineValueSampler&lt;&lt;&lt;{&quot;description&quot;: &quot;Samples variable(s) along a specified line&quot;, &quot;href&quot;: &quot;../../../source/vectorpostprocessors/LineValueSampler.html&quot;}&gt;&gt;&gt;
    start_point&lt;&lt;&lt;{&quot;description&quot;: &quot;The beginning of the line&quot;}&gt;&gt;&gt; = &#x27;-25 0 0&#x27;
    end_point&lt;&lt;&lt;{&quot;description&quot;: &quot;The ending of the line&quot;}&gt;&gt;&gt; = &#x27;25 0 0&#x27;
    variable&lt;&lt;&lt;{&quot;description&quot;: &quot;The names of the variables that this VectorPostprocessor operates on&quot;}&gt;&gt;&gt; = &#x27;cCr eta1 eta2 SIGMA_0CR SIGMA_1CR SIGMA_2CR&#x27;
    num_points&lt;&lt;&lt;{&quot;description&quot;: &quot;The number of points to sample along the line&quot;}&gt;&gt;&gt; = 151
    sort_by&lt;&lt;&lt;{&quot;description&quot;: &quot;What to sort the samples by&quot;}&gt;&gt;&gt; = id
    execute_on&lt;&lt;&lt;{&quot;description&quot;: &quot;The list of flag(s) indicating when this object should be executed. For a description of each flag, see https://mooseframework.inl.gov/source/interfaces/SetupInterface.html.&quot;}&gt;&gt;&gt; = &#x27;initial timestep_end&#x27;
  []
  [mat]
    type = LineMaterialRealSampler&lt;&lt;&lt;{&quot;description&quot;: &quot;Samples real-valued material properties for all quadrature points in all elements that are intersected by a specified line&quot;, &quot;href&quot;: &quot;../../../source/vectorpostprocessors/LineMaterialRealSampler.html&quot;}&gt;&gt;&gt;
    start&lt;&lt;&lt;{&quot;description&quot;: &quot;The beginning of the line&quot;}&gt;&gt;&gt; = &#x27;-25 0 0&#x27;
    end&lt;&lt;&lt;{&quot;description&quot;: &quot;The end of the line&quot;}&gt;&gt;&gt; = &#x27;25 0 0&#x27;
    property&lt;&lt;&lt;{&quot;description&quot;: &quot;Name of the material property to be output along a line&quot;}&gt;&gt;&gt; = &#x27;F_BCC_A2 F_SIGMA&#x27;
    sort_by&lt;&lt;&lt;{&quot;description&quot;: &quot;What to sort the samples by&quot;}&gt;&gt;&gt; = id
    execute_on&lt;&lt;&lt;{&quot;description&quot;: &quot;The list of flag(s) indicating when this object should be executed. For a description of each flag, see https://mooseframework.inl.gov/source/interfaces/SetupInterface.html.&quot;}&gt;&gt;&gt; = &#x27;initial timestep_end&#x27;
  []
[]

[Postprocessors&lt;&lt;&lt;{&quot;href&quot;: &quot;../../../syntax/Postprocessors/index.html&quot;}&gt;&gt;&gt;]
  [F]
    type = ElementIntegralVariablePostprocessor&lt;&lt;&lt;{&quot;description&quot;: &quot;Computes a volume integral of the specified variable&quot;, &quot;href&quot;: &quot;../../../source/postprocessors/ElementIntegralVariablePostprocessor.html&quot;}&gt;&gt;&gt;
    variable&lt;&lt;&lt;{&quot;description&quot;: &quot;The name of the variable that this object operates on&quot;}&gt;&gt;&gt; = Fglobal
    execute_on&lt;&lt;&lt;{&quot;description&quot;: &quot;The list of flag(s) indicating when this object should be executed. For a description of each flag, see https://mooseframework.inl.gov/source/interfaces/SetupInterface.html.&quot;}&gt;&gt;&gt; = &#x27;initial timestep_end&#x27;
  []
  [cmin]
    type = NodalExtremeValue&lt;&lt;&lt;{&quot;description&quot;: &quot;Finds either the min or max elemental value of a variable over the domain.&quot;, &quot;href&quot;: &quot;../../../source/postprocessors/NodalExtremeValue.html&quot;}&gt;&gt;&gt;
    value_type&lt;&lt;&lt;{&quot;description&quot;: &quot;Type of extreme value to return. &#x27;max&#x27; returns the maximum value. &#x27;min&#x27; returns the minimum value. &#x27;max_abs&#x27; returns the maximum of the absolute value.&quot;}&gt;&gt;&gt; = min
    variable&lt;&lt;&lt;{&quot;description&quot;: &quot;The name of the variable that this postprocessor operates on&quot;}&gt;&gt;&gt; = cCr
    execute_on&lt;&lt;&lt;{&quot;description&quot;: &quot;The list of flag(s) indicating when this object should be executed. For a description of each flag, see https://mooseframework.inl.gov/source/interfaces/SetupInterface.html.&quot;}&gt;&gt;&gt; = &#x27;initial timestep_end&#x27;
  []
  [cmax]
    type = NodalExtremeValue&lt;&lt;&lt;{&quot;description&quot;: &quot;Finds either the min or max elemental value of a variable over the domain.&quot;, &quot;href&quot;: &quot;../../../source/postprocessors/NodalExtremeValue.html&quot;}&gt;&gt;&gt;
    value_type&lt;&lt;&lt;{&quot;description&quot;: &quot;Type of extreme value to return. &#x27;max&#x27; returns the maximum value. &#x27;min&#x27; returns the minimum value. &#x27;max_abs&#x27; returns the maximum of the absolute value.&quot;}&gt;&gt;&gt; = max
    variable&lt;&lt;&lt;{&quot;description&quot;: &quot;The name of the variable that this postprocessor operates on&quot;}&gt;&gt;&gt; = cCr
    execute_on&lt;&lt;&lt;{&quot;description&quot;: &quot;The list of flag(s) indicating when this object should be executed. For a description of each flag, see https://mooseframework.inl.gov/source/interfaces/SetupInterface.html.&quot;}&gt;&gt;&gt; = &#x27;initial timestep_end&#x27;
  []
  [ctotal]
    type = ElementIntegralVariablePostprocessor&lt;&lt;&lt;{&quot;description&quot;: &quot;Computes a volume integral of the specified variable&quot;, &quot;href&quot;: &quot;../../../source/postprocessors/ElementIntegralVariablePostprocessor.html&quot;}&gt;&gt;&gt;
    variable&lt;&lt;&lt;{&quot;description&quot;: &quot;The name of the variable that this object operates on&quot;}&gt;&gt;&gt; = cCr
    execute_on&lt;&lt;&lt;{&quot;description&quot;: &quot;The list of flag(s) indicating when this object should be executed. For a description of each flag, see https://mooseframework.inl.gov/source/interfaces/SetupInterface.html.&quot;}&gt;&gt;&gt; = &#x27;initial timestep_end&#x27;
  []
[]

[Outputs&lt;&lt;&lt;{&quot;href&quot;: &quot;../../../syntax/Outputs/index.html&quot;}&gt;&gt;&gt;]
  exodus&lt;&lt;&lt;{&quot;description&quot;: &quot;Output the results using the default settings for Exodus output.&quot;}&gt;&gt;&gt; = true
  print_linear_residuals&lt;&lt;&lt;{&quot;description&quot;: &quot;Enable printing of linear residuals to the screen (Console)&quot;}&gt;&gt;&gt; = false
  csv&lt;&lt;&lt;{&quot;description&quot;: &quot;Output the scalar variable and postprocessors to a *.csv file using the default CSV output.&quot;}&gt;&gt;&gt; = true
  perf_graph&lt;&lt;&lt;{&quot;description&quot;: &quot;Enable printing of the performance graph to the screen (Console)&quot;}&gt;&gt;&gt; = true
[]</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#beee27d0-c5ca-4f5b-a0f8-68f086ddead5">(moose/modules/phase_field/examples/slkks/CrFe.i)</a></section><section id="12383242-e9af-4f96-8b10-9fa168d90af7" data-section-level="2" data-section-text="References"><h2 id="references">References</h2><div class="moose-bibliography"><ol><li id="jacob2018revised">Aur<span class="bibtex-protected">é</span>lie Jacob, Erwin Povoden-Karadeniz, and Ernst Kozeschnik.
Revised thermodynamic description of the fe-cr system based on an improved sublattice model of the σ phase.
<em>Calphad</em>, 60:16–28, 2018.<a href="#9ed3bbe8-3cac-41c6-8158-a372d37526da" class="modal-trigger moose-bibtex-modal" style="padding-left:10px;">[BibTeX]</a><div class="modal" id="9ed3bbe8-3cac-41c6-8158-a372d37526da"><div class="modal-content"><pre style="line-height:1.25;"><code class="language-latex">@article{jacob2018revised,
    author = "Jacob, Aur{\'e}lie and Povoden-Karadeniz, Erwin and Kozeschnik, Ernst",
    title = "Revised thermodynamic description of the Fe-Cr system based on an improved sublattice model of the $\sigma$ phase",
    journal = "Calphad",
    volume = "60",
    pages = "16--28",
    year = "2018",
    publisher = "Elsevier"
}
</code></pre></div></div></li><li id="Schwen2021">D.&nbsp;Schwen, C.&nbsp;Jiang, and L.K. Aagesen.
A sublattice phase-field model for direct calphad database coupling.
<em>Computational Materials Science</em>, 195:110466, 2021.
URL: <a href="https://www.sciencedirect.com/science/article/pii/S0927025621001919">https://www.sciencedirect.com/science/article/pii/S0927025621001919</a>, <a href="https://doi.org/https://doi.org/10.1016/j.commatsci.2021.110466">doi:https://doi.org/10.1016/j.commatsci.2021.110466</a>.<a href="#41a46663-97d3-4347-b7ba-4de492480fc1" class="modal-trigger moose-bibtex-modal" style="padding-left:10px;">[BibTeX]</a><div class="modal" id="41a46663-97d3-4347-b7ba-4de492480fc1"><div class="modal-content"><pre style="line-height:1.25;"><code class="language-latex">@article{Schwen2021,
    author = "Schwen, D. and Jiang, C. and Aagesen, L.K.",
    title = "A sublattice phase-field model for direct CALPHAD database coupling",
    journal = "Computational Materials Science",
    volume = "195",
    pages = "110466",
    year = "2021",
    issn = "0927-0256",
    doi = "https://doi.org/10.1016/j.commatsci.2021.110466",
    url = "https://www.sciencedirect.com/science/article/pii/S0927025621001919",
    keywords = "Phase-field, CALPHAD, Automatic differentiation",
    abstract = "The phase-field method has been established as a de facto standard for simulating the microstructural evolution of materials. In quantitative modeling the assessment and compilation of thermodynamic/kinetic data is largely dominated by the CALPHAD approach, which has produced a large set of experimentally and computationally generated Gibbs free energy and atomic mobility data in a standardized format: the thermodynamic database (TDB) file format. Harnessing this data for the purpose of phase-field modeling is an ongoing effort encompassing a wide variety of approaches. In this paper, we aim to directly link CALPHAD data to the phase-field method, without intermediate fitting or interpolation steps. We introduce a model based on the Kim-Kim-Suzuki (KKS) approach. This model includes sublattice site fractions and can directly utilize data from TDB files. Using this approach, we demonstrate the model on the U-Zr and Mo-Ni-Re systems."
}
</code></pre></div></div></li></ol></div></section></section><div class="moose-modal modal" id="1b1c9a10-c99e-45db-a390-d8515f837a6d"><div class="modal-content"><h4>v</h4><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector&lt;VariableName&gt;</p><p class="moose-parameter-description-doc-unit"><span>Unit:</span>(no unit assumed)</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>Coupled concentration variable for kernel to operate on; if this is not specified, the kernel's nonlinear variable will be used as usual</p></div></div><div class="moose-modal modal" id="beee27d0-c5ca-4f5b-a0f8-68f086ddead5"><div class="modal-content"><h4>(moose/modules/phase_field/examples/slkks/CrFe.i)</h4><pre style="max-height:350px;"><code class="language-moose">#
# SLKKS two phase example for the BCC and SIGMA phases. The sigma phase contains
# multiple sublattices. Free energy from
# Jacob, Aurelie, Erwin Povoden-Karadeniz, and Ernst Kozeschnik. &quot;Revised thermodynamic
# description of the Fe-Cr system based on an improved sublattice model of the sigma phase.&quot;
# Calphad 60 (2018): 16-28.
#
# In this simulation we consider diffusion (Cahn-Hilliard) and phase transformation.
#
# This example requires CrFe_sigma_out_var_0001.csv file, which generated by first
# running the CrFe_sigma.i input file.


[Mesh]
  [gen]
    type = GeneratedMeshGenerator
    dim = 2
    nx = 160
    ny = 1
    nz = 0
    xmin = -25
    xmax = 25
    ymin = -2.5
    ymax = 2.5
    elem_type = QUAD4
  []
[]

[AuxVariables]
  [Fglobal]
    order = CONSTANT
    family = MONOMIAL
  []
[]

[Functions]
  [sigma_cr0]
    type = PiecewiseLinear
    data_file = CrFe_sigma_out_var_0001.csv
    format = columns
    x_index_in_file = 5
    y_index_in_file = 2
    xy_in_file_only = false
  []
  [sigma_cr1]
    type = PiecewiseLinear
    data_file = CrFe_sigma_out_var_0001.csv
    format = columns
    x_index_in_file = 5
    y_index_in_file = 3
    xy_in_file_only = false
  []
  [sigma_cr2]
    type = PiecewiseLinear
    data_file = CrFe_sigma_out_var_0001.csv
    format = columns
    x_index_in_file = 5
    y_index_in_file = 4
    xy_in_file_only = false
  []
[]

[Variables]
  # order parameters
  [eta1]
    order = FIRST
    family = LAGRANGE
    initial_condition = 0.5
  []
  [eta2]
    order = FIRST
    family = LAGRANGE
    initial_condition = 0.5
  []

  # solute concentration
  [cCr]
    order = FIRST
    family = LAGRANGE
    [InitialCondition]
      type = FunctionIC
      function = &#x27;(x+25)/50*0.5+0.1&#x27;
    []
  []

  # sublattice concentrations
  [BCC_CR]
    initial_condition = 0.45
  []
  [SIGMA_0CR]
    [InitialCondition]
      type = CoupledValueFunctionIC
      function = sigma_cr0
      v = cCr
      variable = SIGMA_0CR
    []
  []
  [SIGMA_1CR]
    [InitialCondition]
      type = CoupledValueFunctionIC
      function = sigma_cr1
      v = cCr
      variable = SIGMA_1CR
    []
  []
  [SIGMA_2CR]
    [InitialCondition]
      type = CoupledValueFunctionIC
      function = sigma_cr2
      v = cCr
      variable = SIGMA_2CR
    []
  []
  # Lagrange multiplier
  [lambda]
  []
[]

[Materials]
  # CALPHAD free energies
  [F_BCC_A2]
    type = DerivativeParsedMaterial
    property_name = F_BCC_A2
    outputs = exodus
    output_properties = F_BCC_A2
    expression = &#x27;BCC_FE:=1-BCC_CR; G := 8.3145*T*(1.0*if(BCC_CR &gt; 1.0e-15,BCC_CR*log(BCC_CR),0) + &#x27;
               &#x27;1.0*if(BCC_FE &gt; 1.0e-15,BCC_FE*plog(BCC_FE,eps),0) + 3.0*if(BCC_VA &gt; &#x27;
               &#x27;1.0e-15,BCC_VA*log(BCC_VA),0))/(BCC_CR + BCC_FE) + 8.3145*T*if(T &lt; &#x27;
               &#x27;548.2*BCC_CR*BCC_FE*BCC_VA*(BCC_CR - BCC_FE) - 932.5*BCC_CR*BCC_FE*BCC_VA + &#x27;
               &#x27;311.5*BCC_CR*BCC_VA - &#x27;
               &#x27;1043.0*BCC_FE*BCC_VA,-8.13674105561218e-49*T^15/(0.525599232981783*BCC_CR*BCC_FE*BCC_&#x27;
               &#x27;VA*(BCC_CR - BCC_FE) - 0.894055608820709*BCC_CR*BCC_FE*BCC_VA + &#x27;
               &#x27;0.298657718120805*BCC_CR*BCC_VA - BCC_FE*BCC_VA + 9.58772770853308e-13)^15 - &#x27;
               &#x27;4.65558036243985e-30*T^9/(0.525599232981783*BCC_CR*BCC_FE*BCC_VA*(BCC_CR - BCC_FE) - &#x27;
               &#x27;0.894055608820709*BCC_CR*BCC_FE*BCC_VA + 0.298657718120805*BCC_CR*BCC_VA - &#x27;
               &#x27;BCC_FE*BCC_VA + 9.58772770853308e-13)^9 - &#x27;
               &#x27;1.3485349181899e-10*T^3/(0.525599232981783*BCC_CR*BCC_FE*BCC_VA*(BCC_CR - BCC_FE) - &#x27;
               &#x27;0.894055608820709*BCC_CR*BCC_FE*BCC_VA + 0.298657718120805*BCC_CR*BCC_VA - &#x27;
               &#x27;BCC_FE*BCC_VA + 9.58772770853308e-13)^3 + 1 - &#x27;
               &#x27;0.905299382744392*(548.2*BCC_CR*BCC_FE*BCC_VA*(BCC_CR - BCC_FE) - &#x27;
               &#x27;932.5*BCC_CR*BCC_FE*BCC_VA + 311.5*BCC_CR*BCC_VA - 1043.0*BCC_FE*BCC_VA + &#x27;
               &#x27;1.0e-9)/T,if(T &lt; -548.2*BCC_CR*BCC_FE*BCC_VA*(BCC_CR - BCC_FE) + &#x27;
               &#x27;932.5*BCC_CR*BCC_FE*BCC_VA - 311.5*BCC_CR*BCC_VA + &#x27;
               &#x27;1043.0*BCC_FE*BCC_VA,-8.13674105561218e-49*T^15/(-0.525599232981783*BCC_CR*BCC_FE*BCC&#x27;
               &#x27;_VA*(BCC_CR - BCC_FE) + 0.894055608820709*BCC_CR*BCC_FE*BCC_VA - &#x27;
               &#x27;0.298657718120805*BCC_CR*BCC_VA + BCC_FE*BCC_VA + 9.58772770853308e-13)^15 - &#x27;
               &#x27;4.65558036243985e-30*T^9/(-0.525599232981783*BCC_CR*BCC_FE*BCC_VA*(BCC_CR - BCC_FE) &#x27;
               &#x27;+ 0.894055608820709*BCC_CR*BCC_FE*BCC_VA - 0.298657718120805*BCC_CR*BCC_VA + &#x27;
               &#x27;BCC_FE*BCC_VA + 9.58772770853308e-13)^9 - &#x27;
               &#x27;1.3485349181899e-10*T^3/(-0.525599232981783*BCC_CR*BCC_FE*BCC_VA*(BCC_CR - BCC_FE) + &#x27;
               &#x27;0.894055608820709*BCC_CR*BCC_FE*BCC_VA - 0.298657718120805*BCC_CR*BCC_VA + &#x27;
               &#x27;BCC_FE*BCC_VA + 9.58772770853308e-13)^3 + 1 - &#x27;
               &#x27;0.905299382744392*(-548.2*BCC_CR*BCC_FE*BCC_VA*(BCC_CR - BCC_FE) + &#x27;
               &#x27;932.5*BCC_CR*BCC_FE*BCC_VA - 311.5*BCC_CR*BCC_VA + 1043.0*BCC_FE*BCC_VA + &#x27;
               &#x27;1.0e-9)/T,if(T &gt; -548.2*BCC_CR*BCC_FE*BCC_VA*(BCC_CR - BCC_FE) + &#x27;
               &#x27;932.5*BCC_CR*BCC_FE*BCC_VA - 311.5*BCC_CR*BCC_VA + 1043.0*BCC_FE*BCC_VA &amp; &#x27;
               &#x27;548.2*BCC_CR*BCC_FE*BCC_VA*(BCC_CR - BCC_FE) - 932.5*BCC_CR*BCC_FE*BCC_VA + &#x27;
               &#x27;311.5*BCC_CR*BCC_VA - 1043.0*BCC_FE*BCC_VA &lt; &#x27;
               &#x27;0,-79209031311018.7*(-0.525599232981783*BCC_CR*BCC_FE*BCC_VA*(BCC_CR - BCC_FE) + &#x27;
               &#x27;0.894055608820709*BCC_CR*BCC_FE*BCC_VA - 0.298657718120805*BCC_CR*BCC_VA + &#x27;
               &#x27;BCC_FE*BCC_VA + 9.58772770853308e-13)^5/T^5 - &#x27;
               &#x27;3.83095660520737e+42*(-0.525599232981783*BCC_CR*BCC_FE*BCC_VA*(BCC_CR - BCC_FE) + &#x27;
               &#x27;0.894055608820709*BCC_CR*BCC_FE*BCC_VA - 0.298657718120805*BCC_CR*BCC_VA + &#x27;
               &#x27;BCC_FE*BCC_VA + 9.58772770853308e-13)^15/T^15 - &#x27;
               &#x27;1.22565886734485e+72*(-0.525599232981783*BCC_CR*BCC_FE*BCC_VA*(BCC_CR - BCC_FE) + &#x27;
               &#x27;0.894055608820709*BCC_CR*BCC_FE*BCC_VA - 0.298657718120805*BCC_CR*BCC_VA + &#x27;
               &#x27;BCC_FE*BCC_VA + 9.58772770853308e-13)^25/T^25,if(T &gt; &#x27;
               &#x27;548.2*BCC_CR*BCC_FE*BCC_VA*(BCC_CR - BCC_FE) - 932.5*BCC_CR*BCC_FE*BCC_VA + &#x27;
               &#x27;311.5*BCC_CR*BCC_VA - 1043.0*BCC_FE*BCC_VA &amp; 548.2*BCC_CR*BCC_FE*BCC_VA*(BCC_CR - &#x27;
               &#x27;BCC_FE) - 932.5*BCC_CR*BCC_FE*BCC_VA + 311.5*BCC_CR*BCC_VA - 1043.0*BCC_FE*BCC_VA &gt; &#x27;
               &#x27;0,-79209031311018.7*(0.525599232981783*BCC_CR*BCC_FE*BCC_VA*(BCC_CR - BCC_FE) - &#x27;
               &#x27;0.894055608820709*BCC_CR*BCC_FE*BCC_VA + 0.298657718120805*BCC_CR*BCC_VA - &#x27;
               &#x27;BCC_FE*BCC_VA + 9.58772770853308e-13)^5/T^5 - &#x27;
               &#x27;3.83095660520737e+42*(0.525599232981783*BCC_CR*BCC_FE*BCC_VA*(BCC_CR - BCC_FE) - &#x27;
               &#x27;0.894055608820709*BCC_CR*BCC_FE*BCC_VA + 0.298657718120805*BCC_CR*BCC_VA - &#x27;
               &#x27;BCC_FE*BCC_VA + 9.58772770853308e-13)^15/T^15 - &#x27;
               &#x27;1.22565886734485e+72*(0.525599232981783*BCC_CR*BCC_FE*BCC_VA*(BCC_CR - BCC_FE) - &#x27;
               &#x27;0.894055608820709*BCC_CR*BCC_FE*BCC_VA + 0.298657718120805*BCC_CR*BCC_VA - &#x27;
               &#x27;BCC_FE*BCC_VA + 9.58772770853308e-13)^25/T^25,0))))*log((2.15*BCC_CR*BCC_FE*BCC_VA - &#x27;
               &#x27;0.008*BCC_CR*BCC_VA + 2.22*BCC_FE*BCC_VA)*if(2.15*BCC_CR*BCC_FE*BCC_VA - &#x27;
               &#x27;0.008*BCC_CR*BCC_VA + 2.22*BCC_FE*BCC_VA &lt;= 0,-1.0,1.0) + 1)/(BCC_CR + BCC_FE) + &#x27;
               &#x27;1.0*(BCC_CR*BCC_VA*if(T &gt;= 298.15 &amp; T &lt; 2180.0,139250.0*1/T - 26.908*T*log(T) + &#x27;
               &#x27;157.48*T + 0.00189435*T^2.0 - 1.47721e-6*T^3.0 - 8856.94,if(T &gt;= 2180.0 &amp; T &lt; &#x27;
               &#x27;6000.0,-2.88526e+32*T^(-9.0) - 50.0*T*log(T) + 344.18*T - 34869.344,0)) + &#x27;
               &#x27;BCC_FE*BCC_VA*if(T &gt;= 298.15 &amp; T &lt; 1811.0,77358.5*1/T - 23.5143*T*log(T) + 124.134*T &#x27;
               &#x27;- 0.00439752*T^2.0 - 5.89269e-8*T^3.0 + 1225.7,if(T &gt;= 1811.0 &amp; T &lt; &#x27;
               &#x27;6000.0,2.2960305e+31*T^(-9.0) - 46.0*T*log(T) + 299.31255*T - 25383.581,0)))/(BCC_CR &#x27;
               &#x27;+ BCC_FE) + 1.0*(BCC_CR*BCC_FE*BCC_VA*(500.0 - 1.5*T)*(BCC_CR - BCC_FE) + &#x27;
               &#x27;BCC_CR*BCC_FE*BCC_VA*(24600.0 - 14.98*T) + BCC_CR*BCC_FE*BCC_VA*(9.15*T - &#x27;
               &#x27;14000.0)*(BCC_CR - BCC_FE)^2)/(BCC_CR + BCC_FE); G/100000&#x27;
    coupled_variables = &#x27;BCC_CR&#x27;
    constant_names = &#x27;BCC_VA T eps&#x27;
    constant_expressions = &#x27;1 1000 0.01&#x27;
  []

  [F_SIGMA]
    type = DerivativeParsedMaterial
    property_name = F_SIGMA
    outputs = exodus
    output_properties = F_SIGMA
    expression = &#x27;SIGMA_0FE := 1-SIGMA_0CR; SIGMA_1FE := 1-SIGMA_1CR; SIGMA_2FE := 1-SIGMA_2CR; G := &#x27;
               &#x27;8.3145*T*(10.0*if(SIGMA_0CR &gt; 1.0e-15,SIGMA_0CR*plog(SIGMA_0CR,eps),0) + &#x27;
               &#x27;10.0*if(SIGMA_0FE &gt; 1.0e-15,SIGMA_0FE*plog(SIGMA_0FE,eps),0) + 4.0*if(SIGMA_1CR &gt; &#x27;
               &#x27;1.0e-15,SIGMA_1CR*plog(SIGMA_1CR,eps),0) + 4.0*if(SIGMA_1FE &gt; &#x27;
               &#x27;1.0e-15,SIGMA_1FE*plog(SIGMA_1FE,eps),0) + 16.0*if(SIGMA_2CR &gt; &#x27;
               &#x27;1.0e-15,SIGMA_2CR*plog(SIGMA_2CR,eps),0) + 16.0*if(SIGMA_2FE &gt; &#x27;
               &#x27;1.0e-15,SIGMA_2FE*plog(SIGMA_2FE,eps),0))/(10.0*SIGMA_0CR + 10.0*SIGMA_0FE + &#x27;
               &#x27;4.0*SIGMA_1CR + 4.0*SIGMA_1FE + 16.0*SIGMA_2CR + 16.0*SIGMA_2FE) + &#x27;
               &#x27;(SIGMA_0FE*SIGMA_1CR*SIGMA_2CR*SIGMA_2FE*(-70.0*T - 170400.0) + &#x27;
               &#x27;SIGMA_0FE*SIGMA_1FE*SIGMA_2CR*SIGMA_2FE*(-10.0*T - 330839.0))/(10.0*SIGMA_0CR + &#x27;
               &#x27;10.0*SIGMA_0FE + 4.0*SIGMA_1CR + 4.0*SIGMA_1FE + 16.0*SIGMA_2CR + 16.0*SIGMA_2FE) + &#x27;
               &#x27;(SIGMA_0CR*SIGMA_1CR*SIGMA_2CR*(30.0*if(T &gt;= 298.15 &amp; T &lt; 2180.0,139250.0*1/T - &#x27;
               &#x27;26.908*T*log(T) + 157.48*T + 0.00189435*T^2.0 - 1.47721e-6*T^3.0 - 8856.94,if(T &gt;= &#x27;
               &#x27;2180.0 &amp; T &lt; 6000.0,-2.88526e+32*T^(-9.0) - 50.0*T*log(T) + 344.18*T - 34869.344,0)) &#x27;
               &#x27;+ 132000.0) + SIGMA_0CR*SIGMA_1CR*SIGMA_2FE*(-110.0*T + 16.0*if(T &gt;= 298.15 &amp; T &lt; &#x27;
               &#x27;1811.0,77358.5*1/T - 23.5143*T*log(T) + 124.134*T - 0.00439752*T^2.0 - &#x27;
               &#x27;5.89269e-8*T^3.0 + 1225.7,if(T &gt;= 1811.0 &amp; T &lt; 6000.0,2.2960305e+31*T^(-9.0) - &#x27;
               &#x27;46.0*T*log(T) + 299.31255*T - 25383.581,0)) + 14.0*if(T &gt;= 298.15 &amp; T &lt; &#x27;
               &#x27;2180.0,139250.0*1/T - 26.908*T*log(T) + 157.48*T + 0.00189435*T^2.0 - &#x27;
               &#x27;1.47721e-6*T^3.0 - 8856.94,if(T &gt;= 2180.0 &amp; T &lt; 6000.0,-2.88526e+32*T^(-9.0) - &#x27;
               &#x27;50.0*T*log(T) + 344.18*T - 34869.344,0)) + 123500.0) + &#x27;
               &#x27;SIGMA_0CR*SIGMA_1FE*SIGMA_2CR*(4.0*if(T &gt;= 298.15 &amp; T &lt; 1811.0,77358.5*1/T - &#x27;
               &#x27;23.5143*T*log(T) + 124.134*T - 0.00439752*T^2.0 - 5.89269e-8*T^3.0 + 1225.7,if(T &gt;= &#x27;
               &#x27;1811.0 &amp; T &lt; 6000.0,2.2960305e+31*T^(-9.0) - 46.0*T*log(T) + 299.31255*T - &#x27;
               &#x27;25383.581,0)) + 26.0*if(T &gt;= 298.15 &amp; T &lt; 2180.0,139250.0*1/T - 26.908*T*log(T) + &#x27;
               &#x27;157.48*T + 0.00189435*T^2.0 - 1.47721e-6*T^3.0 - 8856.94,if(T &gt;= 2180.0 &amp; T &lt; &#x27;
               &#x27;6000.0,-2.88526e+32*T^(-9.0) - 50.0*T*log(T) + 344.18*T - 34869.344,0)) + 140486.0) &#x27;
               &#x27;+ SIGMA_0CR*SIGMA_1FE*SIGMA_2FE*(20.0*if(T &gt;= 298.15 &amp; T &lt; 1811.0,77358.5*1/T - &#x27;
               &#x27;23.5143*T*log(T) + 124.134*T - 0.00439752*T^2.0 - 5.89269e-8*T^3.0 + 1225.7,if(T &gt;= &#x27;
               &#x27;1811.0 &amp; T &lt; 6000.0,2.2960305e+31*T^(-9.0) - 46.0*T*log(T) + 299.31255*T - &#x27;
               &#x27;25383.581,0)) + 10.0*if(T &gt;= 298.15 &amp; T &lt; 2180.0,139250.0*1/T - 26.908*T*log(T) + &#x27;
               &#x27;157.48*T + 0.00189435*T^2.0 - 1.47721e-6*T^3.0 - 8856.94,if(T &gt;= 2180.0 &amp; T &lt; &#x27;
               &#x27;6000.0,-2.88526e+32*T^(-9.0) - 50.0*T*log(T) + 344.18*T - 34869.344,0)) + 148800.0) &#x27;
               &#x27;+ SIGMA_0FE*SIGMA_1CR*SIGMA_2CR*(10.0*if(T &gt;= 298.15 &amp; T &lt; 1811.0,77358.5*1/T - &#x27;
               &#x27;23.5143*T*log(T) + 124.134*T - 0.00439752*T^2.0 - 5.89269e-8*T^3.0 + 1225.7,if(T &gt;= &#x27;
               &#x27;1811.0 &amp; T &lt; 6000.0,2.2960305e+31*T^(-9.0) - 46.0*T*log(T) + 299.31255*T - &#x27;
               &#x27;25383.581,0)) + 20.0*if(T &gt;= 298.15 &amp; T &lt; 2180.0,139250.0*1/T - 26.908*T*log(T) + &#x27;
               &#x27;157.48*T + 0.00189435*T^2.0 - 1.47721e-6*T^3.0 - 8856.94,if(T &gt;= 2180.0 &amp; T &lt; &#x27;
               &#x27;6000.0,-2.88526e+32*T^(-9.0) - 50.0*T*log(T) + 344.18*T - 34869.344,0)) + 56200.0) + &#x27;
               &#x27;SIGMA_0FE*SIGMA_1CR*SIGMA_2FE*(26.0*if(T &gt;= 298.15 &amp; T &lt; 1811.0,77358.5*1/T - &#x27;
               &#x27;23.5143*T*log(T) + 124.134*T - 0.00439752*T^2.0 - 5.89269e-8*T^3.0 + 1225.7,if(T &gt;= &#x27;
               &#x27;1811.0 &amp; T &lt; 6000.0,2.2960305e+31*T^(-9.0) - 46.0*T*log(T) + 299.31255*T - &#x27;
               &#x27;25383.581,0)) + 4.0*if(T &gt;= 298.15 &amp; T &lt; 2180.0,139250.0*1/T - 26.908*T*log(T) + &#x27;
               &#x27;157.48*T + 0.00189435*T^2.0 - 1.47721e-6*T^3.0 - 8856.94,if(T &gt;= 2180.0 &amp; T &lt; &#x27;
               &#x27;6000.0,-2.88526e+32*T^(-9.0) - 50.0*T*log(T) + 344.18*T - 34869.344,0)) + 152700.0) &#x27;
               &#x27;+ SIGMA_0FE*SIGMA_1FE*SIGMA_2CR*(14.0*if(T &gt;= 298.15 &amp; T &lt; 1811.0,77358.5*1/T - &#x27;
               &#x27;23.5143*T*log(T) + 124.134*T - 0.00439752*T^2.0 - 5.89269e-8*T^3.0 + 1225.7,if(T &gt;= &#x27;
               &#x27;1811.0 &amp; T &lt; 6000.0,2.2960305e+31*T^(-9.0) - 46.0*T*log(T) + 299.31255*T - &#x27;
               &#x27;25383.581,0)) + 16.0*if(T &gt;= 298.15 &amp; T &lt; 2180.0,139250.0*1/T - 26.908*T*log(T) + &#x27;
               &#x27;157.48*T + 0.00189435*T^2.0 - 1.47721e-6*T^3.0 - 8856.94,if(T &gt;= 2180.0 &amp; T &lt; &#x27;
               &#x27;6000.0,-2.88526e+32*T^(-9.0) - 50.0*T*log(T) + 344.18*T - 34869.344,0)) + 46200.0) + &#x27;
               &#x27;SIGMA_0FE*SIGMA_1FE*SIGMA_2FE*(30.0*if(T &gt;= 298.15 &amp; T &lt; 1811.0,77358.5*1/T - &#x27;
               &#x27;23.5143*T*log(T) + 124.134*T - 0.00439752*T^2.0 - 5.89269e-8*T^3.0 + 1225.7,if(T &gt;= &#x27;
               &#x27;1811.0 &amp; T &lt; 6000.0,2.2960305e+31*T^(-9.0) - 46.0*T*log(T) + 299.31255*T - &#x27;
               &#x27;25383.581,0)) + 173333.0))/(10.0*SIGMA_0CR + 10.0*SIGMA_0FE + 4.0*SIGMA_1CR + &#x27;
               &#x27;4.0*SIGMA_1FE + 16.0*SIGMA_2CR + 16.0*SIGMA_2FE); G/100000&#x27;
    coupled_variables = &#x27;SIGMA_0CR SIGMA_1CR SIGMA_2CR&#x27;
    constant_names = &#x27;T eps&#x27;
    constant_expressions = &#x27;1000 0.01&#x27;
  []

  # h(eta)
  [h1]
    type = SwitchingFunctionMaterial
    function_name = h1
    h_order = HIGH
    eta = eta1
  []
  [h2]
    type = SwitchingFunctionMaterial
    function_name = h2
    h_order = HIGH
    eta = eta2
  []

  # g(eta)
  [g1]
    type = BarrierFunctionMaterial
    function_name = g1
    g_order = SIMPLE
    eta = eta1
  []
  [g2]
    type = BarrierFunctionMaterial
    function_name = g2
    g_order = SIMPLE
    eta = eta2
  []

  # constant properties
  [constants]
    type = GenericConstantMaterial
    prop_names = &#x27;D   L   kappa&#x27;
    prop_values = &#x27;10  1   0.1  &#x27;
  []

  # Coefficients for diffusion equation
  [Dh1]
    type = DerivativeParsedMaterial
    material_property_names = &#x27;D h1(eta1)&#x27;
    expression = D*h1
    property_name = Dh1
    coupled_variables = eta1
    derivative_order = 1
  []
  [Dh2a]
    type = DerivativeParsedMaterial
    material_property_names = &#x27;D h2(eta2)&#x27;
    expression = D*h2*10/30
    property_name = Dh2a
    coupled_variables = eta2
    derivative_order = 1
  []
  [Dh2b]
    type = DerivativeParsedMaterial
    material_property_names = &#x27;D h2(eta2)&#x27;
    expression = D*h2*4/30
    property_name = Dh2b
    coupled_variables = eta2
    derivative_order = 1
  []
  [Dh2c]
    type = DerivativeParsedMaterial
    material_property_names = &#x27;D h2(eta2)&#x27;
    expression = D*h2*16/30
    property_name = Dh2c
    coupled_variables = eta2
    derivative_order = 1
  []
[]

[Kernels]
  #Kernels for diffusion equation
  [diff_time]
    type = TimeDerivative
    variable = cCr
  []
  [diff_c1]
    type = MatDiffusion
    variable = cCr
    diffusivity = Dh1
    v = BCC_CR
    args = eta1
  []
  [diff_c2a]
    type = MatDiffusion
    variable = cCr
    diffusivity = Dh2a
    v = SIGMA_0CR
    args = eta2
  []
  [diff_c2b]
    type = MatDiffusion
    variable = cCr
    diffusivity = Dh2b
    v = SIGMA_1CR
    args = eta2
  []
  [diff_c2c]
    type = MatDiffusion
    variable = cCr
    diffusivity = Dh2c
    v = SIGMA_2CR
    args = eta2
  []

  # enforce pointwise equality of chemical potentials
  [chempot1a2a]
    # The BCC phase has only one sublattice
    # we tie it to the first sublattice with site fraction 10/(10+4+16) in the sigma phase
    type = KKSPhaseChemicalPotential
    variable = BCC_CR
    cb = SIGMA_0CR
    kb = &#x27;${fparse 10/30}&#x27;
    fa_name = F_BCC_A2
    fb_name = F_SIGMA
    args_b = &#x27;SIGMA_1CR SIGMA_2CR&#x27;
  []
  [chempot2a2b]
    # This kernel ties the first two sublattices in the sigma phase together
    type = SLKKSChemicalPotential
    variable = SIGMA_0CR
    a = 10
    cs = SIGMA_1CR
    as = 4
    F = F_SIGMA
    coupled_variables = &#x27;SIGMA_2CR&#x27;
  []
  [chempot2b2c]
    # This kernel ties the remaining two sublattices in the sigma phase together
    type = SLKKSChemicalPotential
    variable = SIGMA_1CR
    a = 4
    cs = SIGMA_2CR
    as = 16
    F = F_SIGMA
    coupled_variables = &#x27;SIGMA_0CR&#x27;
  []

  [phaseconcentration]
    # This kernel ties the sum of the sublattice concentrations to the global concentration cCr
    type = SLKKSMultiPhaseConcentration
    variable = SIGMA_2CR
    c = cCr
    ns = &#x27;1      3&#x27;
    as = &#x27;1      10        4         16&#x27;
    cs = &#x27;BCC_CR SIGMA_0CR SIGMA_1CR SIGMA_2CR&#x27;
    h_names = &#x27;h1   h2&#x27;
    eta = &#x27;eta1 eta2&#x27;
  []

  # Kernels for Allen-Cahn equation for eta1
  [deta1dt]
    type = TimeDerivative
    variable = eta1
  []
  [ACBulkF1]
    type = KKSMultiACBulkF
    variable = eta1
    Fj_names = &#x27;F_BCC_A2 F_SIGMA&#x27;
    hj_names = &#x27;h1    h2&#x27;
    gi_name = g1
    eta_i = eta1
    wi = 0.1
    coupled_variables = &#x27;BCC_CR SIGMA_0CR SIGMA_1CR SIGMA_2CR eta2&#x27;
  []
  [ACBulkC1]
    type = SLKKSMultiACBulkC
    variable = eta1
    F = F_BCC_A2
    c = BCC_CR
    ns = &#x27;1      3&#x27;
    as = &#x27;1      10        4         16&#x27;
    cs = &#x27;BCC_CR SIGMA_0CR SIGMA_1CR SIGMA_2CR&#x27;
    h_names = &#x27;h1   h2&#x27;
    eta = &#x27;eta1 eta2&#x27;
  []
  [ACInterface1]
    type = ACInterface
    variable = eta1
    kappa_name = kappa
  []
  [lagrange1]
    type = SwitchingFunctionConstraintEta
    variable = eta1
    h_name = h1
    lambda = lambda
    coupled_variables = &#x27;eta2&#x27;
  []

  # Kernels for Allen-Cahn equation for eta1
  [deta2dt]
    type = TimeDerivative
    variable = eta2
  []
  [ACBulkF2]
    type = KKSMultiACBulkF
    variable = eta2
    Fj_names = &#x27;F_BCC_A2 F_SIGMA&#x27;
    hj_names = &#x27;h1    h2&#x27;
    gi_name = g2
    eta_i = eta2
    wi = 0.1
    coupled_variables = &#x27;BCC_CR SIGMA_0CR SIGMA_1CR SIGMA_2CR eta1&#x27;
  []
  [ACBulkC2]
    type = SLKKSMultiACBulkC
    variable = eta2
    F = F_BCC_A2
    c = BCC_CR
    ns = &#x27;1      3&#x27;
    as = &#x27;1      10        4         16&#x27;
    cs = &#x27;BCC_CR SIGMA_0CR SIGMA_1CR SIGMA_2CR&#x27;
    h_names = &#x27;h1   h2&#x27;
    eta = &#x27;eta1 eta2&#x27;
  []
  [ACInterface2]
    type = ACInterface
    variable = eta2
    kappa_name = kappa
  []
  [lagrange2]
    type = SwitchingFunctionConstraintEta
    variable = eta2
    h_name = h2
    lambda = lambda
    coupled_variables = &#x27;eta1&#x27;
  []

  # Lagrange-multiplier constraint kernel for lambda
  [lagrange]
    type = SwitchingFunctionConstraintLagrange
    variable = lambda
    h_names = &#x27;h1   h2&#x27;
    etas = &#x27;eta1 eta2&#x27;
    epsilon = 1e-6
  []
[]

[AuxKernels]
  [GlobalFreeEnergy]
    type = KKSMultiFreeEnergy
    variable = Fglobal
    Fj_names = &#x27;F_BCC_A2 F_SIGMA&#x27;
    hj_names = &#x27;h1 h2&#x27;
    gj_names = &#x27;g1 g2&#x27;
    interfacial_vars = &#x27;eta1 eta2&#x27;
    kappa_names = &#x27;kappa kappa&#x27;
    w = 0.1
  []
[]

[Executioner]
  type = Transient
  solve_type = &#x27;NEWTON&#x27;
  line_search = none

  petsc_options_iname = &#x27;-pc_type -sub_pc_type -sub_pc_factor_shift_type -ksp_gmres_restart&#x27;
  petsc_options_value = &#x27;asm      lu          nonzero                    30&#x27;

  l_max_its = 100
  nl_max_its = 20
  nl_abs_tol = 1e-10

  end_time = 10000

  [TimeStepper]
    type = IterationAdaptiveDT
    optimal_iterations = 12
    iteration_window = 2
    growth_factor = 1.5
    cutback_factor = 0.7
    dt = 0.1
  []
[]

[VectorPostprocessors]
  [var]
    type = LineValueSampler
    start_point = &#x27;-25 0 0&#x27;
    end_point = &#x27;25 0 0&#x27;
    variable = &#x27;cCr eta1 eta2 SIGMA_0CR SIGMA_1CR SIGMA_2CR&#x27;
    num_points = 151
    sort_by = id
    execute_on = &#x27;initial timestep_end&#x27;
  []
  [mat]
    type = LineMaterialRealSampler
    start = &#x27;-25 0 0&#x27;
    end = &#x27;25 0 0&#x27;
    property = &#x27;F_BCC_A2 F_SIGMA&#x27;
    sort_by = id
    execute_on = &#x27;initial timestep_end&#x27;
  []
[]

[Postprocessors]
  [F]
    type = ElementIntegralVariablePostprocessor
    variable = Fglobal
    execute_on = &#x27;initial timestep_end&#x27;
  []
  [cmin]
    type = NodalExtremeValue
    value_type = min
    variable = cCr
    execute_on = &#x27;initial timestep_end&#x27;
  []
  [cmax]
    type = NodalExtremeValue
    value_type = max
    variable = cCr
    execute_on = &#x27;initial timestep_end&#x27;
  []
  [ctotal]
    type = ElementIntegralVariablePostprocessor
    variable = cCr
    execute_on = &#x27;initial timestep_end&#x27;
  []
[]

[Outputs]
  exodus = true
  print_linear_residuals = false
  csv = true
  perf_graph = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div></div></div></div></main></div></body><script type="text/javascript" src="../../../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../../../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../../../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../../../js/init.js"></script><script type="text/javascript" src="../../../js/navigation.js"></script><script type="text/javascript" src="https://cse.google.com/cse.js?cx=008852834041008754713:g3ilnhhbbj9"></script><script type="text/javascript" src="../../../js/sqa_moose.js"></script><script type="text/javascript" src="../../../js/moose_input_parser.js"></script>